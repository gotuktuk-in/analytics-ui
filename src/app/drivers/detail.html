<style>
    .search-btn-trip {
        position: fixed;
        right: 9px;
        top: 12px;
        z-index: 91;
    }
    .payout-daywise-div {
        position: fixed;
        height: 100%;
        width: 99%;
        z-index: 99;
        background: rgba(255, 255, 255, 0.95);
        top: 0;
        overflow: hidden;
    }

</style>
<div class="search-btn-trip">
    <form class="form-inline">
        <div class="form-group">
            <div style="max-height: 34px; overflow: hidden;">
                <a ui-sref="home.drivers_search({city: city,vehicleType: vehicleType, filterURL: 'joined', term: dateURL})"
                   class="btn btn-default disabled no-border">
                    <i class="fa fa-pencil" aria-hidden="true"></i>
                </a>
                <a title="Suspend" ng-click="confirmSuspend();"
                   class="btn btn-default no-border">
                    <i class="fa fa-minus-circle" aria-hidden="true"></i>
                </a>
                <a title="Delete" ng-click="confirmDelete();" class="btn btn-default no-border">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </form>
</div>
<div class="container-fluid">
    <!--<div class="row">-->
    <!--<form class="form-inline date-selection date-selection-dr">-->
    <!--<div class="form-group ">-->
    <!--<input ng-change="vm.getAllData()" class="form-control cstm-width text-center" type="daterange"-->
    <!--ng-model="selectedDates" separator=" - " format="DD MMM YY" opens="right" ranges="vm.ranges">-->
    <!--</div>-->
    <!--</form>-->
    <!--<div class="col-md-12 col-sm-12 col-xs-12">-->
    <!--<span ng-click="vm.changeDate('prev')" style="display: inline-block; padding: 7px;">&#10094;</span> <span-->
    <!--class="text-center" ng-model="date" style="display: inline-block; padding: 7px 0;">{{date}}</span> <span-->
    <!--ng-click="vm.changeDate('next')" ng-if="!vm.live"-->
    <!--style="display: inline-block; padding: 7px;">&#10095;</span>-->
    <!--</div>-->
    <!--</div>-->
    <!--<span class="live" ng-if="vm.live"> LIVE</span>-->
    <!--<span class="reload" ng-click="vm.refreshPage()"><i class="fa fa-refresh" aria-hidden="true"></i></span>-->
    <br>
    <br>
    <br>
    <br>

    <div class="row overview-box">
        <div class="col-md-12 col-sm-12 col-xs-12 text-center">
            <div class="panel panel-default">
                <div class="panel-body">
                    <div class="col-md-2 col-sm-12 col-xs-12 no-mr no-pd">
                        <div class="box box-heading box-0 text-center"
                             ng-class="{'box-online': vm.profile.state== 22 || vm.profile.state== 11, 'box-offline': vm.profile.state== 10 } ">
                            <img ng-src="https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?url={{vm.profile.profileImage}}&container=focus&resize_w=75&resize_h=75&refresh=2592000"
                                 class="iw-driver" height="50">
                            <h4 class="title" style="margin-top:10px;">{{vm.profile.name}}</h4>
                        </div>
                    </div>
                    <div class="col-md-10 col-sm-12 col-xs-12">
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.id}}</h4>
                                <span>id</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.phone}}</h4>
                                <span>phone</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.vehicle}}</h4>
                                <span>vehicle number</span>
                            </div>
                        </div>

                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.joinedOn*1000 | date:'dd MMM yy'}}</h4>
                                <span>joined On</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.rides_total.total}}
                                    <small>/ {{vm.profile.rides_total.unique_ride}}</small>
                                </h4>
                                <span>Total rides</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.can_rides_total.total}}
                                    <small>/ {{vm.profile.can_rides_total.unique_ride}}</small>
                                </h4>
                                <span>Total Cancellation</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.total_online}}</h4>
                                <span>online hours</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12" ng-if="vm.profile.utilization">
                            <div class="box">
                                <h4 class="number">{{vm.profile.utilization | number:2}}</h4>
                                <span>utilization</span>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.total_earning}}</h4>
                                <span>Total Trip Earning</span>
                            </div>
                        </div>

                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box" uib-popover-template="'myPopoverTemplate1.html'"
                                 popover-trigger="mouseenter" popover-placement="bottom">
                                <h4 class="number">{{vm.profile.distance.total | number:2}}</h4>
                                <span>distance</span>
                            </div>
                        </div>

                        <div class="col-md-2 col-sm-4 col-xs-12">
                            <div class="box">
                                <h4 class="number">{{vm.profile.feedbackRating}}</h4>
                                <span>feedback</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="row" style="position:absolute;width:auto;margin: -5px 0 0;right: 20px;">
                        <div class="col-md-12 col-sm-12 col-xs-12">
            <span ng-click="vm.changeDate('prev')" ng-if="vm.prev"
                  style="display: inline-block; padding: 7px;">&#10094;</span>
            <span class="text-center" ng-model="date"
                  style="display: inline-block; padding: 7px 0;">{{vm.formattedStartWeekDs}} - {{vm.formattedEndWeekDs}}</span> <span
                                ng-click="vm.changeDate('next')" ng-if="vm.next"
                                style="display: inline-block; padding: 7px;">&#10095;</span>
                        </div>
                    </div>
                    <h4 style="margin-top: 0" class="title">Invoice</h4></div>
                <div class="panel-body">
                    <div class="data-table-payout">
                        <table ng-table="payoutTableParams"
                               class="table table-bordered table-striped text-center">

                            <tr ng-click="vm.setSelected(dataInvoice.driver)"
                                ng-class="{selected : row.driver === vm.selectedRow}">
                                <td data-title="'ID'" class="text-left" width="100">
                                    {{dataInvoice.driver}}
                                </td>
                                <td data-title="'Name'" sortable="'name'" class="text-left" width="100">
                                    <a target="_blank"
                                       ui-sref="home.drivers_detail({driverId:row.driver})">
                                        {{dataInvoice.name}}
                                    </a>
                                </td>
                                <td data-title="'Trips'" sortable="'tripCount'" class="text-center" width="50">
                                    {{dataInvoice.tripCount}}
                                </td>
                                <td data-title="'Trip'" sortable="'tripEarning'" class="text-right"
                                    width="100">
                                    {{dataInvoice.tripEarning | number:2}}
                                </td>
                                <td data-title="'Offer'" sortable="'offerEarning'" class="text-right"
                                    width="100">
                                    {{dataInvoice.offerEarning | number:2}}
                                </td>
                                <td data-title="'Bonus'" sortable="'bonusEarning'" class="text-right"
                                    width="100">
                                    {{dataInvoice.bonusEarning | number:2}}
                                </td>
                                <td data-title="'Cash'" sortable="'cash'" class="text-right" width="100">
                                    {{dataInvoice.cashCollected | number:2}}
                                </td>
                                <td data-title="'Commission'" class="text-right" width="100">
                                    {{(dataInvoice.tripTuktukCommission + dataInvoice.bonusTuktukCommission +
                                    dataInvoice.offerTuktukCommission)
                                    |
                                    number:2}}
                                </td>
                                <td data-title="'Settlements'" sortable="'settlement'" class="text-right" width="100">
                                    {{dataInvoice.tripSettledAmount | number:2}}
                                </td>
                                <td data-title="'tCASH'" sortable="'tCASH'" class="text-right" width="100">
                                    {{dataInvoice.tcashEarning | number:2}}
                                </td>
                                <td data-title="'Balance'" sortable="'balance'" class="text-right" width="100">
                                    <a href="" data-toggle="tooltip"
                                       tooltip="View"
                                       tooltip-placement="top" class=""
                                       ng-click="vm.viewDaywiseListData(dataInvoice.driver);">
                                        {{dataInvoice.balance | number:2}}
                                    </a>

                                </td>
                                <td data-title="'Opening&nbsp;Bal'" sortable="'openingBalance'" class="text-right"
                                    width="100">
                                    {{dataInvoice.openingBalance | number:2}}
                                </td>
                                <td data-title="'Closing&nbsp;Bal'" sortable="'closingBalance'" class="text-right"
                                    width="100">
                                    {{dataInvoice.closingBalance | number:2}}
                                </td>
                                <td data-title="'Fine'" sortable="'fine'" class="text-right" width="100">
                                    {{dataInvoice.fine | number:2}}
                                </td>
                                <td data-title="'Paid&nbsp;Amt'" class="text-right" width="100">
                                    {{dataInvoice.paidAmount | number:2}}
                                </td>
                                <!--<td data-title="'Paid&nbsp;Amt'" class="text-right" ng-if="editable" width="120">-->
                                <!--<form class="form-inline text-left">-->
                                <!--<div class="form-group">-->
                                <!--<input ng-if="!dataInvoice.paidStatus"-->
                                <!--class="form-control text-right"-->
                                <!--type="number"-->
                                <!--name="inputPaid"-->
                                <!--ng-value="dataInvoice.closingBalance"-->
                                <!--ng-model="dataInvoice.newClosingBalance">-->
                                <!--<input ng-if="dataInvoice.paidStatus" class="form-control text-right"-->
                                <!--type="number"-->
                                <!--name="inputPaid"-->
                                <!--ng-value="dataInvoice.paidAmount">-->
                                <!--</div>-->
                                <!--<div class="form-group">-->
                                <!--<a href=""-->
                                <!--data-toggle="tooltip"-->
                                <!--tooltip="Pay"-->
                                <!--tooltip-placement="top"-->
                                <!--ng-if="!dataInvoice.draft && !dataInvoice.paidStatus  && dataInvoice.closingBalance >= 0"-->
                                <!--class="btn btn-default btn-xs"-->
                                <!--ng-click="confirmPaid(dataInvoice.driver);"-->
                                <!--style="padding:1px 8px;">Pay</a>-->
                                <!--</div>-->
                                <!--<div class="form-group">-->
                                <!--<a href=""-->
                                <!--data-toggle="tooltip"-->
                                <!--tooltip="Pay"-->
                                <!--tooltip-placement="top"-->
                                <!--ng-if="!dataInvoice.draft && !dataInvoice.paidStatus && dataInvoice.closingBalance <0"-->
                                <!--class="btn btn-default btn-xs"-->
                                <!--ng-click="confirmPaid(dataInvoice.driver);"-->
                                <!--style="padding:1px 8px;">Accept</a>-->
                                <!--</div>-->
                                <!--</form>-->
                                <!--</td>-->
                                <td data-title="'Last&nbsp;Upt'" class="text-left" width="100">
                                    {{(dataInvoice.updatedOn)*1000 | date:"dd-MM-yy h:mma"}}<span
                                        ng-if="dataInvoice.updatedBy">,</span>
                                    {{dataInvoice.updatedBy}}
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="payout-daywise-div" ng-if="dayWiseList">
            <span ng-click="vm.hideDayWiseList();" class="close-payout-daywise-div pull-right"><i
                    class="fa fa-remove"></i></span>

                <div class="row" style="padding:5% 10%;">
                    <div class="col-md-2 col-sm-12 col-xs-12"></div>
                    <div class="col-md-8 col-sm-12 col-xs-12">
                        <div style="background: #fff; padding:40px;">
                            <div class="table-responsive">
                                <table class="table table-bordered table-striped text-center">
                                    <thead>
                                    <tr>
                                        <th class="text-center" colspan="2" width="100">Date</th>
                                        <th class="text-center" width="100">Type</th>
                                        <th class="text-center" width="100">Trip Count</th>
                                        <th class="text-right" width="100">Earning</th>
                                        <th class="text-right" width="100">Cash Collected</th>
                                        <th class="text-right" width="100">Tuktuk Share</th>
                                        <th class="text-right" width="100">Balance</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="row in dataDay.trip">
                                        <td class="text-left" colspan="2" width="100">
                                            {{(row.date)*1000 | date:"dd-MM-yy h:mma"}}
                                        </td>
                                        <td class="text-left" style="padding: 0 !important;" colspan="6">
                                            <table class="table  table-striped text-center no-mr"
                                                   style="background: transparent !important;">
                                                <tr ng-repeat="row1 in row.values"
                                                    style="background: transparent !important;">
                                                    <td class="text-center" width="100">
                                                        {{row1.action}}
                                                    </td>
                                                    <td class="text-center" width="100">
                                                        {{row1.tripCount}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row1.earning | number:2}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row1.cashCollected | number:2}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row1.commission | number:2}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row1.balance | number:2}}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="8" style="padding: 0">
                                            <table class="table  table-striped text-center no-mr">
                                                <tr>
                                                    <td class="text-center" colspan="2" width="100"></td>
                                                    <td class="text-center" width="100">
                                                        <b>EMI</b>
                                                    </td>
                                                    <td class="text-center" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b> {{vm.emi | number:2}}</b>
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b> - {{vm.emi | number:2}}</b>
                                                    </td>
                                                </tr>
                                                <tr style="background: transparent;">
                                                    <td class="text-center" colspan="2" width="100"></td>
                                                    <td class="text-center" width="100">
                                                        <b>Settled</b>
                                                    </td>
                                                    <td class="text-center" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">

                                                    </td>
                                                    <td class="text-right" width="100">
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b>{{vm.settled | number:2}}</b>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="8" style="padding: 0">
                                            <table class="table  table-striped text-center no-mr">
                                                <tr>
                                                    <td class="text-center" colspan="2" width="100"></td>
                                                    <td class="text-center" width="100">
                                                        <b>Balance</b>
                                                    </td>
                                                    <td class="text-center" width="100">
                                                        <b>{{vm.totalTripCount}}</b>
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b>{{vm.totalEarning | number:2}}</b>
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b>{{vm.cashCollection | number:2}}</b>
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b>{{vm.totalShare | number:2}}</b>
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        <b>{{vm.totalBalance | number:2}}</b>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-bordered table-striped text-center">
                                    <thead>
                                    <tr>
                                        <th class="text-center" colspan="2" width="100">Settlement
                                            {{dataSettledTrip.sc}}
                                        </th>
                                        <th class="text-center" width="100">Trip ID</th>
                                        <th class="text-center" width="100">Updated On</th>
                                        <th class="text-right" width="100">Amount</th>
                                        <th class="text-right" width="100">Reason</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="text-left" colspan="2" width="100">

                                        </td>
                                        <td class="text-left" style="padding: 0 !important;" colspan="6">
                                            <table class="table  table-striped text-center no-mr">
                                                <tr ng-repeat="row3 in dataSettledTrip.va"
                                                    style="background: transparent;">
                                                    <td class="text-center" width="100">
                                                        {{row3.tr}}
                                                    </td>
                                                    <td class="text-center" width="100">
                                                        {{(row3.up)*1000 | date:"dd-MM-yy h:mma"}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row3.am}}
                                                    </td>
                                                    <td class="text-right" width="100">
                                                        {{row3.re}}
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-12 col-xs-12"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 col-sm-12 col-xs-12">
            <div class="panel panel-default">
                <form class="form-inline pull-right no-mr pd-2-">
                    <div class="form-group ">
                        <input
                                ng-change="vm.onDateChangeTrips()"
                                class="form-control text-center"
                                type="daterange"
                                ng-model="driverTripDates"
                                separator=" - "
                                format="DD MMM YY"
                                opens="left"
                                ranges="vm.ranges"
                                style="margin: 8px 10px 0px 0px !important;
                                        padding: 0px;
                                        height: 20px;
                                        width: auto; font-size: 11px;">
                    </div>
                </form>
                <div class="panel-heading">
                    <h4 style="margin-top: 0" class="title">Trips</h4></div>
                <div class="panel-body">
                    <div>
                        <nvd3 options="vm.tripChartOptions" data="vm.tripData" config="vm.config"></nvd3>
                    </div>
                    <table ng-if="" ng-table="tableParams" class="table table-bordered">

                        <tr class="truncate"
                            ng-repeat="row in $data track by $index">
                            <td data-title="'Date'" sortable="'requestOn'" style="width: 145px;">
                                <a target="_blank"
                                   ui-sref="home.trip_detail({id: row.id})">
                                    {{(row.requestOn)*1000 | date:"dd MMM yy"}}
                                </a>

                            </td>
                            <td data-title="'Status'" sortable="'tripState'">
                                <div ng-if="row.tripState == 20" class="text-primary" style="white-space: nowrap">
                                    Requested
                                </div>
                                <div ng-if="row.tripState == 22" style="white-space: nowrap">Allocated</div>
                                <div ng-if="row.tripState == 30" style="white-space: nowrap">For Trip</div>
                                <div ng-if="row.tripState == 40" style="white-space: nowrap">At Pickup</div>
                                <div ng-if="row.tripState == 60" style="white-space: nowrap">At Destination</div>
                                <div ng-if="row.tripState == 50" class="text-info" style="white-space: nowrap">In
                                    trip
                                </div>
                                <div ng-if="row.tripState == 61" class="text-success" style="white-space: nowrap">
                                    Successful
                                </div>
                                <div ng-if="row.tripState == 70" class="text-warning" style="white-space: nowrap">
                                    Can by Driver
                                </div>
                                <div ng-if="row.tripState == 71" class="text-warning" style="white-space: nowrap">
                                    Can by Rider
                                </div>
                                <div ng-if="row.tripState == 80" style="white-space: nowrap">No Drv Avlble</div>
                                <div ng-if="row.tripState == 81" class="text-danger" style="white-space: nowrap">
                                    Failed (No Drivers Accepted)
                                </div>
                                <div ng-if="row.tripState == 82" style="white-space: nowrap">Terminated</div>
                            </td>
                            <td data-title="'Rider'">
                                {{row.riderInfo.name}}
                            </td>
                            <td data-title="'Driver Fare'" class="text-right">
                                <div>{{row.amount.driverFare | number:2}}<br>
                                </div>
                            </td>
                            <td data-title="'Rider Fare'" class="text-right">
                                <div>{{row.amount.riderFare | number:2}}</div>
                            </td>
                            <td data-title="'tCASH'" class="text-right">
                                <div>{{row.amount.tcash | number:2}}</div>
                            </td>
                            <td data-title="'Request On'" class="text-right">
                                <div>{{(row.requestOn)*1000 | date:"h:mma"}}</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-12 col-xs-12">
            <div class="panel panel-default">
                <form class="form-inline pull-right no-mr pd-2-">
                    <div class="form-group ">
                        <input
                                ng-change="vm.onDateChangeOnline()"
                                class="form-control text-center"
                                type="daterange"
                                ng-model="driverOnlineDates"
                                separator=" - "
                                format="DD MMM YY"
                                opens="left"
                                ranges="vm.ranges"
                                style="margin: 8px 10px 0px 0px !important;
                                        padding: 0px;
                                        height: 20px;
                                        width: auto; font-size: 11px;">
                    </div>
                </form>
                <div class="panel-heading">
                    <h4 style="margin-top: 0" class="title">Online Hours</h4></div>
                <div class="panel-body">
                    <div>
                        <nvd3 options="vm.onlineChartOptions" data="vm.online" config="vm.config"></nvd3>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<script type="text/ng-template" id="myPopoverTemplate1.html">

    <div class="box text-center">
        <h4 class="number no-mr">{{vm.profile.distance.inTrip | number:2}}</h4>
        <span>in trip</span>
        <br>
        <h4 class="number no-mr pd10-tp">{{vm.profile.distance.forTrip | number:2}}</h4>
        <span>for trip</span>

    </div>
</script>
<script type="text/ng-template" id="myPopoverTemplate2.html">

    <div class="box text-center">
        <h4 class="number no-mr">{{vm.profile.today_online.intrip_time | secondsToDateTime}}</h4>
        <span>in trip</span>
        <br>
        <h4 class="number no-mr pd10-tp">{{vm.profile.today_online.fortrip_time | secondsToDateTime}}</h4>
        <span>for trip</span>

    </div>
</script>
<script type="text/ng-template" id="myPopoverTemplate3.html">

    <div class="box text-center">
        <h4 class="number no-mr">{{vm.profile.today_bid.accepted}}</h4>
        <span>accepted</span>
        <br>
        <h4 class="number no-mr pd10-tp">{{vm.profile.today_bid.rejected}}</h4>
        <span>rejected</span>
        <br>
        <h4 class="number no-mr pd10-tp">{{vm.profile.today_bid.ignored}}</h4>
        <span>ignored</span>
    </div>
</script>
