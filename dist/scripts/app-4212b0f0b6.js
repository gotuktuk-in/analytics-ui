function TripsService(e,t,i){var r=i;return t("",{frequency:"@frequency",vehicle:"@vehicle",id:"@id"},{getAllTrips:{method:"GET",url:r+"trips"},getTripDetail:{method:"GET",url:r+"trips/info/:id",isArray:!1},getRiders:{method:"GET",url:r+"rider/:frequency/:vehicle",isArray:!0},getTCash:{method:"GET",url:r+"trips/tcash",isArray:!0}})}function RidersService(e,t,i){var r=i;return t("",{id:"@id"},{getRiders:{method:"GET",url:r+"trips/riderChart",isArray:!0}})}function PerformanceService(e,t,i,r){var a=i;return t("",{frequency:"@frequency",vehicle:"@vehicle"},{getTrips:{method:"GET",url:a+"trip/:frequency/:vehicle",isArray:!0},getDrivers:{method:"GET",url:a+"driver/:frequency/:vehicle",isArray:!0},getRiders:{method:"GET",url:a+"rider/:frequency/:vehicle",isArray:!0}})}function PerformanceHandler(){var e={};return e.trips=[],e.drivers=[],e.riders=[],e.filteredTrips=[{key:"Requests",values:[]},{key:"Requests (U)",values:[]},{key:"Cancelled",values:[]},{key:"Cancelled (U)",values:[]},{key:"Fulfilled",values:[]},{key:"Fulfilled (U)",values:[]},{key:"Cancelled trips (by rider)",values:[]},{key:"Cancelled trips (by driver)",values:[]},{key:"tCash",values:[]},{key:"Failed",values:[]},{key:"Failed (U)",values:[]}],e.filteredDrivers=[{key:"New Drivers",values:[]},{key:"Active Drivers",values:[]},{key:"Avg Trip/Driver",values:[]}],e.filteredRiders=[{key:"New Riders",values:[]},{key:"Active Riders",values:[]},{key:"Total Riders",values:[]}],e.getTrips=function(t){var i=[],r=[],a=[],s=[],n=[],o=[],l=[],c=[],d=[],u=[],h=[];return _.each(t,function(t){var p=e.getLongDate(t.id);i.push([p,t.requests.total]),r.push([p,t.requests.unique_riders]),a.push([p,t.cancelled.total]),s.push([p,t.cancelled.unique]),n.push([p,t.success.total]),o.push([p,t.success.unique_riders]),l.push([p,t.cancelled.cancelled_by_riders]),c.push([p,t.cancelled.cancelled_by_drivers]),u.push([p,t.failed.total]),h.push([p,t.failed.unique_riders]),d.push([p,t.tcash_used])}),e.filteredTrips[0].values=i,e.filteredTrips[1].values=r,e.filteredTrips[2].values=a,e.filteredTrips[3].values=s,e.filteredTrips[4].values=n,e.filteredTrips[5].values=o,e.filteredTrips[6].values=l,e.filteredTrips[7].values=c,e.filteredTrips[8].values=d,e.filteredTrips[9].values=u,e.filteredTrips[10].values=h,e.filteredTrips},e.getDrivers=function(t){var i=[],r=[],a=[];return _.each(t,function(t){var s=e.getLongDate(t.id);i.push([s,t.total_offline]),r.push([s,t.total_online]),a.push([s,t.average_rides_per_driver])}),e.filteredDrivers[0].values=i,e.filteredDrivers[1].values=r,e.filteredDrivers[2].values=a,e.filteredDrivers},e.getRiders=function(t){var i=[],r=[],a=[];return _.each(t,function(t){var s=e.getLongDate(t.id);i.push([s,t.newly_reg_riders]),r.push([s,t.active_riders]),a.push([s,t.total_riders])}),e.filteredRiders[0].values=i,e.filteredRiders[1].values=r,e.filteredRiders[2].values=a,e.filteredRiders},e.getLongDate=function(e){var t=e,i=t.substring(0,4),r=t.substring(4,6),a=t.substring(6,8),s=t.substring(8,10),n=new Date(i,r-1,a,s);return n},e}function OfferService(e,t,i,r){var a=i;return t("",{id:"@id"},{getOffers:{method:"GET",url:a+"offers",isArray:!1},getDrivers:{method:"GET",url:a+"drivers/list",isArray:!1},getDriverOffers:{method:"GET",url:a+"offers/driver/:id",isArray:!1},assignOffers:{method:"POST",url:a+"drivers/offers",isArray:!1}})}function MapService(e,t,i,r){var a=i;return t("",{id:"@id"},{getDrivers:{method:"GET",url:a+"map/driver"},loadGeoJson:{method:"GET",url:r+"geofence"},registerList:{method:"GET",url:a+"drivers/registered",isArray:!0},inprocessList:{method:"GET",url:a+"drivers/inprocess"},deleteInProcessDriver:{method:"DELETE",url:a+"drivers/:id"}})}function LoginService(e,t,i,r){var a=i,s=r;return t("",{id:"@id"},{doLogin:{method:"POST",url:s+"login"},logout:{method:"GET",url:a+"logout"}})}function LiveService(e,t,i){var r=i;return t("",{},{getOverview:{method:"GET",url:r+"overview/live/"},getTrips:{method:"GET",url:r+"trip/live/"},getDrivers:{method:"GET",url:r+"driver/live/"},getRiders:{method:"GET",url:r+"rider/live/"},getNewRiders:{method:"GET",url:r+"trips/newRiders",isArray:!0},heatmap:{method:"GET",url:r+"trips/heatmap",isArray:!0}})}function LiveHandler(){var e={};return e.trips=[],e.drivers=[],e.riders=[],e.filteredTrips=[{key:"Total Booking",values:[]},{key:"Total Successful Booking",values:[]},{key:"Unique Successful Booking",values:[]},{key:"In-Progress",values:[]},{key:"Total Cancelled",values:[]},{key:"Unique Cancelled",values:[]},{key:"Total Failed",values:[]},{key:"Unique Failed",values:[]}],e.filteredDrivers=[{key:"Total Drivers",values:[]},{key:"Free Drivers",values:[]},{key:"Occupied Driver",values:[]}],e.filteredRiders=[{key:"Total Riders",values:[]},{key:"New Riders",values:[]}],e.getTrips=function(){var t=[],i=[],r=[],a=[],s=[],n=[],o=[],l=[];return _.each(e.trips,function(c){var d=e.getLongDate(c.id);t.push([d,c.booking]),i.push([d,c.successful.total]),r.push([d,c.successful.unique_riders]),a.push([d,c.in_process]),s.push([d,c.cancelled.total]),n.push([d,c.cancelled.unique_riders]),o.push([d,c.failed.total]),l.push([d,c.failed.unique_rider])}),e.filteredTrips[0].values=t,e.filteredTrips[1].values=i,e.filteredTrips[2].values=r,e.filteredTrips[3].values=a,e.filteredTrips[4].values=s,e.filteredTrips[5].values=n,e.filteredTrips[6].values=o,e.filteredTrips[7].values=l,e.filteredTrips},e.getDrivers=function(){var t=[],i=[],r=[];return _.each(e.drivers,function(a){var s=e.getLongDate(a.id);t.push([s,a.total_count]),i.push([s,a.free_driver]),r.push([s,a.occupied_driver])}),e.filteredDrivers[0].values=t,e.filteredDrivers[1].values=i,e.filteredDrivers[2].values=r,e.filteredDrivers},e.getRiders=function(){var t=[],i=[];return _.each(e.riders,function(r){var a=e.getLongDate(r.id);t.push([a,r.total_riders]),i.push([a,r.new_rider_reg])}),e.filteredRiders[0].values=t,e.filteredRiders[1].values=i,e.filteredRiders},e.getLongDate=function(e){var t=e,i=t.substring(0,4),r=t.substring(4,6),a=t.substring(6,8),s=t.substring(8,10),n=new Date(i,r-1,a,s);return n},e}function InitChart(){var e=[{x:1,y:5},{x:20,y:20},{x:40,y:10},{x:60,y:40},{x:80,y:5},{x:100,y:60}],t=d3.select("#visualisation"),i=1e3,r=500,a={top:20,right:20,bottom:20,left:50},s=d3.scale.linear().range([a.left,i-a.right]).domain([d3.min(e,function(e){return e.x}),d3.max(e,function(e){return e.x})]),n=d3.scale.linear().range([r-a.top,a.bottom]).domain([d3.min(e,function(e){return e.y}),d3.max(e,function(e){return e.y})]),o=d3.svg.axis().scale(s).tickSize(5).tickSubdivide(!0),l=d3.svg.axis().scale(n).tickSize(5).orient("left").tickSubdivide(!0);t.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(r-a.bottom)+")").call(o),t.append("svg:g").attr("class","y axis").attr("transform","translate("+a.left+",0)").call(l);var c=d3.svg.line().x(function(e){return s(e.x)}).y(function(e){return n(e.y)}).interpolate("linear");t.append("svg:path").attr("d",c(e)).attr("stroke","blue").attr("stroke-width",2).attr("fill","none")}function DriversService(e,t,i){var r=i;return t("",{id:"@id"},{getTopDrivers:{method:"GET",url:r+"drivers/topdrivers",isArray:!0},getAcquisition:{method:"GET",url:r+"drivers/acquisition",isArray:!0},getProfile:{method:"GET",url:r+"drivers/profile/:id",isArray:!1},getTrips:{method:"GET",url:r+"drivers/:id/trips",isArray:!1}})}function PunchCardFunc(){return{restrict:"EA",scope:{title:"@",data:"="},link:function(e,t,i){var r={};r.element=t,r.data=[[{key:"Type A",value:"a"},{key:"Type b",value:"b"}],[{key:"RA",value:"ra"},{key:"RB",value:"ra"}]];new D3punchcard(r).draw({width:t.offsetWidth})}}}function UserService(e,t,i,r,a){this.user,this.setUser=function(e){this.user=e,t.putObject("tuktuk.performance.admin",this.user),r.isAuthenticated=!0},this.getUser=function(){return null!=this.user?this.user:(this.user=t.getObject("tuktuk.performance.admin"),(void 0==this.user||"undefined"==this.user)&&(this.user=null),this.user)},this.clearUser=function(){this.user=null,t.remove("tuktuk.performance.admin"),e.defaults.headers.common.Authorization=""}}function StaticDataService(e,t,i){var r={};return r.cities=[{name:"Indore",value:"indore"},{name:"Bhopal",value:"bhopal"}],r.vehicleTypes=[{name:"Auto",value:"auto"},{name:"Bike",value:"bike"}],r.ranges={Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},r}function ChartConfigService(e,t,i,r){var a={};return Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e),this},a.lineChartConfig={refreshDataOnly:!1},a.lineChartOptions={chart:{type:"lineChart",height:"400",zoom:{enabled:!0},interpolate:"basis",legend:{vers:"classic",maxKeyLength:400,margin:{top:5,right:0,bottom:30,left:0}},legendPosition:"top",margin:{top:0,right:20,bottom:100,left:50},x:function(e){return e[0]},y:function(e){return e[1]},color:d3.scale.category10().range(),duration:300,useInteractiveGuideline:!0,clipVoronoi:!1,showYAxis:!0,xAxis:{tickSize:"10",rotateLabels:"-90",tickFormat:function(e){return d3.time.format("%d %b %I %p")(new Date(e))},showMaxMin:!0,staggerLabels:!1,axisLabelDistance:0},x2Axis:{axisLabel:"Date",tickFormat:function(e){return d3.time.format("%I %p")(new Date(e))},showMaxMin:!0,staggerLabels:!1},yAxis:{axisLabel:"Trips",tickFormat:function(e){return d3.round(e)},showMaxMin:!0,axisLabelDistance:200}}},a.discreteBarChartOptions={chart:{type:"discreteBarChart",height:450,zoom:{enabled:!0},legend:{vers:"classic",maxKeyLength:400,margin:{top:5,right:0,bottom:30,left:0}},legendPosition:"top",margin:{top:30,right:50,bottom:100,left:55},x:function(e){return e.label},y:function(e){return e.value},showValues:!0,valueFormat:function(e){return d3.round(e)},duration:500,xAxis:{axisLabel:"",rotateLabels:"-90"},yAxis:{axisLabel:"",axisLabelDistance:-10}}},a.multiBarChartOptions={chart:{type:"multiBarChart",height:400,margin:{top:30,right:50,bottom:100,left:55},legend:{vers:"classic",maxKeyLength:400,margin:{top:5,right:0,bottom:30,left:0}},legendPosition:"top",text:"Credit Recovery",x:function(e){return e.x},y:function(e){return e.y},stacked:!0,showControls:!1,clipEdge:!0,transitionDuration:1e3,useInteractiveGuideline:!1,xAxis:{rotateLabels:"-90",ticks:d3.time.months,tickFormat:function(e){return d3.time.format("%d %b %y")(new Date(e))},showMaxMin:!1},yAxis:{tickFormat:function(e){return e}}}},a.linePlusBarChartOptions={chart:{type:"linePlusBarChart",height:400,focusEnable:!1,legend:{vers:"classic",maxKeyLength:400,margin:{top:5,right:100,bottom:30,left:0}},legendPosition:"left",margin:{top:30,right:75,bottom:100,left:75},bars:{forceY:[0]},color:["#ff7f0e","#e377c2"],x:function(e,t){return t},xAxis:{rotateLabels:"-90",axisLabel:"",tickFormat:function(e){var t=$scope.data[0].values[e]&&$scope.data[0].values[e].x||0;return t>0?d3.time.format("%x")(new Date(t)):null}}}},a}TripsService.$inject=["$q","$resource","API"],RidersService.$inject=["$q","$resource","API"],PerformanceService.$inject=["$q","$resource","API","StaticDataService"],OfferService.$inject=["$q","$resource","API","AUTH_API"],MapService.$inject=["$q","$resource","API","AUTH_API"],LoginService.$inject=["$q","$resource","API","AUTH_API"],LiveService.$inject=["$q","$resource","API"],DriversService.$inject=["$q","$resource","API"],UserService.$inject=["$http","$cookies","$resource","$rootScope","API"],StaticDataService.$inject=["$q","$resource","API"],ChartConfigService.$inject=["$q","$resource","API","PerformanceHandler"],function(){"use strict";angular.module("tuktukV2Dahboard",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","ngMap","ngDialog","ui.bootstrap","toastr","ngTable","rzModule","ngBootstrap","nvd3","httpInterceptor","ui-rangeSlider","angularjs-dropdown-multiselect","angularScreenfull"])}(),function(){"use strict";function e(){function e(){return t}var t=[{title:"AngularJS",url:"https://angularjs.org/",description:"HTML enhanced for web apps!",logo:"angular.png"},{title:"BrowserSync",url:"http://browsersync.io/",description:"Time-saving synchronised browser testing.",logo:"browsersync.png"},{title:"GulpJS",url:"http://gulpjs.com/",description:"The streaming build system.",logo:"gulp.png"},{title:"Jasmine",url:"http://jasmine.github.io/",description:"Behavior-Driven JavaScript.",logo:"jasmine.png"},{title:"Karma",url:"http://karma-runner.github.io/",description:"Spectacular Test Runner for JavaScript.",logo:"karma.png"},{title:"Protractor",url:"https://github.com/angular/protractor",description:"End to end test framework for AngularJS applications built on top of WebDriverJS.",logo:"protractor.png"},{title:"Bootstrap",url:"http://getbootstrap.com/",description:"Bootstrap is the most popular HTML, CSS, and JS framework for developing responsive, mobile first projects on the web.",logo:"bootstrap.png"},{title:"Angular UI Bootstrap",url:"http://angular-ui.github.io/bootstrap/",description:"Bootstrap components written in pure AngularJS by the AngularUI Team.",logo:"ui-bootstrap.png"}];this.getTec=e}angular.module("tuktukV2Dahboard").service("webDevTec",e)}(),function(){"use strict";function e(){function e(e){var t=this;t.relativeDate=e(t.creationDate).fromNow()}e.$inject=["moment"];var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("tuktukV2Dahboard").directive("acmeNavbar",e)}(),function(){"use strict";function e(e,t){function i(i){function a(e){return e.data}function s(t){e.error("XHR Failed for getContributors.\n"+angular.toJson(t.data,!0))}return i||(i=30),t.get(r+"/contributors?per_page="+i).then(a)["catch"](s)}var r="https://api.github.com/repos/Swiip/generator-gulp-angular",a={apiHost:r,getContributors:i};return a}e.$inject=["$log","$http"],angular.module("tuktukV2Dahboard").factory("githubContributor",e)}(),function(){"use strict";function e(e){function t(t,i,r,a){var s,n=e(i[0],{typeSpeed:40,deleteSpeed:40,pauseDelay:800,loop:!0,postfix:" "});i.addClass("acme-malarkey"),angular.forEach(t.extraValues,function(e){n.type(e).pause()["delete"]()}),s=t.$watch("vm.contributors",function(){angular.forEach(a.contributors,function(e){n.type(e.login).pause()["delete"]()})}),t.$on("$destroy",function(){s()})}function i(e,t){function i(){return r().then(function(){e.info("Activated Contributors View")})}function r(){return t.getContributors(10).then(function(e){return a.contributors=e,a.contributors})}var a=this;a.contributors=[],i()}i.$inject=["$log","githubContributor"];var r={restrict:"E",scope:{extraValues:"="},template:"&nbsp;",link:t,controller:i,controllerAs:"vm"};return r}e.$inject=["malarkey"],angular.module("tuktukV2Dahboard").directive("acmeMalarkey",e)}(),function(){"use strict";function e(e,t,i,r,a,s){function n(){a.getTripDetail({dId:r.driverId,rId:r.riderId},{id:r.id},function(t){e.selectedTrip=t},function(t){console.log(t),e.error=!0})}e.selectedTrip,n()}e.$inject=["$scope","$interval","PerformanceService","$stateParams","TripsService","$rootScope"],angular.module("tuktukV2Dahboard").controller("TripDetailController",e)}(),function(){"use strict";function e(e,t,i,r,a,s,n,o,l,c){function d(e){var t=[];e=angular.fromJson(e);var i=["tCash","Trip"],r={};r.key=i[0],r.values=[],r.bar=!0;for(var a=0;a<e.length;a++){var s=1e3*moment(c.getLongDate(e[a].date)).unix();r.values.push([s,e[a].tcash])}t.push(r);var r={};r.key=i[1],r.values=[];for(var a=0;a<e.length;a++){var s=1e3*moment(c.getLongDate(e[a].date)).unix();r.values.push([s,e[a].trip])}return t.push(r),t}var u,h=this;h.ranges=i.ranges,e.tripDates={},e.tripDates.startDate=i.ranges["Last 7 Days"][0],e.tripDates.endDate=i.ranges["Last 7 Days"][1],h.timeFrequency=[{label:"Per Hour",value:"hour"},{label:"Per Day",value:"day"}],h.tripFrequency={value:"day"},h.config=r.lineChartConfig,h.tripChartOptions=angular.copy(r.lineChartOptions),h.tcashChartOptions=angular.copy(r.linePlusBarChartOptions),h.tcashChartOptions.chart.xAxis={rotateLabels:"-90",axisLabel:"",tickFormat:function(e){var t=h.tcashData[0].values[e]&&h.tcashData[0].values[e].x||0;return t>0?d3.time.format("%d %b %y")(new Date(t)):null}},h.trips=[],h.filterTerm="",h.filterFields=[{value:"id",name:"ID"},{value:"dname",name:"Driver Name"},{value:"dphone",name:"Driver Phone"},{value:"dvehicle",name:"Vehicle Number"},{value:"rname",name:"Rider Name"},{value:"rphone",name:"Rider Phone"}],h.statusCodes="",h.tripStatusFilters=[{name:"All",value:"20,22,30,40,50,60,61,70,71,80,81,82"},{name:"Fullfiled",value:"61"},{name:"Cancelled ",value:"70,71"},{name:"In Progress",value:"20,22,30,40,50,60"},{name:"Failed",value:"80,81,82"}],h.searchTable=function(){e.tableParams.reload()},this.changeFrequency=function(e,t){console.log("Frequency changed ",t.value),h.tripChartOptions.chart.xAxis.axisLabel=t,"hour"==t?h.tripChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %I %p")(new Date(e).addHours(1))}:h.tripChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %y")(new Date(e))},h.getTrips()},h.onDateChange=function(){h.getTCash(),h.getTrips()},h.getTCash=function(){o.getTCash({city:l.city,startTime:e.tripDates.startDate,endTime:e.tripDates.endDate,vehicle:l.vehicleType},{},function(e){h.tcashData=d(e).map(function(e){return e.values=e.values.map(function(e){return{x:e[0],y:e[1]}}),e}),console.log("response ",h.tcashData)},function(t){console.log(t),e.error=!0}),e.tableParams.reload()},h.getTrips=function(){a.getTrips({city:l.city,startTime:e.tripDates.startDate,endTime:e.tripDates.endDate,count:1,page:1,rate:h.tripFrequency.value},{vehicle:l.vehicleType,frequency:h.tripFrequency.value},function(e){h.trips=c.getTrips(e[0].trip),h.trips=_.without(h.trips,_.findWhere(h.trips,{key:"Cancelled trips (by rider)"})),h.trips=_.without(h.trips,_.findWhere(h.trips,{key:"Cancelled trips (by driver)"})),h.trips=_.without(h.trips,_.findWhere(h.trips,{key:"tCash"})),u=e[0].trip},function(t){console.log(t),e.error=!0}),e.tableParams.reload()};e.getTimeDiff=function(e,t){if(0==e||0==t)return"0";if(t){var i=t-e;return i}return"0"},e.tableParams=new s({page:1,count:20},{counts:[],getData:function(t){var i=10*(t.page()-1)+1;console.log("**************************");var r={};if(r.start=i,r.count=t.count(),r.startDate=moment(e.tripDates.startDate).startOf("day").unix(),r.endDate=moment(e.tripDates.endDate).endOf("day").unix(),t.orderBy().length>0){var a=t.orderBy()[0].substr(0,1);r.field=t.orderBy()[0].substr(1),"+"===a?r.orderby="ASC":r.orderby="DESC"}return h.searchTerm&&""!=h.searchTerm&&(r.term=h.filterTerm.value+"|"+h.searchTerm),""!=h.statusCodes.value&&(r.filterByStatus=h.statusCodes.value),o.getAllTrips(r).$promise.then(function(i){return t.total(i.total),i.data.length>0?e.tblNoData=!1:e.tblNoData=!0,i.data})}}),h.onDateChange();var p=t(function(){h.getTrips(),e.tableParams.reload()},3e4);e.$on("$destroy",function(){t.cancel(p)}),heatmapChart(u)}e.$inject=["$scope","$interval","StaticDataService","ChartConfigService","PerformanceService","NgTableParams","$stateParams","TripsService","$rootScope","PerformanceHandler"],angular.module("tuktukV2Dahboard").controller("TripsController",e)}();var margin={top:50,right:0,bottom:100,left:30},width=960-margin.left-margin.right,height=430-margin.top-margin.bottom,gridSize=Math.floor(width/24),legendElementWidth=2*gridSize,buckets=9,colors=["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],days=["Mo","Tu","We","Th","Fr","Sa","Su"],times=["1a","2a","3a","4a","5a","6a","7a","8a","9a","10a","11a","12a","1p","2p","3p","4p","5p","6p","7p","8p","9p","10p","11p","12p"];datasets=["data.tsv","data2.tsv"];var svg=d3.select("#chart").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),dayLabels=svg.selectAll(".dayLabel").data(days).enter().append("text").text(function(e){return e}).attr("x",0).attr("y",function(e,t){return t*gridSize}).style("text-anchor","end").attr("transform","translate(-6,"+gridSize/1.5+")").attr("class",function(e,t){return t>=0&&4>=t?"dayLabel mono axis axis-workweek":"dayLabel mono axis"}),timeLabels=svg.selectAll(".timeLabel").data(times).enter().append("text").text(function(e){return e}).attr("x",function(e,t){return t*gridSize}).attr("y",0).style("text-anchor","middle").attr("transform","translate("+gridSize/2+", -6)").attr("class",function(e,t){return t>=7&&16>=t?"timeLabel mono axis axis-worktime":"timeLabel mono axis"}),heatmapChart=function(e){d3.tsv(e,function(e){return{day:+e.day,hour:+e.hour,value:+e.value}},function(e,t){var i=d3.scale.quantile().domain([0,buckets-1,d3.max(t,function(e){return e.value})]).range(colors),r=svg.selectAll(".hour").data(t,function(e){return e.day+":"+e.hour});r.append("title"),r.enter().append("rect").attr("x",function(e){return(e.hour-1)*gridSize}).attr("y",function(e){return(e.day-1)*gridSize}).attr("rx",4).attr("ry",4).attr("class","hour bordered").attr("width",gridSize).attr("height",gridSize).style("fill",colors[0]),r.transition().duration(1e3).style("fill",function(e){return i(e.value)}),r.select("title").text(function(e){return e.value}),r.exit().remove();var a=svg.selectAll(".legend").data([0].concat(i.quantiles()),function(e){return e});a.enter().append("g").attr("class","legend"),a.append("rect").attr("x",function(e,t){return legendElementWidth*t}).attr("y",height).attr("width",legendElementWidth).attr("height",gridSize/2).style("fill",function(e,t){return colors[t]}),a.append("text").attr("class","mono").text(function(e){return"? "+Math.round(e)}).attr("x",function(e,t){return legendElementWidth*t}).attr("y",height+gridSize),a.exit().remove()})};angular.module("tuktukV2Dahboard").factory("TripsService",TripsService),function(){"use strict";function e(e,t,i,r,a,s,n,o,l,c,d,u,h){function p(){l.getRiders({},function(e){g.ridersData=m(JSON.parse(angular.toJson(e))),v()},function(t){console.log(t),e.error=!0})}function v(){var e=document.getElementById("matrixChartDiv").offsetWidth,t=document.getElementById("matrixChartDiv").offsetWidth-180,i=dimple.newSvg("#matrixChart",e,450),r=new dimple.chart(i,g.ridersData);r.setBounds(90,50,t,350),r.addCategoryAxis("x","rider_reg"),r.addCategoryAxis("y","week"),r.addSeries("week",dimple.plot.bar),r.addLegend(240,10,330,20,"right"),r.draw()}function m(e){var t=[];return _.each(e,function(e){_.each(e.values,function(i){var r={};r.rider_reg=e.rider_reg,r.week=i.week,r.total_request=i.total_request,r.unique_request=i.unique_request,r.fulfill_request=i.fulfill_request,r.unique_fulfill_request=i.unique_fulfill_request,t.push(r)})}),t}var g=this;p();var f;$(window).resize(function(){clearTimeout(f),f=setTimeout(function(){document.getElementById("matrixChartDiv").offsetWidth,document.getElementById("matrixChartDiv").offsetWidth-180;$("#matrixChart").empty(),p()},500)})}e.$inject=["$scope","$log","$rootScope","$interval","StaticDataService","ChartConfigService","PerformanceService","PerformanceHandler","RidersService","NgTableParams","ngTableEventsChannel","LiveService","$resource"],angular.module("tuktukV2Dahboard").controller("RidersController",e)}(),angular.module("tuktukV2Dahboard").factory("RidersService",RidersService),function(){"use strict";function e(e,t,i,r,a,s,n,o){var l=this;l.ranges=i.ranges,e.tripDates={},e.tripDates.startDate=moment().subtract(1,"days").format("YYYY-MM-DD"),e.tripDates.endDate=moment().subtract(1,"days").format("YYYY-MM-DD"),e.driverDates=angular.copy(e.tripDates),e.riderDates=angular.copy(e.tripDates),l.timeFrequency=[{label:"Per Hour",value:"hour"},{label:"Per Day",value:"day"}],l.tripFrequency={value:"hour"},l.driverFrequency={value:"hour"},l.riderFrequency={value:"hour"},l.config=r.lineChartConfig,l.tripChartOptions=angular.copy(r.lineChartOptions),l.driverChartOptions=angular.copy(r.lineChartOptions),l.riderChartOptions=angular.copy(r.lineChartOptions),l.trips=[],l.drivers=[],l.riders=[],this.changeFrequency=function(e,t){switch(console.log("Frequency changed ",t.value),e){case"driver":l.driverChartOptions.chart.xAxis.axisLabel=t,"hour"==t?l.driverChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %I %p")(new Date(e).addHours(1))}:l.driverChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %y")(new Date(e))},l.getDrivers();break;case"rider":l.riderChartOptions.chart.xAxis.axisLabel=t,"hour"==t?l.riderChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %I %p")(new Date(e).addHours(1))}:l.riderChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %y")(new Date(e))},l.getRiders();break;default:l.tripChartOptions.chart.xAxis.axisLabel=t,"hour"==t?l.tripChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %I %p")(new Date(e).addHours(1))}:l.tripChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %y")(new Date(e))},l.getTrips()}},l.getTrips=function(){n.getTrips({city:s.city,startTime:e.tripDates.startDate,endTime:e.tripDates.endDate,count:1,page:1,rate:l.tripFrequency.value},{vehicle:s.vehicleType,frequency:l.tripFrequency.value},function(e){l.trips=o.getTrips(e[0].trip),l.trips.overview=e[0].overview},function(t){console.log(t),e.error=!0})},l.getDrivers=function(){n.getDrivers({city:s.city,startTime:e.tripDates.startDate,endTime:e.tripDates.endDate,count:1,page:1,rate:l.driverFrequency.value},{vehicle:s.vehicleType,frequency:l.driverFrequency.value},function(e){l.drivers=o.getDrivers(e),console.log("vm.drivers ",l.drivers)},function(t){console.log(t),e.error=!0})},l.getRiders=function(){n.getRiders({city:s.city,startTime:e.tripDates.startDate,endTime:e.tripDates.endDate,count:1,page:1,rate:l.riderFrequency.value},{vehicle:s.vehicleType,frequency:l.riderFrequency.value},function(e){l.riders=o.getRiders(e[0].riders),l.riders.overview=e[0].overview,console.log("vm.riders ",o.riders)},function(t){console.log(t),e.error=!0})},l.getAllData=function(){l.getTrips(),l.getDrivers(),l.getRiders()},l.getAllData();var c=t(function(){l.getAllData()},3e4);e.$on("$destroy",function(){t.cancel(c)})}e.$inject=["$scope","$interval","StaticDataService","ChartConfigService","$stateParams","$rootScope","PerformanceService","PerformanceHandler"],angular.module("tuktukV2Dahboard").controller("PerformanceController",e)}(),angular.module("tuktukV2Dahboard").factory("PerformanceService",PerformanceService),angular.module("tuktukV2Dahboard").factory("PerformanceHandler",PerformanceHandler),function(e){function t(e){function t(t){return this.data=t.data.reverse(),this.element=t.element,this.max=e.max(this.data,function(t){return e.max(t.slice(1),function(e){return parseFloat(e.value)})}),t.upperLimit?this.upperLimit=t.upperLimit:this.upperLimit=this.max,this}return t.prototype.draw=function(t){function i(){var t=e.select(this).node().parentNode;e.select(t).selectAll("circle").style("display","none"),e.select(t).selectAll("text.value").style("display","block")}function r(){var t=e.select(this).node().parentNode;e.select(t).selectAll("circle").style("display","block"),e.select(t).selectAll("text.value").style("display","none")}var a,s,n,o,l,c,d=10,u=5,h=t.width,p=80,v=h-p,m=35,g=m*this.data.length,f=v/this.data[0].length,y=14;return a=e.scale.linear().domain([0,this.data[0].length-1]).range([p+f/2,v+f/2]),s=e.scale.linear().domain([0,this.data.length-1]).range([0,g-m]),c=e.scale.linear().domain([0,this.upperLimit,this.max]).range([0,y,y]),n=e.select(this.element).html("").append("svg").attr("width",h).attr("height",g+3*d).append("g"),l=n.selectAll(".row").data([this.data[0].slice(1)]).enter().append("g").attr("class","xaxis"),l.append("line").attr("x1",0).attr("x2",h).attr("y1",3*d).attr("y2",3*d).style("stroke-width",1).style("stroke","#efefef"),l.selectAll("line.tick").data(function(e,t){return e}).enter().append("line").attr("class","tick").attr("x1",function(e,t){return p+a(t)}).attr("x2",function(e,t){return p+a(t)}).attr("y1",function(e,t){return 2*d}).attr("y2",function(e,t){return 3*d}).style("stroke-width",1).style("stroke","#efefef"),l.selectAll(".rule").data(function(e,t){return e}).enter().append("text").attr("class","rule").attr("x",function(e,t){return p+a(t)}).attr("y",d+u).attr("text-anchor","middle").text(function(e){return e.key}),o=n.selectAll(".row").data(this.data).enter().append("g").attr("class","row").attr("transform",function(e,t){var i=g-s(t)-m/2+3*d;return"translate(0, "+i+")"}),o.selectAll("line").data([0]).enter().append("line").attr("x1",0).attr("x2",h).attr("y1",m/2).attr("y2",m/2).style("stroke-width",1).style("stroke","#efefef"),o.selectAll(".textheader").data(function(e,t){return[e[0]]}).enter().append("text").attr("x",0).attr("y",function(e,t){return u}).attr("class","textheader").attr("text-anchor","left").text(function(e,t){return e.value}).on("mouseover",i).on("mouseout",r),o.selectAll("circle").data(function(e,t){return e.slice(1)}).enter().append("circle").style("fill","#888").attr("r",function(e,t){return c(parseFloat(e.value))}).attr("transform",function(e,t){var i=p+a(t);return"translate("+i+", 0)"}),o.selectAll("text.value").data(function(e,t){return e.slice(1)}).enter().append("text").attr("class","value").style("display","none").text(function(e,t){return e.value}).attr("text-anchor","middle").attr("x",function(e,t){return p+a(t)}).attr("y",function(e,t){return u}),this},t.prototype.destroy=function(){e.select(this.element).selectAll("text.textheader").on("mouseover",null).on("mouseout",null)},t}"object"==typeof exports?module.exports=t(require("d3")):"function"==typeof define&&define.amd?define(["d3"],t):e.D3punchcard=t(e.d3)}(this),function(){"use strict";function e(e,t,i,r,a,s){var n=this;n.offers=[],n.drivers=[],n.selectedOffers=[],n.selectedDrivers=[],n.offerCheckboxes={},n.driverCheckboxes={},n.noDriversSelected=!1,n.noOffersSelected=!1,n.filterTerm="",n.filterFields=[{value:"id",name:"Driver ID"},{value:"name",name:"Driver Name"},{value:"phone",name:"Driver Phone"}],n.addOffer=function(e){_.find(n.selectedOffers,{id:e.id})||n.selectedOffers.push(e)},n.removeOffer=function(e){n.selectedOffers.splice(e,1)},n.addDriver=function(e){_.find(n.selectedDrivers,{id:e.id})||n.selectedDrivers.push(e)},n.addDrivers=function(){n.noDriversSelected=!1;var t=_.pairs(n.driverCheckboxes.items);return 0==t.length?void(n.noDriversSelected=!0):void _.each(t,function(t){if(1==t[1]&&!_.find(n.selectedDrivers,{id:t[0]})){var i=_.find(e.driverTableParams.data,{id:t[0]});n.addDriver(i)}})},n.addOffers=function(){var t=_.pairs(n.offerCheckboxes.items);_.each(t,function(t){if(0==n.selectedOffers.length&&1==t[1]){var i=_.find(e.offerTableParams.data,{id:Number(t[0])});n.addOffer(i)}if(1==t[1]&&!_.find(n.selectedOffers,{id:Number(t[0])})){var i=_.find(e.offerTableParams.data,{id:Number(t[0])});n.addOffer(i)}})},n.removeDriver=function(e){n.selectedDrivers.splice(e,1)},n.searchOffers=function(){e.offerTableParams.reload()},n.searchDrivers=function(){e.driverTableParams.reload()},n.clearOfferSearch=function(){n.offerTxt="",e.offerTableParams.reload()},n.refreshPage=function(){e.driverTableParams.reload(),e.offerTableParams.reload()},n.clearDriverSearch=function(){n.driverTxt="",e.driverTableParams.reload()},n.assignOffers=function(){if(confirm("Are you sure you want to save?")){var e={};e.drivers=_.pluck(n.selectedDrivers,"id"),e.offers=_.pluck(n.selectedOffers,"code"),e.status=!0,t.assignOffers({},e,function(e){a.success("Offers assigned to selected drivers."),n.clearAll()},function(e){a.error("Error : "+e)})}},n.openSingleAlert=function(e,t){s.open({template:"alertSingleDelete.html",className:"ngdialog-theme-plain",overlay:!0,resolve:{index:function(){return e},row:function(){return t}},controller:function(e,t,i,r){e.index=t,
e.row=i,console.log(t,i),e.removeSingleOffer=function(e,t){var i={};i.drivers=[t.id],i.offers=[t.offers[e]],i.status=!1,r.assignOffers({},i,function(i){a.success("Offer removed."),t.offers.splice(e,1)},function(e){a.error("Error : "+e)})}}})},n.alertDeleteAllOffers=function(t){n.currentRow=t,s.open({template:"alert.html",className:"ngdialog-theme-plain",scope:e,overlay:!0})},n.removeAllAssignedOffers=function(){t.getDriverOffers({id:n.currentRow.id},function(e){var i={};i.drivers=[n.currentRow.id],i.offers=e.offers,i.status=!1,t.assignOffers({},i,function(e){a.success("All offers removed for this driver."),n.refreshPage()},function(e){a.error("Error : "+e)})},function(e){a.error("Error : "+e)})},n.getDriverOffers=function(e){t.getDriverOffers({id:e.id},function(t){e.offers=t.offers},function(e){a.error("Error : "+e)})},n.clearAll=function(){n.selectedOffers=[],n.selectedDrivers=[]},e.offerTableParams=new i({page:1,count:10},{counts:[],getData:function(i){var r=10*(i.page()-1)+1;console.log("**************************");var a={};if(a.start=r,a.count=i.count(),i.orderBy().length>0){var s=i.orderBy()[0].substr(0,1);a.field=i.orderBy()[0].substr(1),"+"===s?a.orderby="ASC":a.orderby="DESC"}return n.offerTxt&&""!=n.offerTxt&&(a.term="code|"+n.offerTxt),t.getOffers(a).$promise.then(function(t){return i.total(t.total),t.data.length>0?e.tblNoData=!1:e.tblNoData=!0,n.offerCheckboxes={checked:!1,items:{}},t.data})}}),e.driverTableParams=new i({page:1,count:10},{counts:[],getData:function(i){var r=10*(i.page()-1)+1;console.log("**************************");var a={};if(a.start=r,a.count=i.count(),i.orderBy().length>0){var s=i.orderBy()[0].substr(0,1);a.field=i.orderBy()[0].substr(1),"+"===s?a.orderby="ASC":a.orderby="DESC"}return n.driverTxt&&""!=n.driverTxt&&(a.term=n.filterTerm.value+"|"+n.driverTxt),t.getDrivers(a).$promise.then(function(t){return i.total(t.total),t.data.length>0?e.tblNoData=!1:e.tblNoData=!0,n.driverCheckboxes={checked:!1,items:{}},t.data})}}),e.$watch(function(){return n.offerCheckboxes.checked},function(t){angular.forEach(e.offerTableParams.data,function(e){n.offerCheckboxes.items[e.id]=t,console.log("value ",t)})}),e.$watch(function(){return n.offerCheckboxes.items},function(t){var i=0,a=0,s=e.offerTableParams.data.length;angular.forEach(e.offerTableParams.data,function(e){i+=n.offerCheckboxes.items[e.id]||0,a+=!n.offerCheckboxes.items[e.id]||0}),(0==a||0==i)&&(n.offerCheckboxes.checked=i==s),angular.element(r[0].getElementsByClassName("select-all")).prop("indeterminate",0!=i&&0!=a)},!0),e.$watch(function(){return n.driverCheckboxes.checked},function(t){var i=0;angular.forEach(e.driverTableParams.data,function(e){n.driverCheckboxes.items[e.id]=t,i++})}),e.$watch(function(){return n.driverCheckboxes.items},function(t){var i=0,a=0,s=e.driverTableParams.data.length;angular.forEach(e.driverTableParams.data,function(e){i+=n.driverCheckboxes.items[e.id]||0,a+=!n.driverCheckboxes.items[e.id]||0}),(0==a||0==i)&&(n.driverCheckboxes.checked=i==s),angular.element(r[0].getElementsByClassName("select-all-drivers")).prop("indeterminate",0!=i&&0!=a)},!0)}e.$inject=["$scope","OfferService","NgTableParams","$element","toastr","ngDialog"],angular.module("tuktukV2Dahboard").controller("OffersController",e)}(),angular.module("tuktukV2Dahboard").factory("OfferService",OfferService),function(){"use strict";function e(e,t,i,r,a,s){function n(){r.getDrivers({city:i.city,vehicle:i.vehicleType},function(e){o.allDrivers=e,console.log("vm.drivers ",o.allDrivers)},function(e){console.log("error ",e)})}var o=this;o.API_URL=s,o.allDrivers=[],console.log("map cont loaded"),a.getMap({id:"drivers_map"}).then(function(e){o.map=e,o.map&&o.map.data&&o.map.data.forEach(function(e){o.map.data.remove(e)}),e.data.setStyle({fillColor:"gray",strokeWeight:1,strokeOpacity:.1,fillOpacity:.1}),r.loadGeoJson({},function(e){o.geoJSON={},o.geoJSON=e,o.map.data.addGeoJson(o.geoJSON)},function(e){console.log("error ",e)})}),o.getAddress=function(e){alert("get address")},o.clicked=function(e){console.log("Clicked a link inside infoWindow",e);var t=parseFloat(e[0]),i=parseFloat(e[1]),r=new google.maps.LatLng(t,i),a=new google.maps.Geocoder;a.geocode({latLng:r},function(e,t){t==google.maps.GeocoderStatus.OK&&e[1]&&(o.driver.address=e[1].formatted_address)})},n(),o.showDetail=function(e,t,i){o.driver=t,o.map.showInfoWindow("iw-drivers",i)},o.hideDetail=function(){o.map.hideInfoWindow("iw-drivers")},o.getAddress=function(){o.map.hideInfoWindow("iw-drivers")}}e.$inject=["$scope","$log","$rootScope","MapService","NgMap","AUTH_API"],angular.module("tuktukV2Dahboard").controller("MapsController",e)}(),angular.module("tuktukV2Dahboard").factory("MapService",MapService),function(){"use strict";function e(e,t,i,r,a,s){e.cities=s.cities,e.vehicleTypes=s.vehicleTypes,i.selectedCity=s.cities[0],i.selectedVehicle=s.vehicleTypes[0],e.ChangeCity=function(e){i.selectedCity=e,i.city=e.value,r.go(r.current.name,{city:i.city,vehicleType:i.vehicleType})},e.ChangeVehicle=function(e){i.selectedVehicle=e,i.vehicleType=e.value,r.go(r.current.name,{city:i.city,vehicleType:i.vehicleType})},e.status={isopen:!1},e.toggled=function(e){t.log("Dropdown is now: ",e)}}e.$inject=["$scope","$log","$rootScope","$state","$stateParams","StaticDataService"],angular.module("tuktukV2Dahboard").controller("MainController",e)}(),function(){"use strict";function e(e,t,i,r,a,s,n,o,l){e.loginUser=function(){s.doLogin(e.user,function(e){console.log(e),e.success?(n.setUser(e),r.defaults.headers.common.Authorization="Basic "+e.token,i.isAuthenticated=!0,a.go("home.live",{city:i.city,vehicleType:i.vehicleType}),o.success("You are successfully logged in.")):o.error(e.msg)},function(e){console.log(e),o.error(e.data.msg)})}}e.$inject=["$scope","$log","$rootScope","$http","$state","LoginService","UserService","toastr","StaticDataService"],angular.module("tuktukV2Dahboard").controller("LoginController",e)}(),angular.module("tuktukV2Dahboard").factory("LoginService",LoginService),function(){"use strict";function e(e,t,i,r,a,s,n,o,l,c,d){function u(){l.getOverview({city:i.city,vehicle:i.vehicleType},function(e){f.overview=e},function(t){console.log(t),e.error=!0})}function h(){l.getNewRiders({from:moment(x).subtract(6,"days").startOf("day").unix(),to:moment(x).endOf("day").unix()},function(e){f.newRiders=p(e),console.log("response ",f.newRiders)},function(t){console.log(t),e.error=!0})}function p(e){var t=[],i=JSON.parse(angular.toJson(e)),r=0,a=0,s=["today","1 day ago","2 day ago","3 day ago","4 day ago","5 day ago","6 day ago","Above 7 days"];_.each(i,function(e){var i={};i.key=s[a],i.bar=!0,i.values=[],t.push(i),a++});var n={};return n.key=s[a],n.bar=!0,n.values=[],t.push(n),_.each(i,function(e){for(var i=e,a=0;7>=a;a++)t[a].values[r]={},t[a].values[r].x=d.getLongDate(i.date),t[a].values[r].y=Number(e.value[a].totalRides),t[a].values[r].uniqRides=Number(e.value[a].uniqRides),"Others"===e.value[a].id?t[a].values[r].date=e.value[a].id:t[a].values[r].date=Number(e.value[a].id);r++}),t}function v(){l.getOverview({city:i.city,vehicle:i.vehicleType,startTime:moment(x).startOf("day"),endTime:moment(x).endOf("day")},function(e){f.overview=e},function(t){console.log(t),e.error=!0})}function m(){c.getTrips({city:i.city,startTime:moment(x).startOf("day"),endTime:moment(x).endOf("day"),count:1,page:1,rate:"hour"},{vehicle:i.vehicleType,frequency:"hour"},function(t){f.trips=d.getTrips(t[0].trip),c.getDrivers({city:i.city,startTime:moment(x).startOf("day"),endTime:moment(x).endOf("day"),count:1,page:1,rate:"hour"},{vehicle:i.vehicleType,frequency:"hour"},function(e){f.drivers=d.getDrivers(e),f.trips=_.union(f.trips,f.drivers),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"Cancelled trips (by rider)"})),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"Cancelled trips (by driver)"})),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"tCash"})),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"New Drivers"})),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"Active Drivers"})),f.trips=_.without(f.trips,_.findWhere(f.trips,{key:"Avg Trip/Driver"}))},function(t){console.log(t),e.error=!0})},function(t){console.log(t),e.error=!0});f.resizeMap=function(){google.maps.event.trigger(f.map,"resize")},f.heatMapDataLength,f.loadHeatMap=function(){var t=moment(x).hour(e.rangSlider.min).unix(),r=moment(x).hour(e.rangSlider.max).unix();l.heatmap({city:i.city,vehicle:i.vehicleType,from:t,to:r,state:f.selected.id},function(e){f.heatMapDataLength=e.length;var t=[],i=[];_.forEach(e,function(e){t.push(new google.maps.LatLng(e.locPickupRequest.lt-0,e.locPickupRequest.ln-0))}),n.getMap({id:"live_map"}).then(function(e){f.map=e,g&&g.setMap(null),i=new google.maps.MVCArray(t),g=new google.maps.visualization.HeatmapLayer({data:i}),g.setMap(f.map)})},function(t){console.log(t),e.error=!0})}}var g,f=this,y=moment();f.heatMapFilers=[{label:"In-Process",id:"20,22,30,40,50"},{label:"Failed",id:"72,80,81,82"},{label:"Cancel",id:"70,71"},{label:"Success",id:"61"}],f.selected=f.heatMapFilers[0],e.rangSlider={max:24,min:0},e.slider={minValue:0,maxValue:24,options:{floor:0,ceil:24,showTicksValues:0,translate:function(e){return e+"h"},keyboardSupport:!1,onEnd:function(t,i,r,a){e.rangSlider.min=i,e.rangSlider.max=r,f.loadHeatMap()}}},e.ddSettings={enableSearch:!1},e.date=moment().format("dddd, MMMM Do YYYY"),f.config=o.lineChartConfig,f.tripChartOptions=angular.copy(o.lineChartOptions),f.newRidersChartOptions=angular.copy(o.multiBarChartOptions),f.newRidersChartOptions.chart.tooltip={contentGenerator:function(e,t,i,r,a){var s,n=e.data;s="Others"===n.date?"Above 7 days":moment(d.getLongDate(n.date.toString())).format("MMMM Do YYYY");var o='<div class="pd-10 text-left"><span><b>';return o+=s+" </b></span>",o+='<h3 class="no-mr">'+n.y+'<small style="color:#333;"> /'+n.uniqRides+'</small><br><small style="font-size:10px;color:#666;text-transform: uppercase;">Total Rides / Rides(U)</small></h3>',o+="</div>"}},f.tripChartOptions.chart.xAxis.tickFormat=function(e){return d3.time.format("%I %p")(new Date(e).addHours(1))},f.trips=[];var x=moment();f.live=!0,f.changeDate=function(t){"next"==t?(x=moment(x).add(1,"day"),e.date=moment(x).format("dddd, MMMM Do YYYY")):(x=moment(x).subtract(1,"day"),e.date=moment(x).format("dddd, MMMM Do YYYY"),console.log("$scope.date ",e.date)),moment(x).unix()==moment(y).unix()?(f.live=!0,u()):(f.live=!1,v()),m(),h(),f.loadHeatMap()},f.newRiders=[{values:[{x:1359072e6,y:10,label:"C1.1"},{x:13651164e5,y:30,label:"C1.2"},{x:13575168e5,y:40,label:"C1.3"}],bar:!0,key:"Carrier1"},{values:[{x:1359072e6,y:30,label:"C2.1"},{x:13651164e5,y:10,label:"C2.2"},{x:13575168e5,y:79,label:"C2.3"}],bar:!0,key:"Carrier2"}],h(),m(),u(),f.loadHeatMap();var b=a(function(){f.refreshPage()},3e4);e.$on("$destroy",function(){a.cancel(b)}),f.refreshPage=function(){m(),f.loadHeatMap(),h(),f.live?u():v()}}e.$inject=["$scope","$log","$rootScope","$state","$interval","$stateParams","NgMap","ChartConfigService","LiveService","PerformanceService","PerformanceHandler"],angular.module("tuktukV2Dahboard").controller("LiveController",e)}(),angular.module("tuktukV2Dahboard").factory("LiveService",LiveService),angular.module("tuktukV2Dahboard").factory("LiveHandler",LiveHandler),function(){"use strict";function e(e,t,i,r,a,s,n,o,l,c){var d=this;moment();d.ranges=a.ranges,e.selectedDates={},e.selectedDates.startDate=moment().format("YYYY-MM-DD"),e.selectedDates.endDate=moment().format("YYYY-MM-DD"),d.getProfile=function(){s.getProfile({id:t.driverId,from:moment(e.selectedDates.startDate).startOf("day").format("YYYYMMDD").toString(),to:moment(e.selectedDates.endDate).endOf("day").format("YYYYMMDD").toString()},function(e){d.profile=e},function(t){console.log(t),e.error=!0})},d.getProfile(),d.getAllData=function(){d.getProfile(),e.tableParams.reload()};var u=r(function(){d.getAllData()},3e4);e.$on("$destroy",function(){r.cancel(u)}),e.getTimeDiff=function(e,t){var i;if(0==e)return"0";i=0==t?new Date:new Date(1e3*t);var r=new Date(1e3*e),a=moment.utc(moment(r,"DD/MM/YYYY HH:mm:ss").diff(moment(i,"DD/MM/YYYY HH:mm:ss"))),s="";return a.hours()>0&&(s=a.hours()+" hr "),s+=a.minute()+" min "},e.tableParams=new n({page:1,count:20,sorting:{earning:"desc"}},{counts:[],getData:function(i){var r=10*(i.page()-1)+1;console.log("**************************");var a="",n="";return i.orderBy().length>0&&(a=i.orderBy()[0].substr(0,1),n=i.orderBy()[0].substr(1),a="+"===a?"ASC":"DESC"),s.getTrips({startDate:moment(e.selectedDates.startDate).startOf("day").unix(),endDate:moment(e.selectedDates.endDate).endOf("day").unix(),orderby:a,field:n,start:r,count:i.count()},{id:t.driverId}).$promise.then(function(t){return i.total(t.total),console.log("trop ",t),t.data.length>0?e.tblNoData=!1:e.tblNoData=!0,t.data})}})}e.$inject=["$scope","$stateParams","$rootScope","$interval","StaticDataService","DriversService","NgTableParams","ngTableEventsChannel","LiveService","$resource"],angular.module("tuktukV2Dahboard").controller("DriversDetailController",e)}(),InitChart(),function(){"use strict";function e(e,t,i,r,a,s,n,o,l,c,d,u,h){function p(){u.getOverview({city:i.city,vehicle:i.vehicleType},function(e){v.overview=e},function(t){console.log(t),e.error=!0})}var v=this,m=moment(),g=(moment(),moment());v.live=!0,v.acquisitionData=[],v.ranges=a.ranges,v.config=s.lineChartConfig,v.acquisitionChart=angular.copy(s.discreteBarChartOptions),v.acquisitionChart.chart.xAxis.tickFormat=function(e){return d3.time.format("%d %b %y")(new Date(e))},e.date=moment().format("dddd, MMMM Do YYYY"),e.datesForAcq={},e.datesForAcq.startDate=moment().subtract(7,"days").format("YYYY-MM-DD"),e.datesForAcq.endDate=moment().format("YYYY-MM-DD"),v.changeDate=function(t){"next"==t?(g=moment(g).add(1,"day"),e.date=moment(g).format("dddd, MMMM Do YYYY")):(g=moment(g).subtract(1,"day"),e.date=moment(g).format("dddd, MMMM Do YYYY"),console.log("$scope.date ",e.date)),moment(g).unix()==moment(m).unix()?v.live=!0:v.live=!1,e.tableParams.reload(),e.tableParams.page(1),v.getAcquisition()},v.filterTerm="",v.filterFields=[{value:"id",name:"Driver ID"},{value:"dname",name:"Driver Name"},{value:"dphone",name:"Driver Phone"},{value:"dvehicle",name:"Vehicle Number"},{value:"vehicleType",name:"Vehicle Type"},{value:"riderFeedbackRating",name:"Feedback Rating "}],v.statusCodes="",v.tripStatusFilters=[{name:"All",value:"20,22,30,40,50,60,61,70,71"},{name:"Occupied",value:"61"},{name:"Unoccupied ",value:"70,71"},{name:"Offline",value:"20,22,30,40,50,60"}],v.searchTable=function(){e.tableParams.reload()},v.getAcquisition=function(){console.log(e.datesForAcq),l.getAcquisition({city:i.city,vehicle:i.vehicleType,from:moment(e.datesForAcq.startDate).startOf("day").format("YYYYMMDD").toString(),to:moment(e.datesForAcq.endDate).endOf("day").format("YYYYMMDD").toString()},function(e){v.acquisitionData=[];var t=[];_.each(e,function(e){t.push({label:o.getLongDate(e.id),value:e.count})}),v.acquisitionData.push({key:"Drivers",values:t}),console.log("vm.acquisitionData ",v.acquisitionData)},function(t){console.log(t),e.error=!0})},p(),v.getAcquisition();var f=r(function(){p(),v.getAcquisition(),e.tableParams.reload(),e.tableParams.page(1)},3e4);e.$on("$destroy",function(){r.cancel(f)}),e.tableParams=new c({page:1,count:20,sorting:{earning:"desc"}},{counts:[],getData:function(t){var r=t.page();console.log("**************************");var a="",s="";t.orderBy().length>0&&(a=t.orderBy()[0].substr(0,1),s=t.orderBy()[0].substr(1),a="+"===a?"ASC":"DESC");var n={city:i.city,vehicle:i.vehicleType,from:moment(g).startOf("day").format("YYYYMMDD").toString(),to:moment(g).endOf("day").format("YYYYMMDD").toString(),orderby:a,field:s,start:r,count:t.count()};return v.searchTerm&&""!=v.searchTerm&&(n.term=v.filterTerm.value+"|"+v.searchTerm),""!=v.statusCodes.value&&(n.filterByStatus=v.statusCodes.value),l.getTopDrivers(n).$promise.then(function(i){return t.total(i.total),console.log("trop ",i),i.length>0?e.tblNoData=!1:e.tblNoData=!0,i})}})}e.$inject=["$scope","$log","$rootScope","$interval","StaticDataService","ChartConfigService","PerformanceService","PerformanceHandler","DriversService","NgTableParams","ngTableEventsChannel","LiveService","$resource"],angular.module("tuktukV2Dahboard").controller("DriversController",e)}(),angular.module("tuktukV2Dahboard").factory("DriversService",DriversService),angular.module("httpInterceptor",[]).config(["$provide","$httpProvider","$compileProvider",function(e,t,i){var r=$(),a=$('<div class="app-loader"><div class="text-center" style="padding:10%"><img src="assets/images/ring.svg" title="Tuktuk" height="100px"></div></div>').appendTo($("body")).hide();t.interceptors.push(["$q","$rootScope","$location","$cookies",function(e,t,i,r){return{request:function(t){var i=t.url.indexOf(".html");return-1==i&&a.show(),t.params&&t.params.startTime&&t.params.endTime&&("hour"==t.params.rate?(t.params.startTime=moment(t.params.startTime).startOf("day").format("YYYYMMDDHH").toString(),t.params.endTime=moment(t.params.endTime).endOf("day").format("YYYYMMDDHH").toString()):(t.params.startTime=moment(t.params.startTime).startOf("day").format("YYYYMMDD").toString(),t.params.endTime=moment(t.params.endTime).endOf("day").format("YYYYMMDD").toString())),t||e.when(t)},requestError:function(t){return a.hide(),canRecover(t)?responseOrNewPromise:e.reject(t)},response:function(e){var t=e.config.url.indexOf(".html");return-1==t&&a.hide(),e},responseError:function(i){switch(a.hide(),i.status){case 401:t.$broadcast("unauthorized");break;case 403:break;case 500:}return e.reject(i)}}}]),i.directive("appMessages",function(){var e={link:[function(e,t,i){r.push($(t))}]};return e})}]),angular.module("tuktukV2Dahboard").filter("secondsToDateTime",[function(){return function(e){var t=new Date(1e3*e),i="",r=t.getUTCHours(),a=t.getUTCMinutes(),s=t.getUTCSeconds();return r&&(i+=r+":"),a&&(i+=a+":"),s&&(i+=s+""),i}}]),angular.module("tuktukV2Dahboard").directive("ngPunchCard",PunchCardFunc),angular.module("tuktukV2Dahboard").service("UserService",UserService),angular.module("tuktukV2Dahboard").factory("StaticDataService",StaticDataService),angular.module("tuktukV2Dahboard").factory("ChartConfigService",ChartConfigService),function(){"use strict";function e(e,t,i,r,a,s,n,o,l){null!=t.getUser()&&(r.defaults.headers.common.Authorization="Basic "+t.getUser().token),e.debug("runBlock end"),n.city=i.cities[0].value,n.vehicleType=i.vehicleTypes[0].value,n.logout=function(){o.logout({},function(e){a.error("You have logged out successfully.")},function(e){a.error(e)}),t.clearUser(),s.go("login"),n.isAuthenticated=!1},n.$on("unauthorized",function(){t.clearUser(),s.go("login"),n.isAuthenticated=!1}),n.$on("$stateChangeStart",function(e,i,r,a,o){console.log("to - "+i.name+" $state.current.name - "+s.current.name),null!=t.getUser()&&"login"==i.name&&(n.isAuthenticated=!0,s.go("home.live",{city:n.city,vehicleType:n.vehicleType}),e.preventDefault())})}e.$inject=["$log","UserService","StaticDataService","$http","toastr","$state","$rootScope","LoginService","$templateCache"],angular.module("tuktukV2Dahboard").run(e)}(),function(){"use strict";function e(e,t){t.otherwise("/login"),e.state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginController",controllerAs:"vm"}).state("home",{url:"/home",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main","abstract":!0}).state("home.performance",{url:"/performance/:city/:vehicleType",templateUrl:"app/performance/performance.html",controller:"PerformanceController",controllerAs:"vm"}).state("home.maps",{url:"/maps/:city/:vehicleType",templateUrl:"app/maps/maps.html",controller:"MapsController",controllerAs:"vm",cache:!1}).state("home.live",{url:"/live/:city/:vehicleType",templateUrl:"app/live/live.html",controller:"LiveController",controllerAs:"vm"}).state("home.drivers",{url:"/drivers/:city/:vehicleType",templateUrl:"app/drivers/drivers.html",controller:"DriversController",controllerAs:"vm"}).state("home.offers",{url:"/offers/",templateUrl:"app/offers/offers.html",controller:"OffersController",controllerAs:"vm"}).state("home.drivers_detail",{url:"/detail/:driverId",templateUrl:"app/drivers/detail.html",controller:"DriversDetailController",controllerAs:"vm"}).state("home.trips",{url:"/trips",templateUrl:"app/trips/trips.html",controller:"TripsController",controllerAs:"vm"}).state("home.trip_detail",{url:"/tripdetail/:id/:driverId/:riderId",templateUrl:"app/trips/trip_details.html",controller:"TripDetailController",controllerAs:"vm"}).state("home.riders",{url:"/riders",templateUrl:"app/riders/riders.html",controller:"RidersController",controllerAs:"vm"})}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("tuktukV2Dahboard").config(e)}(),function(){"use strict";angular.module("tuktukV2Dahboard").constant("malarkey",malarkey).constant("moment",moment).constant("API","https://dev-api-analytics.gotuktuk.in/rest/v1/").constant("AUTH_API","https://dev-api-analytics.gotuktuk.in/rest/o/v1/")}(),function(){"use strict";function e(e,t){e.debugEnabled(!0),t.allowHtml=!0,t.timeOut=1e3,t.positionClass="toast-top-right",t.preventDuplicates=!1,t.progressBar=!1}e.$inject=["$logProvider","toastrConfig"],angular.module("tuktukV2Dahboard").config(e)}(),!function(e,t){"use strict";if("object"==typeof exports)module.exports=t(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(i){return e.dimple=t(i),e.dimple});else if(e.d3)e.dimple=t(e.d3);else{if(!console||!console.warn)throw"dimple requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("dimple requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(e){"use strict";var t={version:"2.1.6",plot:{},aggregateMethod:{}};return t.axis=function(i,r,a,s,n,o){this.chart=i,this.position=r,this.categoryFields=null===n||void 0===n?a:[].concat(n),this.measure=s,this.timeField=n,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null===o||void 0===o?!0:o,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var e,t,i=[],r=!1;if(this.chart&&this.chart.series){for(e=0;e<this.chart.series.length;e+=1)t=this.chart.series[e],t[this.position]===this&&(t.data&&t.data.length>0?i=i.concat(t.data):r=!0);r&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){var e;return e=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var t,i,r,a,s,n,o;return null!==this.tickFormat&&void 0!==this.tickFormat?t=this._hasTimeField()?e.time.format(this.tickFormat):e.format(this.tickFormat):this.showPercent?t=e.format("%"):this.useLog&&null!==this.measure?t=function(t){var i=Math.floor(Math.abs(t),0).toString().length,r=Math.min(Math.floor((i-1)/3),4),a="kmBT".substring(r-1,r),s="0"===Math.round(t/Math.pow(1e3,r)*10).toString().slice(-1)?0:1;return 0===t?0:e.format(",."+s+"f")(t/Math.pow(1e3,r))+a}:null!==this.measure?(i=Math.floor(Math.abs(this._max),0).toString(),r=Math.floor(Math.abs(this._min),0).toString(),a=Math.max(r.length,i.length),a>3?(s=Math.min(Math.floor((a-1)/3),4),n="kmBT".substring(s-1,s),o=1>=a-3*s?1:0,t=function(t){return 0===t?0:e.format(",."+o+"f")(t/Math.pow(1e3,s))+n}):(o=-Math.floor(Math.log(this._tick_step)/Math.LN10),t=e.format(",."+o+"f"))):t=function(e){return e},t},this._getTimePeriod=function(){var t=this.timePeriod,i=30,r=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(t=i>=r/1e3?e.time.seconds:i>=r/6e4?e.time.minutes:i>=r/36e5?e.time.hours:i>=r/864e5?e.time.days:i>=r/6048e5?e.time.weeks:i>=r/26298e5?e.time.months:e.time.years),t},this._getTooltipText=function(t,i){if(this._hasTimeField())i[this.position+"Field"][0]&&t.push(this.timeField+": "+this._getFormat()(i[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach(function(e,r){null!==e&&void 0!==e&&i[this.position+"Field"][r]&&t.push(e+(i[this.position+"Field"][r]!==e?": "+i[this.position+"Field"][r]:""))},this);else if(this._hasMeasure())switch(this.position){case"x":t.push(this.measure+": "+this._getFormat()(i.width));break;case"y":t.push(this.measure+": "+this._getFormat()(i.height));break;case"p":t.push(this.measure+": "+this._getFormat()(i.angle)+" ("+e.format("%")(i.piePct)+")");break;default:t.push(this.measure+": "+this._getFormat()(i[this.position+"Value"]))}},this._getTopMaster=function(){var e=this;return null!==this.master&&void 0!==this.master&&(e=this.master._getTopMaster()),e},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(t){var i;return i=null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(t)?Date.parse(t):new Date(t):e.time.format(this.dateParseFormat).parse(t)},this._update=function(i){var r,a,s,n,o=[],l=this.ticks||10,c=function(e,i,r){var a,s,n=e.categoryFields[0],o=e._getAxisData(),l=n,c=!1,d=!0,u=null;for(a=0;a<o.length;a+=1)if(u=e._parseDate(o[a][n]),null!==u&&void 0!==u&&isNaN(u)){d=!1;break}return d||e.chart.series.forEach(function(t){t[i]===e&&t[r]._hasMeasure()&&(l=t[r].measure,c=!0)},this),s=e._orderRules.concat({ordering:l,desc:c}),t._getOrderedList(o,n,s)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!i){if("y"!==this.position||null!==this._scale&&!i)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=e.scale.log().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=e.scale.linear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=e.scale.log().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=e.scale.linear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=e.scale.linear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=e.time.scale().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=e.scale.log().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(e){o=o.concat(c(e,"y","x"))},this),this._scale=e.scale.ordinal().rangePoints([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(o.concat([""]))):this._scale=e.scale.linear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=e.svg.axis().orient("left").scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=e.svg.axis().orient("right").scale(this._scale),this.ticks&&this._draw.ticks(l)}}else if(this._hasTimeField()?this._scale=e.time.scale().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=e.scale.log().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(e){o=o.concat(c(e,"x","y"))},this),this._scale=e.scale.ordinal().rangePoints([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(o.concat([""]))):this._scale=e.scale.linear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=e.svg.axis().orient("bottom").scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=e.svg.axis().orient("top").scale(this._scale),this.ticks&&this._draw.ticks(l)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach(function(e){e._scale=this._scale},this),null!==i&&void 0!==i&&i!==!1||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(l).length>0)||"x"!==this.position&&"y"!==this.position||(r=this._scale.ticks(l),a=r[1]-r[0],s=((this._max-this._min)%a).toFixed(0),this._tick_step=a,0!==s&&(this._max=Math.ceil(this._max/a)*a,this._min=Math.floor(this._min/a)*a,this._update(!0))),n=null!==o&&void 0!==o&&o.length>0?this._scale.copy()(o[0]):this._min>0?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==n&&(this._previousOrigin=null===this._origin?n:this._origin,this._origin=n),this},this.addGroupOrderRule=function(e,t){this._groupOrderRules.push({ordering:e,desc:t})},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})}},t.chart=function(i,r){this.svg=i,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=r,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease="cubic-in-out",this.staggerDraw=!1,this._group=i.append("g"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(e,t){var i=0,r=0,a=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===e){a=r;break}(null===t||void 0===t||t[0]===this.axes[i].position[0])&&(r+=1)}return a},this._getAllData=function(){var e=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(e=e.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach(function(t){null!==t.data&&void 0!==t.data&&t.data.length>0&&(e=e.concat(t.data))}),e},this._getData=function(i,r,a,s,n,o,l,c,d,u){var h,p,v=[],m=function(e,t){var i=[];return null!==e&&(e._hasTimeField()?i.push(e._parseDate(t[e.timeField])):e._hasCategories()&&e.categoryFields.forEach(function(e){i.push(t[e])},this)),i},g={x:!1,y:!1,z:!1,p:!1,c:!1},f={x:[],y:[]},y={x:[],y:[],z:[],p:[]},x={min:null,max:null},b={x:[],y:[],z:[],p:[]},_=[],w={},k={x:0,y:0,z:0,p:0},D="",T=[],F=[],C=[],S="",P=[],O="",A=[],M="",L=[],B=[],q=i,$=[];
this.storyboard&&this.storyboard.categoryFields.length>0&&(D=this.storyboard.categoryFields[0],T=t._getOrderedList(q,D,this.storyboard._orderRules)),o&&o._hasCategories()&&o._hasMeasure()&&(S=o.categoryFields[0],P=t._getOrderedList(q,S,o._orderRules.concat([{ordering:o.measure,desc:!0}]))),l&&l._hasCategories()&&l._hasMeasure()&&(O=l.categoryFields[0],A=t._getOrderedList(q,O,l._orderRules.concat([{ordering:l.measure,desc:!0}]))),d&&d._hasCategories()&&d._hasMeasure()&&(M=d.categoryFields[0],L=t._getOrderedList(q,M,d._orderRules.concat([{ordering:d.measure,desc:!0}]))),q.length>0&&r&&r.length>0&&(B=[].concat(s),F=[],r.forEach(function(e){void 0!==q[0][e]&&F.push(e)},this),d&&d._hasMeasure()?B.push({ordering:d.measure,desc:!0}):u&&u._hasMeasure()?B.push({ordering:u.measure,desc:!0}):c&&c._hasMeasure()?B.push({ordering:c.measure,desc:!0}):o&&o._hasMeasure()?B.push({ordering:o.measure,desc:!0}):l&&l._hasMeasure()&&B.push({ordering:l.measure,desc:!0}),C=t._getOrderedList(q,F,B)),q.sort(function(e,t){var i,r,a,s,n,o,l=0;if(""!==D&&(l=T.indexOf(e[D])-T.indexOf(t[D])),""!==S&&0===l&&(l=P.indexOf(e[S])-P.indexOf(t[S])),""!==O&&0===l&&(l=A.indexOf(e[O])-A.indexOf(t[O])),""!==M&&0===l&&(l=L.indexOf(e[M])-A.indexOf(t[M])),F&&F.length>0&&0===l)for(i=[].concat(F),l=0,a=0;a<C.length;a+=1){for(r=[].concat(C[a]),n=!0,o=!0,s=0;s<i.length;s+=1)n=n&&e[i[s]]===r[s],o=o&&t[i[s]]===r[s];if(n&&o){l=0;break}if(n){l=-1;break}if(o){l=1;break}}return l}),q.forEach(function(e){var t,i,s,n,h,p=-1,f=m(o,e),y=m(l,e),x=m(c,e),b=m(d,e),_=[];if(r&&0!==r.length)for(s=0;s<r.length;s+=1)void 0===e[r[s]]?_.push(r[s]):_.push(e[r[s]]);else _=["All"];for(t=_.join("/")+"_"+f.join("/")+"_"+y.join("/")+"_"+b.join("/")+"_"+x.join("/"),i=0;i<v.length;i+=1)if(v[i].key===t){p=i;break}-1===p&&(n={key:t,aggField:_,xField:f,xValue:null,xCount:0,yField:y,yValue:null,yCount:0,pField:b,pValue:null,pCount:0,zField:x,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},v.push(n),p=v.length-1),h=function(t,i){var r,s,n=!0,o={value:0,count:1},l={value:0,count:1},c="";null!==i&&(r=i.getFrameValue(),i.categoryFields.forEach(function(t,i){i>0&&(c+="/"),c+=e[t],n=c===r},this)),null!==t&&void 0!==t&&n&&(s=v[p],t._hasMeasure()&&null!==e[t.measure]&&void 0!==e[t.measure]&&(-1===s[t.position+"ValueList"].indexOf(e[t.measure])&&s[t.position+"ValueList"].push(e[t.measure]),isNaN(parseFloat(e[t.measure]))&&(g[t.position]=!0),o.value=s[t.position+"Value"],o.count=s[t.position+"Count"],l.value=e[t.measure],s[t.position+"Value"]=a(o,l),s[t.position+"Count"]+=1))},h(o,this.storyboard),h(l,this.storyboard),h(c,this.storyboard),h(d,this.storyboard),h(u,this.storyboard)},this),o&&o._hasCategories()&&o.categoryFields.length>1&&void 0!==f.x&&($=[],l._hasMeasure()&&$.push({ordering:l.measure,desc:!0}),f.x=t._getOrderedList(q,o.categoryFields[1],o._groupOrderRules.concat($))),l&&l._hasCategories()&&l.categoryFields.length>1&&void 0!==f.y&&($=[],o._hasMeasure()&&$.push({ordering:o.measure,desc:!0}),f.y=t._getOrderedList(q,l.categoryFields[1],l._groupOrderRules.concat($)),f.y.reverse()),v.forEach(function(e){null!==o&&(g.x===!0&&(e.xValue=e.xValueList.length),h=(y.x[e.xField.join("/")]||0)+(l._hasMeasure()?Math.abs(e.yValue):0),y.x[e.xField.join("/")]=h),null!==l&&(g.y===!0&&(e.yValue=e.yValueList.length),h=(y.y[e.yField.join("/")]||0)+(o._hasMeasure()?Math.abs(e.xValue):0),y.y[e.yField.join("/")]=h),null!==d&&(g.p===!0&&(e.pValue=e.pValueList.length),h=(y.p[e.pField.join("/")]||0)+(d._hasMeasure()?Math.abs(e.pValue):0),y.p[e.pField.join("/")]=h),null!==c&&(g.z===!0&&(e.zValue=e.zValueList.length),h=(y.z[e.zField.join("/")]||0)+(c._hasMeasure()?Math.abs(e.zValue):0),y.z[e.zField.join("/")]=h),null!==u&&((null===x.min||e.cValue<x.min)&&(x.min=e.cValue),(null===x.max||e.cValue>x.max)&&(x.max=e.cValue))},this);for(p in y.x)y.x.hasOwnProperty(p)&&(k.x+=y.x[p]);for(p in y.y)y.y.hasOwnProperty(p)&&(k.y+=y.y[p]);for(p in y.p)y.p.hasOwnProperty(p)&&(k.p+=y.p[p]);for(p in y.z)y.z.hasOwnProperty(p)&&(k.z+=y.z[p]);return v.forEach(function(t){var i,r,a,s,h,p=function(e,i,r){var a,s,o,l,c;null!==e&&void 0!==e&&(l=e.position,e._hasCategories()?e._hasMeasure()?(a=t[e.position+"Field"].join("/"),s=e.showPercent?y[e.position][a]/k[e.position]:y[e.position][a],-1===_.indexOf(a)&&(w[a]=s+(_.length>0?w[_[_.length-1]]:0),_.push(a)),o=t[l+"Bound"]=t["c"+l]="x"!==l&&"y"!==l||!n?s:w[a],t[r]=s,t[l]=o-("x"===l&&s>=0||"y"===l&&0>=s?s:0)):(t[l]=t["c"+l]=t[l+"Field"][0],t[r]=1,void 0!==f[l]&&null!==f[l]&&f[l].length>=2&&(t[l+"Offset"]=f[l].indexOf(t[l+"Field"][1]),t[r]=1/f[l].length)):(s=e.showPercent?t[l+"Value"]/y[i][t[i+"Field"].join("/")]:t[l+"Value"],a=t[i+"Field"].join("/")+(t[l+"Value"]>=0),c=b[l][a]=(null===b[l][a]||void 0===b[l][a]||"z"===l||"p"===l?0:b[l][a])+s,o=t[l+"Bound"]=t["c"+l]="x"!==l&&"y"!==l||!n?s:c,t[r]=s,t[l]=o-("x"===l&&s>=0||"y"===l&&0>=s?s:0)))};p(o,"y","width"),p(l,"x","height"),p(c,"z","r"),p(d,"p","angle"),null!==u&&null!==x.min&&null!==x.max&&(x.min===x.max&&(x.min-=.5,x.max+=.5),x.min=u.overrideMin||x.min,x.max=u.overrideMax||x.max,t.cValue=t.cValue>x.max?x.max:t.cValue<x.min?x.min:t.cValue,a=e.scale.linear().range([0,null===u.colors||1===u.colors.length?1:u.colors.length-1]).domain([x.min,x.max]),s=a(t.cValue),h=s-Math.floor(s),t.cValue===x.max&&(h=1),u.colors&&1===u.colors.length?(i=e.rgb(u.colors[0]),r=e.rgb(this.getColor(t.aggField.slice(-1)[0]).fill)):u.colors&&u.colors.length>1?(i=e.rgb(u.colors[Math.floor(s)]),r=e.rgb(u.colors[Math.ceil(s)])):(i=e.rgb("white"),r=e.rgb(this.getColor(t.aggField.slice(-1)[0]).fill)),i.r=Math.floor(i.r+(r.r-i.r)*h),i.g=Math.floor(i.g+(r.g-i.g)*h),i.b=Math.floor(i.b+(r.b-i.b)*h),t.fill=i.toString(),t.stroke=i.darker(.5).toString())},this),v},this._getDelay=function(e,i,r){return function(a){var s=0;return r&&i.staggerDraw&&(r.x._hasCategories()?s=t._helpers.cx(a,i,r)/i._widthPixels()*e:r.y._hasCategories()&&(s=(1-t._helpers.cy(a,i,r)/i._heightPixels())*e)),s}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(e){var t,i,r,a,s,n,o=e.data||this.data||[],l=[].concat(e.categoryFields||"All"),c=this._getData(o,l,e.aggregate,e._orderRules,e._isStacked(),e.x,e.y,e.z,e.p,e.c),d=[],u={},h=e.startAngle*(Math.PI/180)||0,p=(e.endAngle||360)*(Math.PI/180);if(h>p&&(h-=2*Math.PI),e.p&&l.length>0){if(e.x&&e.y){for(l.pop(),d=this._getData(o,["__dimple_placeholder__"].concat(l),e.aggregate,e._orderRules,e._isStacked(),e.x,e.y,e.z,e.p,e.c),t=0;t<c.length;t+=1)for(r=["__dimple_placeholder__"].concat(c[t].aggField),r.pop(),e.x&&e.x._hasCategories()&&(r=r.concat(c[t].xField)),e.y&&e.y._hasCategories()&&(r=r.concat(c[t].yField)),a=r.join("|"),i=0;i<d.length;i+=1)if(s=[].concat(d[i].aggField),e.x&&e.x._hasCategories()&&(s=s.concat(d[i].xField)),e.y&&e.y._hasCategories()&&(s=s.concat(d[i].yField)),n=s.join("|"),a===n){c[t].xField=d[i].xField,c[t].xValue=d[i].xValue,c[t].xCount=d[i].xCount,c[t].yField=d[i].yField,c[t].yValue=d[i].yValue,c[t].yCount=d[i].yCount,c[t].zField=d[i].zField,c[t].zValue=d[i].zValue,c[t].zCount=d[i].zCount,c[t].x=d[i].x,c[t].y=d[i].y,c[t].r=d[i].r,c[t].xOffset=d[i].xOffset,c[t].yOffset=d[i].yOffset,c[t].width=d[i].width,c[t].height=d[i].height,c[t].cx=d[i].cx,c[t].cy=d[i].cy,c[t].xBound=d[i].xBound,c[t].yBound=d[i].yBound,c[t].xValueList=d[i].xValueList,c[t].yValueList=d[i].yValueList,c[t].zValueList=d[i].zValueList,c[t].cValueList=d[i].cValueList,c[t].pieKey=d[i].key,c[t].value=c.pValue,u[d[i].key]||(u[d[i].key]={total:0,angle:h}),u[d[i].key].total+=c[t].pValue;break}}else for(t=0;t<c.length;t+=1)c[t].pieKey="All",c[t].value=c.pValue,u[c[t].pieKey]||(u[c[t].pieKey]={total:0,angle:h}),u[c[t].pieKey].total+=c[t].pValue;for(t=0;t<c.length;t+=1)c[t].piePct=c[t].pValue/u[c[t].pieKey].total,c[t].startAngle=u[c[t].pieKey].angle,c[t].endAngle=c[t].startAngle+c[t].piePct*(p-h),u[c[t].pieKey].angle=c[t].endAngle}e._positionData=c},this)},this._handleTransition=function(e,t,i,r){var a=null;return a=0===t?e:e.transition().duration(t).delay(i._getDelay(t,i,r)).ease(i.ease)},this._heightPixels=function(){return t._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(i){null!==i._eventHandlers&&i._eventHandlers.length>0&&i._eventHandlers.forEach(function(r){var a,s=function(a){var s=new t.eventArgs;null!==i.chart.storyboard&&(s.frameValue=i.chart.storyboard.getFrameValue()),s.seriesValue=a.aggField,s.xValue=a.x,s.yValue=a.y,s.zValue=a.z,s.pValue=a.p,s.colorValue=a.cValue,s.seriesShapes=i.shapes,s.selectedShape=e.select(this),r.handler(s)};if(null!==r.handler&&"function"==typeof r.handler)if(null!==i._markers&&void 0!==i._markers)for(a in i._markers)i._markers.hasOwnProperty(a)&&i._markers[a].on(r.event,s);else i.shapes.on(r.event,s)},this)},this._widthPixels=function(){return t._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return t._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return t._parseYPosition(this.y,this.svg.node())},this.addAxis=function(e,i,r,a){var s=null,n=null;if(null!==i&&void 0!==i&&(i=[].concat(i)),"string"==typeof e||e instanceof String)s=new t.axis(this,e,i,r,a),this.axes.push(s);else{if(n=e,s=new t.axis(this,n.position,i,r,a),s._hasMeasure()!==n._hasMeasure())throw"You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.";if(s._hasTimeField()!==n._hasTimeField())throw"You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.";if((null===s.categoryFields||void 0===s.categoryFields?0:s.categoryFields.length)!==(null===n.categoryFields||void 0===n.categoryFields?0:n.categoryFields.length))throw"You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type.";n._slaves.push(s)}return s},this.addCategoryAxis=function(e,t){return this.addAxis(e,t,null)},this.addColorAxis=function(e,t){var i=this.addAxis("c",null,e);return i.colors=null===t||void 0===t?null:[].concat(t),i},this.addLegend=function(e,i,r,a,s,n){n=null===n||void 0===n?this.series:[].concat(n),s=null===s||void 0===s?"left":s;var o=new t.legend(this,e,i,r,a,s,n);return this.legends.push(o),o},this.addLogAxis=function(e,t,i){var r=this.addAxis(e,null,t,null);return null!==i&&void 0!==i&&(r.logBase=i),r.useLog=!0,r},this.addMeasureAxis=function(e,t){return this.addAxis(e,null,t)},this.addPctAxis=function(e,t,i){var r=null;return r=null!==i&&void 0!==i?this.addAxis(e,i,t):this.addMeasureAxis(e,t),r.showPercent=!0,r},this.addSeries=function(e,i,r){(null===r||void 0===r)&&(r=this.axes),(null===i||void 0===i)&&(i=t.plot.bubble);var a,s=null,n=null,o=null,l=null,c=null;return r.forEach(function(e){null!==e&&i.supportedAxes.indexOf(e.position)>-1&&(null===s&&"x"===e.position[0]?s=e:null===n&&"y"===e.position[0]?n=e:null===o&&"z"===e.position[0]?o=e:null===l&&"c"===e.position[0]?l=e:null===l&&"p"===e.position[0]&&(c=e))},this),e&&(e=[].concat(e)),a=new t.series(this,e,s,n,o,l,c,i,t.aggregateMethod.sum,i.stacked),this.series.push(a),a},this.addTimeAxis=function(e,t,i,r){var a=this.addAxis(e,null,null,t);return a.tickFormat=r,a.dateParseFormat=i,a},this.assignClass=function(e,t){return this._assignedClasses[e]=t,this._assignedClasses[e]},this.assignColor=function(e,i,r,a){return this._assignedColors[e]=new t.color(i,r,a),this._assignedColors[e]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new t.color("#80B1D3"),new t.color("#FB8072"),new t.color("#FDB462"),new t.color("#B3DE69"),new t.color("#FFED6F"),new t.color("#BC80BD"),new t.color("#8DD3C7"),new t.color("#CCEBC5"),new t.color("#FFFFB3"),new t.color("#BEBADA"),new t.color("#FCCDE5"),new t.color("#D9D9D9")],this.draw=function(t,i){t=t||0;var r,a,s=null,n=null,o=!1,l=!1,c=this._xPixels(),d=this._yPixels(),u=this._widthPixels(),h=this._heightPixels();return(void 0===i||null===i||i===!1)&&this._getSeriesData(),this.axes.forEach(function(e){e._scale=null},this),this.axes.forEach(function(e){if(e._min=0,e._max=0,a=[],e._hasMeasure()){var t=!1;this.series.forEach(function(i){if(i._deepMatch(e)){var r=i._axisBounds(e.position);e._min>r.min&&(e._min=r.min),e._max<r.max&&(e._max=r.max),t=!0}},this),t||this._getAllData().forEach(function(t){e._min>t[e.measure]&&(e._min=t[e.measure]),e._max<t[e.measure]&&(e._max=t[e.measure])},this)}else e._hasTimeField()?(e._min=null,e._max=null,this.series.forEach(function(t){t._deepMatch(e)&&null!==t[e.position].timeField&&void 0!==t[e.position].timeField&&-1===a.indexOf(t[e.position].timeField)&&a.push(t[e.position].timeField)},this),e._getAxisData().forEach(function(t){a.forEach(function(i){var r=e._parseDate(t[i]);(null===e._min||r<e._min)&&(e._min=r),(null===e._max||r>e._max)&&(e._max=r)},this)},this)):e._hasCategories()&&(e._min=0,r=[],this.series.forEach(function(t){t._deepMatch(e)&&null!==t[e.position].categoryFields[0]&&void 0!==t[e.position].categoryFields[0]&&-1===a.indexOf(t[e.position].categoryFields[0])&&a.push(t[e.position].categoryFields[0])},this),e._getAxisData().forEach(function(e){a.forEach(function(t){-1===r.indexOf(e[t])&&r.push(e[t])},this)},this),e._max=r.length);null!==e._slaves&&void 0!==e._slaves&&e._slaves.length>0&&e._slaves.forEach(function(t){t._min=e._min,t._max=e._max},this),e._update(),null===s&&"x"===e.position?s=e:null===n&&"y"===e.position&&(n=e)},this),this.axes.forEach(function(i){var r=!1,a=null,p=0,v=null,m=!1,g=0,f={l:null,t:null,r:null,b:null},y=0,x=0,b="",_=this,w=function(e){var i;return i=null===a||0===t||r?e:_._handleTransition(e,t,_)},k=function(){var t=e.select(this).selectAll("text");return!i.measure&&i._max>0&&("x"===i.position?t.attr("x",u/i._max/2):"y"===i.position&&t.attr("y",-1*(h/i._max)/2)),i.categoryFields&&i.categoryFields.length>0&&(i!==s||null!==n.categoryFields&&0!==n.categoryFields.length||t.attr("y",d+h-n._scale(0)+9),i!==n||null!==s.categoryFields&&0!==s.categoryFields.length||t.attr("x",-1*(s._scale(0)-c)-9)),this},D=function(t){return function(){var i=e.select(this).attr("class")||"";return-1===i.indexOf(t)&&(i+=" "+t),i.trim()}};null===i.gridlineShapes?(i.showGridlines||null===i.showGridlines&&!i._hasCategories()&&(!o&&"x"===i.position||!l&&"y"===i.position))&&(i.gridlineShapes=this._group.append("g").attr("class","dimple-gridline"),"x"===i.position?o=!0:l=!0):"x"===i.position?o=!0:l=!0,null===i.shapes&&(i.shapes=this._group.append("g").attr("class","dimple-axis dimple-axis-"+i.position).each(function(){_.noFormats||e.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),r=!0),i===s&&null!==n?(a="translate(0, "+(null===n.categoryFields||0===n.categoryFields.length?n._scale(0):d+h)+")",v="translate(0, "+(i===s?d+h:d)+")",p=-h):i===n&&null!==s?(a="translate("+(null===s.categoryFields||0===s.categoryFields.length?s._scale(0):c)+", 0)",v="translate("+(i===n?c:c+u)+", 0)",p=-u):"x"===i.position?(v=a="translate(0, "+(i===s?d+h:d)+")",p=-h):"y"===i.position&&(v=a="translate("+(i===n?c:c+u)+", 0)",p=-u),null!==a&&null!==i._draw&&(i._hasTimeField()?w(i.shapes).call(i._draw.ticks(i._getTimePeriod(),i.timeInterval).tickFormat(i._getFormat())).attr("transform",a).each(k):i.useLog?w(i.shapes).call(i._draw.ticks(4,i._getFormat())).attr("transform",a).each(k):w(i.shapes).call(i._draw.tickFormat(i._getFormat())).attr("transform",a).each(k),null!==i.gridlineShapes&&w(i.gridlineShapes).call(i._draw.tickSize(p,0,0).tickFormat("")).attr("transform",v)),w(i.shapes.selectAll("text")).attr("class",D(_.customClassList.axisLabel)).call(function(){_.noFormats||this.style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),w(i.shapes.selectAll("path, line")).attr("class",D(_.customClassList.axisLine)).call(function(){_.noFormats||this.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")}),null!==i.gridlineShapes&&w(i.gridlineShapes.selectAll("line")).attr("class",D(_.customClassList.gridline)).call(function(){_.noFormats||this.style("fill","none").style("stroke","lightgray").style("opacity",.8)}),(null===i.measure||void 0===i.measure)&&(i.autoRotateLabel?i===s?(g=0,i.shapes.selectAll("text").each(function(){var e=this.getComputedTextLength();g=e>g?e:g}),g>u/i.shapes.selectAll("text")[0].length?(m=!0,i.shapes.selectAll("text").style("text-anchor","start").each(function(){var t=this.getBBox();e.select(this).attr("transform","rotate(90,"+t.x+","+(t.y+t.height/2)+") translate(-5, 0)")})):(m=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===i.position&&(g=0,i.shapes.selectAll("text").each(function(){var e=this.getComputedTextLength();g=e>g?e:g}),g>u/i.shapes.selectAll("text")[0].length?(m=!0,i.shapes.selectAll("text").style("text-anchor","end").each(function(){var t=this.getBBox();e.select(this).attr("transform","rotate(90,"+(t.x+t.width)+","+(t.y+t.height/2)+") translate(5, 0)")})):(m=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(m=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==i.titleShape&&void 0!==i.titleShape&&i.titleShape.remove(),i.shapes.selectAll("text").each(function(){var e=this.getBBox();(null===f.l||-9-e.width<f.l)&&(f.l=-9-e.width),(null===f.r||e.x+e.width>f.r)&&(f.r=e.x+e.width),m?((null===f.t||e.y+e.height-e.width<f.t)&&(f.t=e.y+e.height-e.width),(null===f.b||e.height+e.width>f.b)&&(f.b=e.height+e.width)):((null===f.t||e.y<f.t)&&(f.t=e.y),(null===f.b||9+e.height>f.b)&&(f.b=9+e.height))}),"x"===i.position?(x=i===s?d+h+f.b+5:d+f.t-10,y=c+u/2):"y"===i.position&&(y=i===n?c+f.l-10:c+u+f.r+20,x=d+h/2,b="rotate(270, "+y+", "+x+")"),i.hidden||"x"!==i.position&&"y"!==i.position||null===i.title||(i.titleShape=this._group.append("text").attr("class","dimple-axis dimple-title "+_.customClassList.axisTitle+" dimple-axis-"+i.position),i.titleShape.attr("x",y).attr("y",x).attr("text-anchor","middle").attr("transform",b).text(void 0!==i.title?i.title:null===i.categoryFields||void 0===i.categoryFields||0===i.categoryFields.length?i.measure:i.categoryFields.join("/")).each(function(){_.noFormats||e.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())}),i===s?i.titleShape.each(function(){e.select(this).attr("y",x+this.getBBox().height/1.65)}):i===n&&i.titleShape.each(function(){e.select(this).attr("x",y+this.getBBox().height/1.65)}))},this),this.series.forEach(function(e){e.plot.draw(this,e,t),this._registerEventHandlers(e)},this),this.legends.forEach(function(e){e._draw()},this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(e){return this._assignedClasses[e]||(this._assignedClasses[e]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[e]},this.getColor=function(e){return(null===this._assignedColors[e]||void 0===this._assignedColors[e])&&(this._assignedColors[e]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[e]},this.setBounds=function(e,i,r,a){return this.x=e,this.y=i,this.width=r,this.height=a,this._xPixels=function(){return t._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return t._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return t._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return t._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(e,i,r,a){return this.x=e,this.y=i,this.width=0,this.height=0,this._xPixels=function(){return t._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return t._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return t._parentWidth(this.svg.node())-this._xPixels()-t._parseXPosition(r,this.svg.node())},this._heightPixels=function(){return t._parentHeight(this.svg.node())-this._yPixels()-t._parseYPosition(a,this.svg.node())},this.draw(0,!0),this},this.setStoryboard=function(e,i){return this.storyboard=new t.storyboard(this,e),null!==i&&void 0!==i&&(this.storyboard.onTick=i),this.storyboard}},t.color=function(t,i,r){this.fill=t,this.stroke=null===i||void 0===i?e.rgb(t).darker(.5).toString():i,this.opacity=null===r||void 0===r?.8:r},t.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},t.legend=function(i,r,a,s,n,o,l){this.chart=i,this.series=l,this.x=r,this.y=a,this.width=s,this.height=n,this.horizontalAlign=o,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var i,r=this._getEntries(),a=0,s=0,n=0,o=0,l=15,c=9,d=5,u=this;this.shapes&&this.shapes.remove(),i=this.chart._group.selectAll(".dimple-dont-select-any").data(r).enter().append("g").attr("class",function(e){return"dimple-legend "+t._createClass(e.aggField)}).attr("opacity",1),i.append("text").attr("class",function(e){return"dimple-legend dimple-legend-text "+t._createClass(e.aggField)+" "+u.chart.customClassList.legendLabel}).text(function(e){return e.key}).call(function(){u.chart.noFormats||this.style("font-family",u.fontFamily).style("font-size",u._getFontSize()).style("shape-rendering","crispEdges")}).each(function(){var e=this.getBBox();e.width>a&&(a=e.width),e.height>s&&(s=e.height)}),i.append("rect").attr("class",function(e){return"dimple-legend dimple-legend-key "+t._createClass(e.aggField)}).attr("height",c).attr("width",l),s=(c>s?c:s)+u._getVerticalPadding(),a+=l+u._getHorizontalPadding(),i.each(function(i){n+a>u._widthPixels()&&(n=0,o+=s),o>u._heightPixels()?e.select(this).remove():(e.select(this).select("text").attr("x","left"===u.horizontalAlign?u._xPixels()+l+d+n:u._xPixels()+(u._widthPixels()-n-a)+l+d).attr("y",function(){return u._yPixels()+o+this.getBBox().height/1.65}).attr("width",u._widthPixels()).attr("height",u._heightPixels()),e.select(this).select("rect").attr("class",function(e){return"dimple-legend dimple-legend-key "+t._createClass(e.aggField)+" "+u.chart.customClassList.legendKey+" "+e.css}).attr("x","left"===u.horizontalAlign?u._xPixels()+n:u._xPixels()+(u._widthPixels()-n-a)).attr("y",u._yPixels()+o).attr("height",c).attr("width",l).call(function(){u.chart.noFormats||this.style("fill",i.fill).style("stroke",i.stroke).style("opacity",i.opacity).style("shape-rendering","crispEdges")}),n+=a)}),this.shapes=i},this._getEntries=function(){var e=[];return this.series&&this.series.forEach(function(t){var i=t._positionData;i.forEach(function(i){var r,a=-1,s=t.plot.grouped&&!t.x._hasCategories()&&!t.y._hasCategories()&&i.aggField.length<2?"All":i.aggField.slice(-1)[0];for(r=0;r<e.length;r+=1)if(e[r].key===s){a=r;break}-1===a&&t.chart._assignedColors[s]&&(e.push({key:s,fill:t.chart._assignedColors[s].fill,stroke:t.chart._assignedColors[s].stroke,opacity:t.chart._assignedColors[s].opacity,css:t.chart._assignedClasses[s],series:t,aggField:i.aggField}),a=e.length-1)})},this),e},this._getFontSize=function(){var e;return e=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){var e;return e=isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){var e;return e=isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return t._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return t._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return t._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return t._parseYPosition(this.y,this.chart.svg.node())}},t.series=function(e,t,i,r,a,s,n,o,l,c){this.chart=e,this.x=i,this.y=r,this.z=a,this.c=s,this.p=n,this.plot=o,this.categoryFields=t,this.aggregate=l,this.stacked=c,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(e){var t,i,r,a={min:0,max:0},s=null,n=null,o=[],l=0,c=this._positionData;return"x"===e?(s=this.x,n=this.y):"y"===e?(s=this.y,n=this.x):"z"===e?s=this.z:"p"===e?s=this.p:"c"===e&&(s=this.c),s.showPercent?c.forEach(function(e){e[s.position+"Bound"]<a.min&&(a.min=e[s.position+"Bound"]),e[s.position+"Bound"]>a.max&&(a.max=e[s.position+"Bound"])},this):null===n||null===n.categoryFields||0===n.categoryFields.length?c.forEach(function(e){!this._isStacked()||"x"!==s.position&&"y"!==s.position?(e[s.position+"Value"]<a.min&&(a.min=e[s.position+"Value"]),e[s.position+"Value"]>a.max&&(a.max=e[s.position+"Value"])):e[s.position+"Value"]<0?a.min=a.min+e[s.position+"Value"]:a.max=a.max+e[s.position+"Value"]},this):(t=s.position+"Value",i=n.position+"Field",r=[],c.forEach(function(e){var a=e[i].join("/"),s=r.indexOf(a);-1===s&&(r.push(a),s=r.length-1),void 0===o[s]&&(o[s]={min:0,max:0},s>=l&&(l=s+1)),this.stacked?e[t]<0?o[s].min=o[s].min+e[t]:o[s].max=o[s].max+e[t]:(e[t]<o[s].min&&(o[s].min=e[t]),e[t]>o[s].max&&(o[s].max=e[t]))},this),o.forEach(function(e){void 0!==e&&(e.min<a.min&&(a.min=e.min),e.max>a.max&&(a.max=e.max))},this)),a},this._deepMatch=function(e){var t=!1;return this[e.position]===e?t=!0:void 0!==e._slaves&&null!==e._slaves&&e._slaves.length>0&&e._slaves.forEach(function(e){t=t||this._deepMatch(e)},this),t},this._dropLineOrigin=function(){var e=0,t=0,i={x:null,y:null},r={x:null,y:null};return this.chart.axes.forEach(function(e){"x"===e.position&&null===r.x?e._hasTimeField()?r.x=this.chart._xPixels():r.x=e._origin:"y"===e.position&&null===r.y&&(e._hasTimeField()?r.y=this.chart._yPixels()+this.chart._heightPixels():r.y=e._origin)},this),this.chart.axes.forEach(function(a){"x"!==a.position||this.x.hidden?"y"!==a.position||this.y.hidden||(this._deepMatch(a)&&(0===t?i.x=r.x:1===t&&(i.x=this.chart._xPixels()+this.chart._widthPixels())),t+=1):(this._deepMatch(a)&&(0===e?i.y=r.y:1===e&&(i.y=this.chart._yPixels())),e+=1)},this),i},this._getTooltipFontSize=function(){var e;return e=this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(e,t){this._eventHandlers.push({event:e,handler:t})},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})},this.getTooltipText=function(e){var t=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach(function(i,r){null!==i&&void 0!==i&&null!==e.aggField[r]&&void 0!==e.aggField[r]&&t.push(i+(e.aggField[r]!==i?": "+e.aggField[r]:""))},this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(t,e),this.y&&this.y._hasCategories()&&this.y._getTooltipText(t,e),this.z&&this.z._hasCategories()&&this.z._getTooltipText(t,e),this.p._getTooltipText(t,e)):(this.x&&this.x._getTooltipText(t,e),this.y&&this.y._getTooltipText(t,e),this.z&&this.z._getTooltipText(t,e)),this.c&&this.c._getTooltipText(t,e),t.filter(function(e,i){return t.indexOf(e)===i})}},t.storyboard=function(e,t){null!==t&&void 0!==t&&(t=[].concat(t)),this.chart=e,this.categoryFields=t,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){if(!this.storyLabel){var e=this.chart,t=this,i=0;this.chart.axes.forEach(function(e){"x"===e.position&&(i+=1)},this),this.storyLabel=this.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",this.chart._xPixels()+.01*this.chart._widthPixels()).attr("y",this.chart._yPixels()+(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)*(i>1?1.25:-1)).call(function(){e.noFormats||this.style("font-family",t.fontFamily).style("font-size",t._getFontSize())})}this.storyLabel.text(this.categoryFields.join("\\")+": "+this.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach(function(e){var t=-1,i="";null!==this.categoryFields&&(this.categoryFields.forEach(function(t,r){r>0&&(i+="/"),i+=e[t]},this),t=this._categories.indexOf(i),-1===t&&(this._categories.push(i),t=this._categories.length-1))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){var e;return e=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(e){this._frame=e%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(e,t){this._orderRules.push({ordering:e,desc:t})},this.getFrameValue=function(){var e=null;return this._frame>=0&&this._getCategories().length>this._frame&&(e=this._getCategories()[this._frame]),e},this.goToFrame=function(e){if(this._getCategories().length>0){var t=this._getCategories().indexOf(e);this._goToFrameIndex(t)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(e){return function(){e._goToFrameIndex(e._frame+1),null!==e.onTick&&e.onTick(e.getFrameValue()),e._drawText(e.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},t.aggregateMethod.avg=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),(e.value*e.count+t.value*t.count)/(e.count+t.count)},t.aggregateMethod.count=function(e,t){return e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count+t.count},t.aggregateMethod.max=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value>t.value?e.value:t.value;
},t.aggregateMethod.min=function(e,t){return null===e.value?parseFloat(t.value):parseFloat(e.value)<parseFloat(t.value)?parseFloat(e.value):parseFloat(t.value)},t.aggregateMethod.sum=function(e,t){return e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value+t.value},t.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,r,a){var s,n,o,l,c,d,u,h,p,v,m,g,f,y,x,b,_,w,k,D,T,F,C=r._positionData,S=[],P=null,O="dimple-series-"+i.series.indexOf(r),A=r.x._hasCategories()||r.y._hasCategories()?0:1,M=!1,L={},B=[],q=[],$=function(){return function(i,r,a,s){e.select(r).style("opacity",1),t._showPointTooltip(i,r,a,s)}},V=function(i){return function(r,a,s,n){e.select(a).style("opacity",n.lineMarkers||i.data.length<2?t._helpers.opacity(r,s,n):0),t._removeTooltip(r,a,s,n)}},z=function(e,s){t._drawMarkers(e,i,r,a,O,M,$(e),V(e),s)},E=function(e,a){var s;return"step"===r.interpolation&&r[e]._hasCategories()?(s=t._helpers[e](a,i,r)+("y"===e?t._helpers.height(a,i,r):0),r[e].categoryFields.length<2&&(s+=("y"===e?1:-1)*t._helpers[e+"Gap"](i,r))):s=t._helpers["c"+e](a,i,r),parseFloat(s)},R=function(t,i){return e.svg.line().x(function(e){return r.x._hasCategories()||!i?e.x:r.x[i]}).y(function(e){return r.y._hasCategories()||!i?e.y:r.y[i]}).interpolate(t)},I=function(e,t){return parseFloat(e)-parseFloat(t)},Y=function(e,t){return parseFloat(e.x)-parseFloat(t.x)},G=function(e,t,i){var r,a,s=t[t.length-1],n=9999,o=s;for(r=0;r<e.length;r+=1)(e[r].x!==s.x||e[r].y!==s.y)&&(a=180-Math.atan2(e[r].x-s.x,e[r].y-s.y)*(180/Math.PI),a>i&&n>a&&(o=e[r],n=a));return t.push(o),n};for(s="step"===r.interpolation?"step-after":r.interpolation,v=t._getSeriesOrder(r.data||i.data,r),r.c&&(r.x._hasCategories()&&r.y._hasMeasure()||r.y._hasCategories()&&r.x._hasMeasure())&&(M=!0),r.x._hasCategories()?(T="x",F="y"):r.y._hasCategories()&&(T="y",F="x"),n=0;n<C.length;n+=1){for(c=[],u=-1,l=A;l<C[n].aggField.length;l+=1)c.push(C[n].aggField[l]);for(d=t._createClass(c),l=0;l<S.length;l+=1)if(S[l].keyString===d){u=l;break}-1===u&&(u=S.length,S.push({key:c,keyString:d,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:T&&C[n][T+"Field"]&&C[n][T+"Field"].length>=2?C[n][T+"Field"][0]:"All"})),S[u].data.push(C[n])}for(v&&S.sort(function(e,i){return t._arrayIndexCompare(v,e.key,i.key)}),n=0;n<S.length;n+=1){for(S[n].data.sort(t._getSeriesSortPredicate(i,r,v)),o=0;o<S[n].data.length;o+=1)S[n].points.push({x:E("x",S[n].data[o]),y:E("y",S[n].data[o])}),T&&(L[S[n].group]||(L[S[n].group]={}),L[S[n].group][S[n].points[S[n].points.length-1][T]]=r[F]._origin);m=S[n].points,"step"===r.interpolation&&m.length>1&&T&&(r.x._hasCategories()?(m.push({x:2*m[m.length-1].x-m[m.length-2].x,y:m[m.length-1].y}),L[S[n].group][m[m.length-1][T]]=r[F]._origin):r.y._hasCategories()&&(m=[{x:m[0].x,y:2*m[0].y-m[1].y}].concat(m),L[S[n].group][m[0][T]]=r[F]._origin,S[n].points=m))}for(y in L)if(L.hasOwnProperty(y)){B[y]=[];for(x in L[y])L[y].hasOwnProperty(x)&&B[y].push(parseFloat(x));B[y].sort(I)}for(n=0;n<S.length;n+=1){if(m=S[n].points,b=S[n].group,g=[],q=[],M&&t._addGradient(S[n].key,"fill-area-gradient-"+S[n].keyString,r.x._hasCategories()?r.x:r.y,C,i,a,"fill"),B[b]&&B[b].length>0)for(o=0,l=0;o<B[b].length;o+=1)B[b][o]>=m[0][T]&&B[b][o]<=m[m.length-1][T]&&(f={},f[T]=B[b][o],f[F]=L[b][B[b][o]],g.push(f),m[l][T]>B[b][o]?q.push(f):(q.push(m[l]),L[S[n].group][B[b][o]]=m[l][F],l+=1));else if(r._orderRules&&r._orderRules.length>0)q=m.concat(m[0]);else{m=m.sort(Y),q.push(m[0]),D=0;do D=G(m,q,D);while(q.length<=m.length&&(q[0].x!==q[q.length-1].x||q[0].y!==q[q.length-1].y))}g=g.reverse(),_=R(s,"_previousOrigin")(q),w=R("step-after"===s?"step-before":"step-before"===s?"step-after":s,"_previousOrigin")(g),k=R("linear","_previousOrigin")(q),S[n].entry=_+(w&&w.length>0?"L"+w.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,k.indexOf("L")):0),_=R(s)(q),w=R("step-after"===s?"step-before":"step-before"===s?"step-after":s)(g),k=R("linear")(q),S[n].update=_+(w&&w.length>0?"L"+w.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,k.indexOf("L")):0),_=R(s,"_origin")(q),w=R("step-after"===s?"step-before":"step-before"===s?"step-after":s,"_origin")(g),k=R("linear","_origin")(q),S[n].exit=_+(w&&w.length>0?"L"+w.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,k.indexOf("L")):0),S[n].color=i.getColor(S[n].key.length>0?S[n].key[S[n].key.length-1]:"All"),S[n].css=i.getClass(S[n].key.length>0?S[n].key[S[n].key.length-1]:"All")}null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),P=null===r.shapes||void 0===r.shapes?i._group.selectAll("."+O).data(S):r.shapes.data(S,function(e){return e.key}),P.enter().append("path").attr("id",function(e){return t._createClass([e.key])}).attr("class",function(e){return O+" dimple-line "+e.keyString+" "+i.customClassList.areaSeries+" "+e.css}).attr("d",function(e){return e.entry}).call(function(){i.noFormats||this.attr("opacity",function(e){return M?1:e.color.opacity}).style("fill",function(e){return M?"url(#"+t._createClass(["fill-area-gradient-"+e.keyString])+")":e.color.fill}).style("stroke",function(e){return M?"url(#"+t._createClass(["stroke-area-gradient-"+e.keyString])+")":e.color.stroke}).style("stroke-width",r.lineWeight)}).each(function(e){e.markerData=e.data,z(e,this)}),h=i._handleTransition(P,a,i).attr("d",function(e){return e.update}).each(function(e){e.markerData=e.data,z(e,this)}),p=i._handleTransition(P.exit(),a,i).attr("d",function(e){return e.exit}).each(function(e){e.markerData=[],z(e,this)}),t._postDrawHandling(r,h,p,a),r.shapes=P}},t.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(e,i,r){var a,s,n=i._positionData,o=null,l=["dimple-series-"+e.series.indexOf(i),"dimple-bar"],c=!i._isStacked()&&i.x._hasMeasure(),d=!i._isStacked()&&i.y._hasMeasure(),u="none";i.x._hasCategories()&&i.y._hasCategories()?u="both":i.x._hasCategories()?u="x":i.y._hasCategories()&&(u="y"),null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),o=null===i.shapes||void 0===i.shapes?e._group.selectAll("."+l.join(".")).data(n):i.shapes.data(n,function(e){return e.key}),o.enter().append("rect").attr("id",function(e){return t._createClass([e.key])}).attr("class",function(i){var r=[];return r=r.concat(i.aggField),r=r.concat(i.xField),r=r.concat(i.yField),l.join(" ")+" "+t._createClass(r)+" "+e.customClassList.barSeries+" "+t._helpers.css(i,e)}).attr("x",function(r){var a=i.x._previousOrigin;return"x"===u?a=t._helpers.x(r,e,i):"both"===u&&(a=t._helpers.cx(r,e,i)),a}).attr("y",function(r){var a=i.y._previousOrigin;return"y"===u?a=t._helpers.y(r,e,i):"both"===u&&(a=t._helpers.cy(r,e,i)),a}).attr("width",function(r){return"x"===u?t._helpers.width(r,e,i):0}).attr("height",function(r){return"y"===u?t._helpers.height(r,e,i):0}).on("mouseover",function(r){t._showBarTooltip(r,this,e,i)}).on("mouseleave",function(r){t._removeTooltip(r,this,e,i)}).call(function(){e.noFormats||this.attr("opacity",function(r){return t._helpers.opacity(r,e,i)}).style("fill",function(r){return t._helpers.fill(r,e,i)}).style("stroke",function(r){return t._helpers.stroke(r,e,i)})}),a=e._handleTransition(o,r,e,i).attr("x",function(r){return c?t._helpers.cx(r,e,i)-i.x.floatingBarWidth/2:t._helpers.x(r,e,i)}).attr("y",function(r){return d?t._helpers.cy(r,e,i)-i.y.floatingBarWidth/2:t._helpers.y(r,e,i)}).attr("width",function(r){return c?i.x.floatingBarWidth:t._helpers.width(r,e,i)}).attr("height",function(r){return d?i.y.floatingBarWidth:t._helpers.height(r,e,i)}).call(function(){e.noFormats||this.attr("fill",function(r){return t._helpers.fill(r,e,i)}).attr("stroke",function(r){return t._helpers.stroke(r,e,i)})}),s=e._handleTransition(o.exit(),r,e,i).attr("x",function(r){var a=i.x._origin;return"x"===u?a=t._helpers.x(r,e,i):"both"===u&&(a=t._helpers.cx(r,e,i)),a}).attr("y",function(r){var a=i.y._origin;return"y"===u?a=t._helpers.y(r,e,i):"both"===u&&(a=t._helpers.cy(r,e,i)),a}).attr("width",function(r){return"x"===u?t._helpers.width(r,e,i):0}).attr("height",function(r){return"y"===u?t._helpers.height(r,e,i):0}),t._postDrawHandling(i,a,s,r),i.shapes=o}},t.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(e,i,r){var a,s,n=i._positionData,o=null,l=["dimple-series-"+e.series.indexOf(i),"dimple-bubble"];null!==e._tooltipGroup&&void 0!==e._tooltipGroup&&e._tooltipGroup.remove(),o=null===i.shapes||void 0===i.shapes?e._group.selectAll("."+l.join(".")).data(n):i.shapes.data(n,function(e){return e.key}),o.enter().append("circle").attr("id",function(e){return t._createClass([e.key])}).attr("class",function(i){var r=[];return r=r.concat(i.aggField),r=r.concat(i.xField),r=r.concat(i.yField),r=r.concat(i.zField),l.join(" ")+" "+t._createClass(r)+" "+e.customClassList.bubbleSeries+" "+t._helpers.css(i,e)}).attr("cx",function(r){return i.x._hasCategories()?t._helpers.cx(r,e,i):i.x._previousOrigin}).attr("cy",function(r){return i.y._hasCategories()?t._helpers.cy(r,e,i):i.y._previousOrigin}).attr("r",0).on("mouseover",function(r){t._showPointTooltip(r,this,e,i)}).on("mouseleave",function(r){t._removeTooltip(r,this,e,i)}).call(function(){e.noFormats||this.attr("opacity",function(r){return t._helpers.opacity(r,e,i)}).style("fill",function(r){return t._helpers.fill(r,e,i)}).style("stroke",function(r){return t._helpers.stroke(r,e,i)})}),a=e._handleTransition(o,r,e,i).attr("cx",function(r){return t._helpers.cx(r,e,i)}).attr("cy",function(r){return t._helpers.cy(r,e,i)}).attr("r",function(r){return t._helpers.r(r,e,i)}).call(function(){e.noFormats||this.attr("fill",function(r){return t._helpers.fill(r,e,i)}).attr("stroke",function(r){return t._helpers.stroke(r,e,i)})}),s=e._handleTransition(o.exit(),r,e,i).attr("r",0).attr("cx",function(r){return i.x._hasCategories()?t._helpers.cx(r,e,i):i.x._origin}).attr("cy",function(r){return i.y._hasCategories()?t._helpers.cy(r,e,i):i.y._origin}),t._postDrawHandling(i,a,s,r),i.shapes=o}},t.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,r,a){var s,n,o,l,c,d,u,h,p,v,m=r._positionData,g=[],f=null,y="dimple-series-"+i.series.indexOf(r),x=r.x._hasCategories()||r.y._hasCategories()?0:1,b=!1,_=function(){return function(i,r,a,s){e.select(r).style("opacity",1),t._showPointTooltip(i,r,a,s)}},w=function(i){return function(r,a,s,n){e.select(a).style("opacity",n.lineMarkers||i.data.length<2?t._helpers.opacity(r,s,n):0),t._removeTooltip(r,a,s,n)}},k=function(e,s){t._drawMarkers(e,i,r,a,y,b,_(e),w(e),s)},D=function(e,a){var s;return"step"===r.interpolation&&r[e]._hasCategories()?(r.barGap=0,r.clusterBarGap=0,s=t._helpers[e](a,i,r)+("y"===e?t._helpers.height(a,i,r):0)):s=t._helpers["c"+e](a,i,r),parseFloat(s.toFixed(1))},T=function(t,i){return e.svg.line().x(function(e){return r.x._hasCategories()||!i?e.x:r.x[i]}).y(function(e){return r.y._hasCategories()||!i?e.y:r.y[i]}).interpolate(t)};for(s="step"===r.interpolation?"step-after":r.interpolation,v=t._getSeriesOrder(r.data||i.data,r),r.c&&(r.x._hasCategories()&&r.y._hasMeasure()||r.y._hasCategories()&&r.x._hasMeasure())&&(b=!0),n=0;n<m.length;n+=1){for(c=[],u=-1,l=x;l<m[n].aggField.length;l+=1)c.push(m[n].aggField[l]);for(d=t._createClass(c),l=0;l<g.length;l+=1)if(g[l].keyString===d){u=l;break}-1===u&&(u=g.length,g.push({key:c,keyString:d,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),g[u].data.push(m[n])}for(v&&g.sort(function(e,i){return t._arrayIndexCompare(v,e.key,i.key)}),n=0;n<g.length;n+=1){for(g[n].data.sort(t._getSeriesSortPredicate(i,r,v)),b&&t._addGradient(g[n].key,"fill-line-gradient-"+g[n].keyString,r.x._hasCategories()?r.x:r.y,m,i,a,"fill"),o=0;o<g[n].data.length;o+=1)g[n].points.push({x:D("x",g[n].data[o]),y:D("y",g[n].data[o])});"step"===r.interpolation&&g[n].points.length>1&&(r.x._hasCategories()?g[n].points.push({x:2*g[n].points[g[n].points.length-1].x-g[n].points[g[n].points.length-2].x,y:g[n].points[g[n].points.length-1].y}):r.y._hasCategories()&&(g[n].points=[{x:g[n].points[0].x,y:2*g[n].points[0].y-g[n].points[1].y}].concat(g[n].points))),g[n].entry=T(s,"_previousOrigin")(g[n].points),g[n].update=T(s)(g[n].points),g[n].exit=T(s,"_origin")(g[n].points),g[n].color=i.getColor(g[n].key.length>0?g[n].key[g[n].key.length-1]:"All"),g[n].css=i.getClass(g[n].key.length>0?g[n].key[g[n].key.length-1]:"All")}null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),f=null===r.shapes||void 0===r.shapes?i._group.selectAll("."+y).data(g):r.shapes.data(g,function(e){return e.key}),f.enter().append("path").attr("id",function(e){return t._createClass([e.key])}).attr("class",function(e){return y+" dimple-line "+e.keyString+" "+i.customClassList.lineSeries+" "+e.css}).attr("d",function(e){return e.entry}).call(function(){i.noFormats||this.attr("opacity",function(e){return b?1:e.color.opacity}).style("fill","none").style("stroke",function(e){return b?"url(#"+t._createClass(["fill-line-gradient-"+e.keyString])+")":e.color.stroke}).style("stroke-width",r.lineWeight)}).each(function(e){e.markerData=e.data,k(e,this)}),h=i._handleTransition(f,a,i).attr("d",function(e){return e.update}).each(function(e){e.markerData=e.data,k(e,this)}),p=i._handleTransition(f.exit(),a,i).attr("d",function(e){return e.exit}).each(function(e){e.markerData=[],k(e,this)}),t._postDrawHandling(r,h,p,a),r.shapes=f}},t.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(i,r,a){var s,n,o=r._positionData,l=null,c=["dimple-series-"+i.series.indexOf(r),"dimple-pie"],d=function(e){var a;return a=r.x&&r.y?t._helpers.r(e,i,r):i._widthPixels()<i._heightPixels()?i._widthPixels()/2:i._heightPixels()/2},u=function(e){var i=d(e);return r.outerRadius&&(i=t._parsePosition(r.outerRadius,i)),Math.max(i,0)},h=function(e){var i=0;return r.innerRadius&&(i=t._parsePosition(r.innerRadius,d(e))),Math.max(i,0)},p=function(t){var i;return(i=e.svg.arc().innerRadius(h(t)).outerRadius(u(t)))(t)},v=function(t){t.innerRadius=h(t),t.outerRadius=u(t);var i,r=e.interpolate(this._current,t);return i=e.svg.arc().innerRadius(function(e){return e.innerRadius}).outerRadius(function(e){return e.outerRadius}),this._current=r(0),function(e){return i(r(e))}},m=function(e){return function(a){var s,n;return r.x&&r.y?(s=!e||r.x._hasCategories()?t._helpers.cx(a,i,r):r.x._previousOrigin,n=!e||r.y._hasCategories()?t._helpers.cy(a,i,r):r.y._previousOrigin):(s=i._xPixels()+i._widthPixels()/2,n=i._yPixels()+i._heightPixels()/2),"translate("+s+","+n+")"}};null!==i._tooltipGroup&&void 0!==i._tooltipGroup&&i._tooltipGroup.remove(),l=null===r.shapes||void 0===r.shapes?i._group.selectAll("."+c.join(".")).data(o):r.shapes.data(o,function(e){return e.key}),l.enter().append("path").attr("id",function(e){return t._createClass([e.key])}).attr("class",function(e){var r=[];return r=r.concat(e.aggField),r=r.concat(e.pField),c.join(" ")+" "+t._createClass(r)+" "+i.customClassList.pieSeries+" "+t._helpers.css(e,i)}).attr("d",p).on("mouseover",function(e){t._showBarTooltip(e,this,i,r)}).on("mouseleave",function(e){t._removeTooltip(e,this,i,r)}).call(function(){i.noFormats||this.attr("opacity",function(e){return t._helpers.opacity(e,i,r)}).style("fill",function(e){return t._helpers.fill(e,i,r)}).style("stroke",function(e){return t._helpers.stroke(e,i,r)})}).attr("transform",m(!0)).each(function(e){this._current=e,e.innerRadius=h(e),e.outerRadius=u(e)}),s=i._handleTransition(l,a,i,r).call(function(){a&&a>0?this.attrTween("d",v):this.attr("d",p),i.noFormats||this.attr("fill",function(e){return t._helpers.fill(e,i,r)}).attr("stroke",function(e){return t._helpers.stroke(e,i,r)})}).attr("transform",m(!1)),n=i._handleTransition(l.exit(),a,i,r).attr("transform",m(!0)).attr("d",p),t._postDrawHandling(r,s,n,a),r.shapes=l}},t._addGradient=function(e,i,r,a,s,n,o){var l=[].concat(e),c=s.svg.select("#"+t._createClass([i])),d=[],u=r.position+"Field",h=!0,p=[];a.forEach(function(e){-1===d.indexOf(e[u])&&e.aggField.join("_")===l.join("_")&&d.push(e[u])},this),d=d.sort(function(e,t){return r._scale(e)-r._scale(t)}),null===c.node()&&(h=!1,c=s.svg.append("defs").append("linearGradient").attr("id",t._createClass([i])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===r.position?r._scale(d[0])+s._widthPixels()/d.length/2:0).attr("y1","y"===r.position?r._scale(d[0])-s._heightPixels()/d.length/2:0).attr("x2","x"===r.position?r._scale(d[d.length-1])+s._widthPixels()/d.length/2:0).attr("y2","y"===r.position?r._scale(d[d.length-1])-s._heightPixels()/d.length/2:0)),d.forEach(function(e,t){var i={},r=0;for(r=0;r<a.length;r+=1)if(a[r].aggField.join("_")===l.join("_")&&a[r][u].join("_")===e.join("_")){i=a[r];break}p.push({offset:Math.round(t/(d.length-1)*100)+"%",color:i[o]})},this),h?s._handleTransition(c.selectAll("stop").data(p),n,s).attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color}):c.selectAll("stop").data(p).enter().append("stop").attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color})},t._arrayIndexCompare=function(e,t,i){var r,a,s,n,o,l;for(a=0;a<e.length;a+=1){for(n=!0,o=!0,l=[].concat(e[a]),s=0;s<t.length;s+=1)n=n&&t[s]===l[s];for(s=0;s<i.length;s+=1)o=o&&i[s]===l[s];if(n&&o){r=0;break}if(n){r=-1;break}if(o){r=1;break}}return r},t._createClass=function(e){var t,i,r=[];if(i=function(e){var t=e.charCodeAt(0),i="-";return t>=65&&90>=t&&(i=e.toLowerCase()),i},e.length>0)for(t=0;t<e.length;t+=1)e[t]&&r.push("dimple-"+e[t].toString().replace(/[^a-z0-9]/g,i));else r=["dimple-all"];return r.join(" ")},t._drawMarkerBacks=function(i,r,a,s,n,o){var l,c,d,u=["dimple-marker-back",n,i.keyString];a.lineMarkers&&(l=null===a._markerBacks||void 0===a._markerBacks||void 0===a._markerBacks[i.keyString]?r._group.selectAll("."+u.join(".")).data(i.markerData):a._markerBacks[i.keyString].data(i.markerData,function(e){return e.key}),d=o.nextSibling&&o.nextSibling.id?l.enter().insert("circle","#"+o.nextSibling.id):l.enter().append("circle"),d.attr("id",function(e){return t._createClass([e.key+" Marker Back"])}).attr("class",function(e){var i=[];return a.x._hasCategories()&&(i=i.concat(e.xField)),a.y._hasCategories()&&(i=i.concat(e.yField)),t._createClass(i)+" "+u.join(" ")}).attr("cx",function(e){return a.x._hasCategories()?t._helpers.cx(e,r,a):a.x._previousOrigin}).attr("cy",function(e){return a.y._hasCategories()?t._helpers.cy(e,r,a):a.y._previousOrigin}).attr("r",0).attr("fill","white").attr("stroke","none"),r._handleTransition(l,s,r).attr("cx",function(e){return t._helpers.cx(e,r,a)}).attr("cy",function(e){return t._helpers.cy(e,r,a)}).attr("r",2+a.lineWeight),c=r._handleTransition(l.exit(),s,r).attr("cx",function(e){return a.x._hasCategories()?t._helpers.cx(e,r,a):a.x._origin}).attr("cy",function(e){return a.y._hasCategories()?t._helpers.cy(e,r,a):a.y._origin}).attr("r",0),0===s?c.remove():c.each("end",function(){e.select(this).remove()}),(void 0===a._markerBacks||null===a._markerBacks)&&(a._markerBacks={}),a._markerBacks[i.keyString]=l)},t._drawMarkers=function(i,r,a,s,n,o,l,c,d){var u,h,p,v=["dimple-marker",n,i.keyString];u=null===a._markers||void 0===a._markers||void 0===a._markers[i.keyString]?r._group.selectAll("."+v.join(".")).data(i.markerData):a._markers[i.keyString].data(i.markerData,function(e){return e.key}),p=d.nextSibling&&d.nextSibling.id?u.enter().insert("circle","#"+d.nextSibling.id):u.enter().append("circle"),p.attr("id",function(e){return t._createClass([e.key+" Marker"])}).attr("class",function(e){var i=[],s=r.getClass(e.aggField.length>0?e.aggField[e.aggField.length-1]:"All");return a.x._hasCategories()&&(i=i.concat(e.xField)),a.y._hasCategories()&&(i=i.concat(e.yField)),t._createClass(i)+" "+v.join(" ")+" "+r.customClassList.lineMarker+" "+s}).on("mouseover",function(e){l(e,this,r,a)}).on("mouseleave",function(e){c(e,this,r,a)}).attr("cx",function(e){return a.x._hasCategories()?t._helpers.cx(e,r,a):a.x._previousOrigin}).attr("cy",function(e){return a.y._hasCategories()?t._helpers.cy(e,r,a):a.y._previousOrigin}).attr("r",0).attr("opacity",a.lineMarkers||i.data.length<2?i.color.opacity:0).call(function(){r.noFormats||this.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(e){return o?t._helpers.fill(e,r,a):i.color.stroke})}),r._handleTransition(u,s,r).attr("cx",function(e){return t._helpers.cx(e,r,a)}).attr("cy",function(e){return t._helpers.cy(e,r,a)}).attr("r",2+a.lineWeight).attr("opacity",a.lineMarkers||i.data.length<2?i.color.opacity:0).call(function(){r.noFormats||this.attr("fill","white").style("stroke-width",a.lineWeight).attr("stroke",function(e){return o?t._helpers.fill(e,r,a):i.color.stroke})}),h=r._handleTransition(u.exit(),s,r).attr("cx",function(e){return a.x._hasCategories()?t._helpers.cx(e,r,a):a.x._origin}).attr("cy",function(e){return a.y._hasCategories()?t._helpers.cy(e,r,a):a.y._origin}).attr("r",0),0===s?h.remove():h.each("end",function(){e.select(this).remove()}),(void 0===a._markers||null===a._markers)&&(a._markers={}),a._markers[i.keyString]=u,t._drawMarkerBacks(i,r,a,s,n,d)},t._getOrderedList=function(e,i,r){var a,s=[],n=[],o=[].concat(i),l=[].concat(i),c=[];return null!==r&&void 0!==r&&(c=c.concat(r)),c=c.concat({ordering:o,desc:!1}),c.forEach(function(t){var i,r=[],a=[];if("function"==typeof t.ordering){if(e&&e.length>0)for(i in e[0])e[0].hasOwnProperty(i)&&-1===l.indexOf(i)&&l.push(i)}else if(t.ordering instanceof Array){for(i=0;i<t.ordering.length;i+=1)e&&e.length>0&&e[0].hasOwnProperty(t.ordering[i])&&a.push(t.ordering[i]),r.push(t.ordering[i]);a.length>r.length/2?l.concat(a):t.values=r}else l.push(t.ordering)},this),a=t._rollUp(e,o,l),c.length>=1&&(c.forEach(function(e){var t=null===e.desc||void 0===e.desc?!1:e.desc,i=e.ordering,r=[],a=function(e){var t,i=0;for(t=0;t<e.length;t+=1){if(isNaN(e[t])){i=void 0;break}i+=parseFloat(e[t])}return i},n=function(e,t){var i=0,r=a(e),s=a(t);return isNaN(r)||isNaN(s)?isNaN(Date.parse(e[0]))||isNaN(Date.parse(t[0]))?e[0]<t[0]?i=-1:e[0]>t[0]&&(i=1):i=Date.parse(e[0])-Date.parse(t[0]):i=parseFloat(r)-parseFloat(s),i};"function"==typeof i?s.push(function(e,r){return(t?-1:1)*i(e,r)}):e.values&&e.values.length>0?(e.values.forEach(function(e){r.push([].concat(e).join("|"))},this),s.push(function(e,i){var a,s,n,l="",c="";for(n=0;n<o.length;n+=1)n>0&&(l+="|",c+="|"),l+=e[o[n]],c+=i[o[n]];return a=r.indexOf(l),s=r.indexOf(c),a=0>a?t?-1:r.length:a,s=0>s?t?-1:r.length:s,(t?-1:1)*(a-s)})):[].concat(e.ordering).forEach(function(e){s.push(function(i,r){var a=0;return void 0!==i[e]&&void 0!==r[e]&&(a=n([].concat(i[e]),[].concat(r[e]))),(t?-1:1)*a})})}),a.sort(function(e,t){for(var i=0,r=0;i<s.length&&0===r;)r=s[i](e,t),i+=1;return r}),a.forEach(function(e){var t,i=[];if(1===o.length)n.push(e[o[0]]);else{for(t=0;t<o.length;t+=1)i.push(e[o[t]]);n.push(i)}},this)),n},t._getSeriesOrder=function(e,i){var r=[].concat(i._orderRules),a=i.categoryFields,s=[];return null!==a&&void 0!==a&&a.length>0&&(null!==i.c&&void 0!==i.c&&i.c._hasMeasure()&&r.push({ordering:i.c.measure,desc:!0}),i.x._hasMeasure()&&r.push({ordering:i.x.measure,desc:!0}),i.y._hasMeasure()&&r.push({ordering:i.y.measure,desc:!0}),s=t._getOrderedList(e,a,r)),s},t._getSeriesSortPredicate=function(e,i,r){return function(a,s){var n=0;return i.x._hasCategories()&&(n=t._helpers.cx(a,e,i)-t._helpers.cx(s,e,i)),0===n&&i.y._hasCategories()&&(n=t._helpers.cy(a,e,i)-t._helpers.cy(s,e,i)),0===n&&r&&(n=t._arrayIndexCompare(r,a.aggField,s.aggField)),n}},t._helpers={cx:function(e,i,r){var a=0;return a=null!==r.x.measure&&void 0!==r.x.measure?r.x._scale(e.cx):r.x._hasCategories()&&r.x.categoryFields.length>=2?r.x._scale(e.cx)+t._helpers.xGap(i,r)+(e.xOffset+.5)*(i._widthPixels()/r.x._max-2*t._helpers.xGap(i,r))*e.width:r.x._scale(e.cx)+i._widthPixels()/r.x._max/2},cy:function(e,i,r){var a=0;return a=null!==r.y.measure&&void 0!==r.y.measure?r.y._scale(e.cy):null!==r.y.categoryFields&&void 0!==r.y.categoryFields&&r.y.categoryFields.length>=2?r.y._scale(e.cy)-i._heightPixels()/r.y._max+t._helpers.yGap(i,r)+(e.yOffset+.5)*(i._heightPixels()/r.y._max-2*t._helpers.yGap(i,r))*e.height:r.y._scale(e.cy)-i._heightPixels()/r.y._max/2},r:function(e,t,i){var r=0,a=1;return null===i.z||void 0===i.z?r=i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&i.radius>1&&(a=i.radius/i.z._scale(i.z._max)),r=i.z._hasMeasure()?i.z._scale(e.r)*a:i.z._scale(t._heightPixels()/100)*a),r},xGap:function(e,t){var i=0;return(null===t.x.measure||void 0===t.x.measure)&&t.barGap>0&&(i=e._widthPixels()/t.x._max*(t.barGap>.99?.99:t.barGap)/2),i},xClusterGap:function(e,i,r){var a=0;return null!==r.x.categoryFields&&void 0!==r.x.categoryFields&&r.x.categoryFields.length>=2&&r.clusterBarGap>0&&!r.x._hasMeasure()&&(a=e.width*(i._widthPixels()/r.x._max-2*t._helpers.xGap(i,r))*(r.clusterBarGap>.99?.99:r.clusterBarGap)/2),a},yGap:function(e,t){var i=0;return(null===t.y.measure||void 0===t.y.measure)&&t.barGap>0&&(i=e._heightPixels()/t.y._max*(t.barGap>.99?.99:t.barGap)/2),i},yClusterGap:function(e,i,r){var a=0;return null!==r.y.categoryFields&&void 0!==r.y.categoryFields&&r.y.categoryFields.length>=2&&r.clusterBarGap>0&&!r.y._hasMeasure()&&(a=e.height*(i._heightPixels()/r.y._max-2*t._helpers.yGap(i,r))*(r.clusterBarGap>.99?.99:r.clusterBarGap)/2),a},x:function(e,i,r){var a=0;return a=r.x._hasTimeField()?r.x._scale(e.x)-t._helpers.width(e,i,r)/2:null!==r.x.measure&&void 0!==r.x.measure?r.x._scale(e.x):r.x._scale(e.x)+t._helpers.xGap(i,r)+e.xOffset*(t._helpers.width(e,i,r)+2*t._helpers.xClusterGap(e,i,r))+t._helpers.xClusterGap(e,i,r)},y:function(e,i,r){var a=0;return a=r.y._hasTimeField()?r.y._scale(e.y)-t._helpers.height(e,i,r)/2:null!==r.y.measure&&void 0!==r.y.measure?r.y._scale(e.y):r.y._scale(e.y)-i._heightPixels()/r.y._max+t._helpers.yGap(i,r)+e.yOffset*(t._helpers.height(e,i,r)+2*t._helpers.yClusterGap(e,i,r))+t._helpers.yClusterGap(e,i,r)},width:function(e,i,r){var a=0;return a=null!==r.x.measure&&void 0!==r.x.measure?Math.abs(r.x._scale(e.x<0?e.x-e.width:e.x+e.width)-r.x._scale(e.x)):r.x._hasTimeField()?r.x.floatingBarWidth:e.width*(i._widthPixels()/r.x._max-2*t._helpers.xGap(i,r))-2*t._helpers.xClusterGap(e,i,r)},height:function(e,i,r){var a=0;return a=r.y._hasTimeField()?r.y.floatingBarWidth:null!==r.y.measure&&void 0!==r.y.measure?Math.abs(r.y._scale(e.y)-r.y._scale(e.y<=0?e.y+e.height:e.y-e.height)):e.height*(i._heightPixels()/r.y._max-2*t._helpers.yGap(i,r))-2*t._helpers.yClusterGap(e,i,r)},opacity:function(e,t,i){var r=0;return r=null!==i.c&&void 0!==i.c?e.opacity:t.getColor(e.aggField.slice(-1)[0]).opacity},fill:function(e,t,i){var r=0;return r=null!==i.c&&void 0!==i.c?e.fill:t.getColor(e.aggField.slice(-1)[0]).fill},stroke:function(e,t,i){var r=0;return r=null!==i.c&&void 0!==i.c?e.stroke:t.getColor(e.aggField.slice(-1)[0]).stroke},css:function(e,t){return t.getClass(e.aggField.slice(-1)[0])}},t._parentHeight=function(e){var i=e.offsetHeight;return(0>=i||null===i||void 0===i)&&(i=e.clientHeight),(0>=i||null===i||void 0===i)&&(i=null===e.parentNode||void 0===e.parentNode?0:t._parentHeight(e.parentNode)),i},t._parentWidth=function(e){var i=e.offsetWidth;return(!i||0>i)&&(i=e.clientWidth),(!i||0>i)&&(i=e.parentNode?t._parentWidth(e.parentNode):0),i},t._parsePosition=function(e,t){var i,r=0;return e&&(i=e.toString().split(","),i.forEach(function(i){i&&(isNaN(i)?"%"===i.slice(-1)?r+=t*(parseFloat(i.slice(0,i.length-1))/100):"px"===i.slice(-2)?r+=parseFloat(i.slice(0,i.length-2)):r=e:r+=parseFloat(i))},this)),0>r&&(r=t+r),r},t._parseXPosition=function(e,i){return t._parsePosition(e,t._parentWidth(i))},t._parseYPosition=function(e,i){return t._parsePosition(e,t._parentHeight(i))},t._postDrawHandling=function(t,i,r,a){0===a?(i.each(function(e,i){null!==t.afterDraw&&void 0!==t.afterDraw&&t.afterDraw(this,e,i)}),r.remove()):(i.each("end",function(e,i){null!==t.afterDraw&&void 0!==t.afterDraw&&t.afterDraw(this,e,i)}),r.each("end",function(){e.select(this).remove()}))},t._removeTooltip=function(e,t,i,r){i._tooltipGroup&&i._tooltipGroup.remove()},t._rollUp=function(e,t,i){var r=[];return t=null!==t&&void 0!==t?[].concat(t):[],e.forEach(function(e){var a=-1,s={},n=!0;r.forEach(function(i,r){-1===a&&(n=!0,t.forEach(function(t){n=n&&e[t]===i[t]},this),n&&(a=r))},this),-1!==a?s=r[a]:(t.forEach(function(t){s[t]=e[t]},this),r.push(s),a=r.length-1),i.forEach(function(i){-1===t.indexOf(i)&&(void 0===s[i]&&(s[i]=[]),s[i]=s[i].concat(e[i]))},this),r[a]=s},this),r},t._showBarTooltip=function(t,i,r,a){var s,n,o,l,c,d,u=5,h=10,p=750,v=e.select(i),m=v.node().getBBox().x,g=v.node().getBBox().y,f=v.node().getBBox().width,y=v.node().getBBox().height,x=v.attr("opacity"),b=v.attr("fill"),_=a._dropLineOrigin(),w=e.rgb(e.rgb(b).r+.6*(255-e.rgb(b).r),e.rgb(b).g+.6*(255-e.rgb(b).g),e.rgb(b).b+.6*(255-e.rgb(b).b)),k=e.rgb(e.rgb(b).r+.8*(255-e.rgb(b).r),e.rgb(b).g+.8*(255-e.rgb(b).g),e.rgb(b).b+.8*(255-e.rgb(b).b)),D=a.getTooltipText(t),T=0,F=0,C=0,S=function(e,t){var i=v.node().getCTM(),a=r.svg.node().createSVGPoint();return a.x=e||0,a.y=t||0,a.matrixTransform(i)};null!==r._tooltipGroup&&void 0!==r._tooltipGroup&&r._tooltipGroup.remove(),r._tooltipGroup=r.svg.append("g"),a.p||(d=a._isStacked()?1:f/2,a.x._hasCategories()||null===_.y||r._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+r.customClassList.tooltipDropLine).attr("x1",m<a.x._origin?m+d:m+f-d).attr("y1",g<_.y?g+y:g).attr("x2",m<a.x._origin?m+d:m+f-d).attr("y2",g<_.y?g+y:g).call(function(){r.noFormats||this.style("fill","none").style("stroke",b).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)}).transition().delay(p/2).duration(p/2).ease("linear").attr("y2",g<_.y?_.y-1:_.y+1),d=a._isStacked()?1:y/2,a.y._hasCategories()||null===_.x||r._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+r.customClassList.tooltipDropLine).attr("x1",m<_.x?m+f:m).attr("y1",g<a.y._origin?g+d:g+y-d).attr("x2",m<_.x?m+f:m).attr("y2",g<a.y._origin?g+d:g+y-d).call(function(){r.noFormats||this.style("fill","none").style("stroke",b).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",x)}).transition().delay(p/2).duration(p/2).ease("linear").attr("x2",m<_.x?_.x-1:_.x+1)),s=r._tooltipGroup.append("g"),n=s.append("rect").attr("class","dimple-tooltip "+r.customClassList.tooltipBox),s.selectAll(".dimple-dont-select-any").data(D).enter().append("text").attr("class","dimple-tooltip "+r.customClassList.tooltipLabel).text(function(e){return e}).call(function(){r.noFormats||this.style("font-family",a.tooltipFontFamily).style("font-size",a._getTooltipFontSize())}),s.each(function(){F=this.getBBox().width>F?this.getBBox().width:F,C=this.getBBox().width>C?this.getBBox().height:C}),s.selectAll("text").attr("x",0).attr("y",function(){return T+=this.getBBox().height,T-this.getBBox().height/2}),n.attr("x",-u).attr("y",-u).attr("height",Math.floor(T+u)-.5).attr("width",F+2*u).attr("rx",5).attr("ry",5).call(function(){r.noFormats||this.style("fill",k).style("stroke",w).style("stroke-width",2).style("opacity",.95)}),S(m+f+u+h+F).x<parseFloat(r.svg.node().getBBox().width)?(o=m+f+u+h,l=g+y/2-(T-(C-u))/2):S(m-(u+h+F)).x>0?(o=m-(u+h+F),l=g+y/2-(T-(C-u))/2):S(0,g+y+T+h+u).y<parseFloat(r.svg.node().getBBox().height)?(o=m+f/2-(2*u+F)/2,o=o>0?o:h,o=o+F<parseFloat(r.svg.node().getBBox().width)?o:parseFloat(r.svg.node().getBBox().width)-F-h,l=g+y+2*u):(o=m+f/2-(2*u+F)/2,o=o>0?o:h,o=o+F<parseFloat(r.svg.node().getBBox().width)?o:parseFloat(r.svg.node().getBBox().width)-F-h,l=g-T-(C-u)),c=S(o,l),s.attr("transform","translate("+c.x+" , "+c.y+")")},t._showPointTooltip=function(i,r,a,s){var n,o,l,c,d=5,u=10,h=750,p=e.select(r),v=parseFloat(p.attr("cx")),m=parseFloat(p.attr("cy")),g=parseFloat(p.attr("r")),f=t._helpers.opacity(i,a,s),y=p.attr("stroke"),x=s._dropLineOrigin(),b=e.rgb(e.rgb(y).r+.6*(255-e.rgb(y).r),e.rgb(y).g+.6*(255-e.rgb(y).g),e.rgb(y).b+.6*(255-e.rgb(y).b)),_=e.rgb(e.rgb(y).r+.8*(255-e.rgb(y).r),e.rgb(y).g+.8*(255-e.rgb(y).g),e.rgb(y).b+.8*(255-e.rgb(y).b)),w=0,k=0,D=0,T=s.getTooltipText(i);null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),
a._tooltipGroup=a.svg.append("g"),a._tooltipGroup.append("circle").attr("cx",v).attr("cy",m).attr("r",g).call(function(){a.noFormats||this.attr("opacity",0).style("fill","none").style("stroke",y).style("stroke-width",1)}).transition().duration(h/2).ease("linear").attr("r",g+s.lineWeight+2).call(function(){a.noFormats||this.attr("opacity",1).style("stroke-width",2)}),null!==x.y&&a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",v).attr("y1",m<x.y?m+g+s.lineWeight+2:m-g-s.lineWeight-2).attr("x2",v).attr("y2",m<x.y?m+g+s.lineWeight+2:m-g-s.lineWeight-2).call(function(){a.noFormats||this.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)}).transition().delay(h/2).duration(h/2).ease("linear").attr("y2",m<x.y?x.y-1:x.y+1),null!==x.x&&a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",v<x.x?v+g+s.lineWeight+2:v-g-s.lineWeight-2).attr("y1",m).attr("x2",v<x.x?v+g+s.lineWeight+2:v-g-s.lineWeight-2).attr("y2",m).call(function(){a.noFormats||this.style("fill","none").style("stroke",y).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)}).transition().delay(h/2).duration(h/2).ease("linear").attr("x2",v<x.x?x.x-1:x.x+1),n=a._tooltipGroup.append("g"),o=n.append("rect").attr("class","dimple-tooltip "+a.customClassList.tooltipBox),n.selectAll(".dont-select-any").data(T).enter().append("text").attr("class","dimple-tooltip "+a.customClassList.tooltipLabel).text(function(e){return e}).call(function(){a.noFormats||this.style("font-family",s.tooltipFontFamily).style("font-size",s._getTooltipFontSize())}),n.each(function(){k=this.getBBox().width>k?this.getBBox().width:k,D=this.getBBox().width>D?this.getBBox().height:D}),n.selectAll("text").attr("x",0).attr("y",function(){return w+=this.getBBox().height,w-this.getBBox().height/2}),o.attr("x",-d).attr("y",-d).attr("height",Math.floor(w+d)-.5).attr("width",k+2*d).attr("rx",5).attr("ry",5).call(function(){a.noFormats||this.style("fill",_).style("stroke",b).style("stroke-width",2).style("opacity",.95)}),v+g+d+u+k<parseFloat(a.svg.node().getBBox().width)?(l=v+g+d+u,c=m-(w-(D-d))/2):v-g-(d+u+k)>0?(l=v-g-(d+u+k),c=m-(w-(D-d))/2):m+g+w+u+d<parseFloat(a.svg.node().getBBox().height)?(l=v-(2*d+k)/2,l=l>0?l:u,l=l+k<parseFloat(a.svg.node().getBBox().width)?l:parseFloat(a.svg.node().getBBox().width)-k-u,c=m+g+2*d):(l=v-(2*d+k)/2,l=l>0?l:u,l=l+k<parseFloat(a.svg.node().getBBox().width)?l:parseFloat(a.svg.node().getBBox().width)-k-u,c=m-w-(D-d)),n.attr("transform","translate("+l+" , "+c+")")},t.filterData=function(e,t,i){var r=e;return null!==t&&null!==i&&(null!==i&&void 0!==i&&(i=[].concat(i)),r=[],e.forEach(function(e){null===e[t]?r.push(e):i.indexOf([].concat(e[t]).join("/"))>-1&&r.push(e)},this)),r},t.getUniqueValues=function(e,t){var i=[];return null!==t&&void 0!==t&&(t=[].concat(t),e.forEach(function(e){var r="";t.forEach(function(t,i){i>0&&(r+="/"),r+=e[t]},this),-1===i.indexOf(r)&&i.push(r)},this)),i},t.newSvg=function(t,i,r){var a=null;if((null===t||void 0===t)&&(t="body"),a=e.select(t),a.empty())throw"The '"+t+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return a.append("svg").attr("width",i).attr("height",r)},t}),angular.module("tuktukV2Dahboard").run(["$templateCache",function(e){e.put("app/drivers/detail.html",'<div class=container-fluid><div class=row><form class="form-inline date-selection date-selection-dr"><div class=form-group><input ng-change=vm.getAllData() class="form-control cstm-width text-center" type=daterange ng-model=selectedDates separator=" - " format="DD MMM YY" opens=right ranges=vm.ranges></div></form><!--<div class="col-md-12 col-sm-12 col-xs-12">\n            <span ng-click="vm.changeDate(\'prev\')" style="display: inline-block; padding: 7px;">&#10094;</span> <span class="text-center" ng-model="date" style="display: inline-block; padding: 7px 0;">{{date}}</span> <span ng-click="vm.changeDate(\'next\')" ng-if="!vm.live" style="display: inline-block; padding: 7px;">&#10095;</span>\n        </div>--></div><span class=live ng-if=vm.live>LIVE</span> <span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><br><br><br><br><br><div class="row overview-box"><span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><div class="col-md-12 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-2 col-sm-12 col-xs-12 no-mr no-pd"><div class="box box-heading box-0 text-center" ng-class="{\'box-online\': vm.profile.state== 22 || vm.profile.state== 11, \'box-offline\': vm.profile.state== 10 } "><img ng-src="https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?url={{vm.profile.profileImage}}&container=focus&resize_w=75&resize_h=75&refresh=2592000" class=iw-driver height=50><h4 class=title style=margin-top:10px>{{vm.profile.name}}</h4></div></div><div class="col-md-10 col-sm-12 col-xs-12"><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.id}}</h4><span>id</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.phone}}</h4><span>phone</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.vehicle}}</h4><span>vehicle number</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.joinedOn*1000 | date:\'dd MMM yy\'}}</h4><span>joined On</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.rides_today.total}} <small>/ {{vm.profile.rides_today.unique_ride}}</small></h4><span>ride / u</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.rides_total.total}} <small>/ {{vm.profile.rides_total.unique_ride}}</small></h4><span>Total rides</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box uib-popover-template="\'myPopoverTemplate1.html\'" popover-trigger=mouseenter popover-placement=bottom><h4 class=number>{{vm.profile.today_distance.total | number:2}}</h4><span>distance</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box uib-popover-template="\'myPopoverTemplate2.html\'" popover-trigger=mouseenter popover-placement=bottom><h4 class=number>{{vm.profile.today_online.total_hours | secondsToDateTime}}</h4><span>online hour</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{vm.profile.feedbackRating | number:2}}</h4><span>feedback</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>Rs. {{vm.profile.total_fare | number:0}} <small>/ {{vm.profile.today_fare | number:0}}</small></h4><span>total fare / fare</span></div></div><div class="col-md-2 col-sm-4 col-xs-12"><div class=box><h4 class=number>Rs. {{vm.profile.total_earning | number:0}} <small>/ {{vm.profile.today_earning | number:0}}</small></h4><span>total earning / earning</span></div></div><!--\n<div class="col-md-2 col-sm-4 col-xs-12">\n                        <div class="box">\n                            <h4 class="number" ng-if="vm.profile.state== 22 || vm.profile.state== 11">Online</h4>\n                            <h4 class="number" ng-if="vm.profile.state== 10">Offline</h4>\n                            <span>Current Status</span>\n                        </div>\n                    </div>\n --><div class="col-md-2 col-sm-4 col-xs-12"><div class=box uib-popover-template="\'myPopoverTemplate3.html\'" popover-trigger=mouseenter popover-placement=bottom><h4 class=number>{{vm.profile.today_bid.total}}</h4><span>bid</span></div></div></div></div></div></div></div><div class=row><!--<div class="col-md-12 col-sm-12 col-xs-12">\n                    <div class="panel panel-default">\n                        <div class="panel-heading">\n                            <h4 style="margin-top: 0" class="title">Heatmap</h4></div>\n                        <div class="panel-body">\n                            <div id="example">\n                                <svg id="visualisation" width="1000" height="500"></svg>\n                            </div>\n                        </div>\n                    </div>\n                </div>--><div class="col-md-12 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Trips</h4></div><div class=panel-body><div class=table-responsive><table ng-table=tableParams class="table table-bordered table-striped"><tr ng-class="{\'unTruncate\':row.showMore,\'truncate\':!row.showMore}" class=truncate ng-repeat="row in $data track by $index"><td data-title="\'Trip ID\'" sortable="\'id\'" style="text-transform: inherit"><div style="white-space: normal"><!--  <a href="void:javascript(0);" ng-click="selectTrip(row)">{{row.id}}</a>--> <a ui-sref="home.trip_detail({id: row.id,driverId: row.driverInfo.id,riderId: row.riderInfo.id})">{{row.id}}</a></div></td><td data-title="\'Date & Time\'" sortable="\'requestOn\'" style=width:150px><div>{{(row.requestOn)*1000 | date:"dd/MM/yy \'at\' h:mma"}}</div></td><td data-title="\'Rider Info\'"><div style="white-space: normal">{{row.riderInfo.name}}<br>{{row.riderInfo.phone}}</div></td><td data-title="\'Status\'" sortable="\'tripState\'" style="width: 100px"><div ng-if="row.tripState == 20" class=text-primary>Requested</div><div ng-if="row.tripState == 22">Allocated</div><div ng-if="row.tripState == 30">For Trip</div><div ng-if="row.tripState == 40">At Pickup</div><div ng-if="row.tripState == 60">At Destination</div><div ng-if="row.tripState == 50" class=text-info>In trip</div><div ng-if="row.tripState == 61" class=text-success>Successful</div><div ng-if="row.tripState == 70" class=text-warning>Can by Driver</div><div ng-if="row.tripState == 71" class=text-warning>Can by Rider</div><div ng-if="row.tripState == 80">No Drv Avlble</div><div ng-if="row.tripState == 81" class=text-danger>Failed (No Drivers Accepted)</div><div ng-if="row.tripState == 82">Terminated</div></td><td data-title="\'Pickup\'" style="max-width: 200px"><div style="white-space: normal">{{row.pickUp.line1 + \' \' + row.pickUp.line2}} {{row.pickUp.city + " " + row.pickUp.state + \' \' + row.pickUp.country}}</div></td><td data-title="\'Drop\'" style="max-width: 200px"><div style="white-space: normal">{{row.drop.line1 + \' \' + row.drop.line2}} {{row.pickUp.city + " " + row.drop.state + \' \' + row.drop.country}}</div></td><td data-title="\'Time\'" align=center><div style="white-space: normal">{{getTimeDiff(row.dropOn,row.pickupOn)}}</div></td><td data-title="\'Distance (KM)\'" align=center><div style="white-space: normal">{{(row.disPickupDrop)/1000 | number:2}}</div></td><td data-title="\'Amt. (Rs.)\'" align=right><div style="white-space: normal">{{row.amount.total | number:2}}<br><span class=small>Cash: {{row.amount.cash | number:2}}</span> <span class=small>Citrus: {{row.amount.citrus | number:2}}</span> <span class=small>Discount: {{row.amount.discount | number:2}}</span></div></td><td data-title="\'Rating\'" sortable="\'riderFeedbackRating\'" align=center><div style="white-space: normal">{{row.riderFeedbackRating | number:1}}</div></td><!--<td data-title="\'\'">\n                                    <button class="btn btn-xs btn-link" ng-click="showMore(row)">More <i\n                                            class="glyphicon glyphicon-triangle-bottom"></i></button>\n                                </td>--></tr></table><table class="table table-bordered table-condensed" ng-show=tblNoData><tr><td colspan=9>No data found</td></tr></table></div></div><br><br></div></div></div></div><script type=text/ng-template id=myPopoverTemplate1.html><div class="box text-center">\n        <h4 class="number no-mr">{{vm.profile.today_distance.intrip | number:2}}</h4>\n        <span>in trip</span>\n        <br>\n        <h4 class="number no-mr pd10-tp">{{vm.profile.today_distance.forTrip | number:2}}</h4>\n        <span>for trip</span>\n\n    </div></script><script type=text/ng-template id=myPopoverTemplate2.html><div class="box text-center">\n        <h4 class="number no-mr">{{vm.profile.today_online.intrip_time | secondsToDateTime}}</h4>\n        <span>in trip</span>\n        <br>\n        <h4 class="number no-mr pd10-tp">{{vm.profile.today_online.fortrip_time | secondsToDateTime}}</h4>\n        <span>for trip</span>\n\n    </div></script><script type=text/ng-template id=myPopoverTemplate3.html><div class="box text-center">\n        <h4 class="number no-mr">{{vm.profile.today_bid.accepted}}</h4>\n        <span>accepted</span>\n        <br>\n        <h4 class="number no-mr pd10-tp">{{vm.profile.today_bid.rejected}}</h4>\n        <span>rejected</span>\n        <br>\n        <h4 class="number no-mr pd10-tp">{{vm.profile.today_bid.ignored}}</h4>\n        <span>ignored</span>\n\n    </div></script>'),e.put("app/drivers/drivers.html",'<div class=container-fluid><div class=row style="z-index:1; position:fixed; width:98%; padding:10px 0; left:53px"><div class="col-md-12 col-sm-12 col-xs-12"><span ng-click="vm.changeDate(\'prev\')" style="display: inline-block; padding: 7px">&#10094;</span> <span class=text-center ng-model=date style="display: inline-block; padding: 7px 0">{{date}}</span> <span ng-click="vm.changeDate(\'next\')" ng-if=!vm.live style="display: inline-block; padding: 7px">&#10095;</span></div></div><span class=live ng-if=vm.live>LIVE</span> <span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><br><br><br><br><br><div class="row overview-box"><span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><div class="col-md-12 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-2 col-sm-4 col-xs-12 no-mr no-pd"><div class="box box-heading box-1 text-center"><h4 class=title>DRIVERS</h4></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{ vm.overview.driver.total_drivers}}</h4><span>Total</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.free_drivers}}</h4><span>Free</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.occupied_drivers}}</h4><span>Occupied</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.online_drivers_percentage | number:2}}%</h4><span>Online</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.utilization_percentage | number:2}}%</h4><span>Utilization</span></div></div></div></div></div></div><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><div class=pull-right><input ng-change=vm.getAcquisition() class="form-control cstm-width text-center daterangepicker-aqq-chart" type=daterange ng-model=datesForAcq separator=" - " format="DD MMM YY" opens=left ranges=vm.ranges></div><h4 style="margin-top: 0" class=title>Driver Acquisition</h4></div><div class=panel-body><div><nvd3 options=vm.acquisitionChart data=vm.acquisitionData config=vm.config></nvd3></div></div></div></div><div class="col-md-12 col-sm-12 col-xs-12" ngsf-fullscreen><form class=form-inline><div class="input-group col-md-3 col-sm-12 col-xs-12"><select ng-model=vm.filterTerm class=form-control ng-options="statusFilter.name for statusFilter in vm.filterFields track by statusFilter.value"><option value="" disabled=disabled>Select Filter</option></select></div><div class="input-group col-md-3 col-sm-12 col-xs-12"><input ng-model=vm.searchTerm class="form-control input-search-term" placeholder=term ng-disabled=!vm.filterTerm></div><div class="input-group col-md-1 col-sm-12 col-xs-12"><button ng-disabled=!vm.searchTerm ng-click=vm.searchTable() class="btn btn-small">Search</button></div><div class="input-group col-md-3 col-sm-12 col-xs-12"><select ng-model=vm.statusCodes ng-change=vm.searchTable() class=form-control ng-options="statusFilter.name for statusFilter in vm.tripStatusFilters track by statusFilter.value"><option value="" disabled=disabled>Select Status</option></select></div></form><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Top Drivers</h4></div><div class=panel-body><div class=table-responsive><table ng-table=tableParams class="table table-bordered table-striped text-center"><!--<thead>\n                                <tr>\n                                    <th width="120" style="text-align:left;">#ID</th>\n                                    <th width="200" style="text-align:left;">Name</th>\n                                    <th width="120" style="text-align:right;">Earning(Rs.)</th>\n                                    <th width="120">Rides</th>\n                                    <th style="text-align:left;">Online</th>\n\n                                </tr>\n                            </thead>--><tbody><tr ng-repeat="row in $data track by $index"><td data-title="\'#ID\'" class=text-left><a ui-sref=home.drivers_detail({driverId:row.driver_id})>{{row.driver_id}}</a></td><td data-title="\'Name\'" sortable="\'name\'" class=text-left>{{row.name}}</td><td data-title="\'Earning(Rs.)\'" sortable="\'earning\'" class=text-right>{{row.earning}}</td><td data-title="\'Rides\'" sortable="\'rides\'">{{row.rides}}</td><td class=text-left data-title="\'Online\'"><span ng-repeat="time in row.online" class="label label-primary">{{time.start*1000 | date:\'h:mma\'}} - {{time.end*1000 | date:\'h:mma\'}}</span></td></tr></tbody></table></div></div><br><br></div></div></div></div>'),e.put("app/live/live.html",'<div class=container-fluid ng-if=vm.overview><div class=row style="z-index:1; position:fixed; width:98%; padding:10px 0; left:53px"><div class="col-md-12 col-sm-12 col-xs-12"><span ng-click="vm.changeDate(\'prev\')" style="display: inline-block; padding: 7px">&#10094;</span> <span class=text-center ng-model=date style="display: inline-block; padding: 7px 0">{{date}}</span> <span ng-click="vm.changeDate(\'next\')" ng-if=!vm.live style="display: inline-block; padding: 7px">&#10095;</span></div></div><span class=live ng-if=vm.live>LIVE</span> <span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><br><br><br><br><br><div class="row overview-box"><div class="col-md-12 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-2 col-sm-4 col-xs-12 no-mr no-pd"><div class="box box-heading box-1 text-center"><h4 class=title>DRIVERS</h4></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{ vm.overview.driver.total_drivers}}</h4><span>Total</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.free_drivers}}</h4><span>Free</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.occupied_drivers}}</h4><span>Occupied</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.online_drivers_percentage | number:2}}%</h4><span>Online</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.driver.utilization_percentage | number:2}}%</h4><span>Utilization</span></div></div></div></div></div><div class="col-md-12 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-2 col-sm-4 col-xs-12 no-mr no-pd"><div class="box box-heading box-2 text-center"><h4 class=title>BOOKINGS</h4></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.trip.total_booking}} <small>/ {{vm.overview.trip.unique_booking}}</small></h4><span>Total / U</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.trip.successful.total}} <small>/ {{ vm.overview.trip.successful.unique_riders}} / {{ vm.overview.trip.fulfillment | number:2}}%</small></h4><span>Fulfilled / U / Fulfilment</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number uib-popover-template="\'myPopoverTemplate.html\'" popover-trigger=mouseenter>{{vm.overview.trip.cancelled.total}} <small>/ {{ vm.overview.trip.cancelled.total_unique_rider}}</small></h4><span class="title text-warning">Cancelled / U</span><!--<button uib-popover-template="\'myPopoverTemplate.html\'" type="button" class="btn btn-default">Popover With Template</button>--></div></div><div class="col-md-1 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.trip.before_allocation.total_count}} <small>/ {{ vm.overview.trip.before_allocation.unique_count }}</small></h4><span class="title text-warning">Can before Alloc / U</span></div></div><div class="col-md-2 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.trip.failed.total}} <small>/ {{ vm.overview.trip.failed.unique_rider}}</small></h4><span>Failed / U</span></div></div><div class="col-md-1 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{ vm.overview.trip.in_process}}</h4><span>in Prog</span></div></div></div></div></div><div class="col-md-6 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-4 col-sm-4 col-xs-12 no-mr no-pd"><div class="box box-heading box-3 text-center"><h4 class=title>RIDERS</h4></div></div><div class="col-md-4 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.rider.total_riders}}</h4><span>Total</span></div></div><div class="col-md-4 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.rider.new_riders_reg}}</h4><span>New</span></div></div></div></div></div><div class="col-md-6 col-sm-12 col-xs-12 text-center"><div class="panel panel-default"><div class=panel-body><div class="col-md-4 col-sm-4 col-xs-12 no-mr no-pd"><div class="box box-heading box-4 text-center"><h4 class=title>tCASH</h4></div></div><div class="col-md-4 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.tcash.total_amount}}/-</h4><span>Total Amount</span></div></div><div class="col-md-4 col-sm-4 col-xs-6"><div class=box><h4 class=number>{{vm.overview.tcash.trip_affected}}</h4><span>Trips Affected</span></div></div></div></div></div></div><div class=row><div class="col-md-6 col-sm-12 col-xs-12" ngsf-fullscreen><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Trips</h4></div><div class=panel-body><div><nvd3 options=vm.tripChartOptions data=vm.trips config=vm.config></nvd3></div><a ngsf-toggle-fullscreen show-if-fullscreen-enabled></a></div></div></div><div class="col-md-6 col-sm-12 col-xs-12" ngsf-fullscreen><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Rides</h4></div><div class=panel-body><div><nvd3 options=vm.newRidersChartOptions data=vm.newRiders config=vm.config></nvd3></div><a ngsf-toggle-fullscreen show-if-fullscreen-enabled></a></div></div></div><div class="col-md-12 col-sm-12 col-xs-12" ngsf-fullscreen><div class="panel panel-default"><div class=panel-heading><div class=pull-right><select name=mySelect id=mySelect ng-options="option.label for option in vm.heatMapFilers track by option.id" ng-model=vm.selected ng-change=vm.loadHeatMap();></select><span style="padding:0 10px 0 5px">{{vm.heatMapDataLength}}</span> <a ngsf-toggle-fullscreen show-if-fullscreen-enabled style=color:#ccc><i class="fa fa-arrows-alt" show-if-fullscreen=false></i> <i show-if-fullscreen=true>X</i></a></div><h4 style="margin-top: 0" class=title>Heat Map</h4></div><div class=panel-body><div><ng-map id=live_map zoom=13 center="[22.717081666666665, 75.87155666666666]" on-resized=vm.resizeMap() trigger-resize=true><!--   <heatmap-layer id="foo" data="\'heatMapData\'"></heatmap-layer>--></ng-map><rzslider rz-slider-model=slider.minValue rz-slider-high=slider.maxValue rz-slider-options=slider.options></rzslider></div></div></div></div></div></div><script type=text/ng-template id=myPopoverTemplate.html><div class="box text-center">\n        <h4 class="number no-mr">{{vm.overview.trip.cancelled.rider_cancelled}}\n            <small>/ {{vm.overview.trip.cancelled.unique_rider_cancelled}}</small>\n        </h4>\n        <span>Rider Cancelled / u</span>\n        <h4 class="number no-mr">{{vm.overview.trip.cancelled.driver_cancelled}}\n            <small>/ {{vm.overview.trip.cancelled.unique_rider_cancelled_by_driver}}</small>\n        </h4>\n        <span>Driver Cancelled / u</span>\n\n    </div></script>'),e.put("app/login/login.html",'<style>html {\n    height: 100%;\n}\nbody {\n    background-color: #333;\n    height: 100%;\n    background-image: url("../../assets/images/blur-bg.jpg");\n    background-size: cover;\n    background-repeat: no-repeat;\n    background-attachment: fixed;\n}</style><div class="well login-bg"><div class=row><div class=col-md-12><div class=col-md-12><h1 class=logo-login><img src=assets/images/gotuktuk-play-logo.png title=Tuktuk height=64></h1></div><div class=col-md-12><form name=login novalidate><div class=group><input class=inputMaterial type=text ng-model=user.username required placeholder=Username style="border:none !important"></div><div class="help-block animated slideInUp" ng-messages=login.username.$error ng-if=login.username.$touched><p ng-message=required>Please enter username.</p></div><div class=group><input class=inputMaterial type=password ng-model=user.password required placeholder=Password style="border:none !important"></div><div class="help-block animated slideInUp" ng-messages=login.password.$error ng-if=login.password.$touched><p ng-message=required>Please enter password.</p></div><div class=group><button class="btn btn-success form-control" style="border:none !important; width:100%" ng-disabled=login.$invalid ng-click=loginUser()>Login</button></div></form></div></div></div></div>'),e.put("app/main/main.html",'<nav id=load class="navbar navbar-default navbar-fixed-top" role=navigation><div class=container-fluid><div class=row><div><a class=tg-menu ng-click="toggle = !toggle"><img src=assets/images/menu.svg title=Tuktuk></a></div></div></div></nav><div class=sidenav ng-class="{\'open\' : toggle}"><a ng-click="toggle = !toggle" class=toggle-menu-close><img src=assets/images/menu.svg title=Tuktuk></a><ul class="nav nav-stacked"><li style="padding:2px 10px"><span class=pull-right style="color: #333; padding: 15px 0px">Admin <span style="padding: 0;color:#333" ng-click=logout() id=admin type=button uib-dropdown-toggle ng-disabled=disabled>[ Logout ] </span></span><img height=30 style="margin:10px 12px" title=Tuktuk src=assets/images/gotuktuk-play-logo.png></li><li class=header><span style="padding:5px 10px">{{selectedVehicle.name}}</span> | <span style="padding:5px 10px">{{selectedCity.name}}</span></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref="home.live({city: city,vehicleType: vehicleType})"><span class="fa fa-heart"></span> Live</a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref="home.drivers({city: city,vehicleType: vehicleType})"><span class="fa fa-paper-plane"></span> Drivers</a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref="home.maps({city: city,vehicleType: vehicleType})"><span class="fa fa-map"></span>Maps</a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref="home.performance({city: city,vehicleType: vehicleType})"><span class="fa fa-area-chart"></span> <strike>Performance</strike> <sup class=text-lowercase>Beta</sup></a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref="home.trips({city: city,vehicleType: vehicleType})"><span class="fa fa-map-pin"></span> Trips</a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref=home.offers><span class="fa fa-barcode"></span> Offers</a></li><li ng-click="toggle = !toggle" ui-sref-active=active><a ui-sref=home.riders><span class="fa fa-barcode"></span> <strike>Riders</strike></a></li></ul></div><ui-view></ui-view>'),e.put("app/maps/maps.html",'<style>.navbar-fixed-top, .navbar-fixed-bottom {\n        z-index: 10;\n    }\n\n    .live {\n        background-color: rgb(48, 176, 58);\n        border-radius: 100%;\n        height: 12px;\n        line-height: 12px;\n        position: absolute;\n        right: 50px !important;\n        text-indent: 17px;\n        top: 22px;\n        width: 12px;\n        z-index: 10;\n        left: inherit;\n    }</style><div class=content><div class=live>LIVE</div><div class=content-div><ng-map id=drivers_map center="[22.717081666666665, 75.87155666666666]" style=height:100% zoom=12><map-data load-geo-json={{vm.API_URL}}geofence></map-data><!--<map-data  add-geo-json={{vm.geoJSON}}>\n            </map-data>--><div><marker ng-repeat="driver in vm.allDrivers.free.drivers track by $index" icon="{\n        url:\'assets/images/icons/marker-green.svg\',\n        scaledSize:[30,30],\n        origin: [0,0],\n        anchor: [15,15]\n      }" id=free-driver-{{$index}} on-click="vm.showDetail(driver,\'free-driver-\'+$index)" position={{driver.marker}}></marker><!--<marker ng-repeat="driver in vm.allDrivers.available.drivers track by $index"icon="{\n                url:\'assets/images/icons/marker-green.svg\',\n                scaledSize:[30,30],\n                origin: [0,0],\n                anchor: [15,15]\n              }"\n                        id="custom-marker-{{$index}}"\n                        on-click="vm.map.showInfoWindow(\'iw-drivers\', \'custom-marker-\'+$index)"\n                        position="{{driver.marker}}">\n                </marker>\n              </div>\n              <div>\n                <marker ng-repeat="driver in vm.allDrivers.occupied.drivers track by $index" icon="{\n                url:\'assets/images/icons/marker-red.svg\',\n                scaledSize:[30,30],\n                origin: [0,0],\n                anchor: [15,15]\n              }"\n                        id="custom-marker-{{$index}}"\n                        on-click="vm.showDetail(driver)"\n                        position="{{driver.marker}}">\n                </marker>--></div><info-window id=iw-drivers><div ng-non-bindable=""><div class=info-window><div class=iw-wrapper><div class="iw-header text-center"><img ng-src={{vm.driver.profile.profile_image}} class=iw-driver height=50><h3>{{vm.driver.profile.name}}</h3></div><div class=iw-content><table class=table><tbody><tr><td class=text-center><i class="fa fa-clock-o"></i></td><td>Time</td><td>{{vm.driver.profile.time | date:\'shortTime\'}}</td></tr><tr><td class=text-center><i class="fa fa-mobile-phone"></i></td><td>Phone#</td><td>{{vm.driver.profile.phone}}</td></tr><tr><td class=text-center><i class="fa fa-taxi"></i></td><td>Vehicle#</td><td>{{vm.driver.profile.vehicle}}</td></tr><tr><td class=text-center><i class="fa fa-user"></i></td><td>ID#</td><td>{{vm.driver.profile.driverId}}</td></tr><tr><td class=text-center><i class="fa fa-map-marker"></i></td><td>Location</td><td style=max-width:100px><a ng-click=vm.clicked(vm.driver.marker)><span ng-if=!vm.driver.address>Show</span></a> <span ng-if=vm.driver.address>{{vm.driver.address}}</span></td></tr></tbody></table></div></div></div></div></info-window></ng-map><div class=tabs-view><button ng-click="tabView = !tabView" ng-class="{\'left-arrow\' : tabView}" class="btn btn-default tabs-toggle-btn map-btn" title="Show More..."><i class="fa fa-angle-double-right"></i></button><div class=tabs-toggle ng-class="{\'tabs-show\' : tabView}"><uib-tabset active=active><uib-tab index=0 heading=Drivers><div class=row><!--\n              <div class="col-md-4">\n                              <div class="pentagon total">\n                                <div class="text-center">\n                                  <h4>Total</h4>\n                                  <span>{{vm.allDrivers.total}}</span>\n                                </div>\n                              </div>\n                            </div>\n\n                            <div class="col-md-6">\n                              <div class="pentagon occupied">\n                                <div class="text-center">\n                                  <h4>Occupied</h4>\n                                  <span>{{vm.allDrivers.occupied.total}}</span>\n                                </div>\n                              </div>\n                            </div>\n                             --><div class=col-md-12 style="min-height: 80px"><div class="pentagon available"><div class=text-center><h4>Free</h4><span>{{vm.allDrivers.free.total}}</span></div></div></div></div></uib-tab></uib-tabset></div></div></div></div>'),
e.put("app/offers/offers.html",'<script type=text/ng-template id=headerCheckbox.html><input type="checkbox" ng-model="vm.offerCheckboxes.checked" class="select-all" value=""/></script><script type=text/ng-template id=driverCheckbox.html><input type="checkbox" ng-model="vm.driverCheckboxes.checked" class="select-all-drivers" value=""/></script><script type=text/ng-template id=alert.html><p>Are you sure you want to delete all offers assigned to this driver?</p>\n    <div class="ngdialog-buttons">\n        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">No\n        </button>\n        <button type="button" class="ngdialog-button ngdialog-button-primary"\n                ng-click="vm.removeAllAssignedOffers();closeThisDialog(0)">Yes\n        </button>\n    </div></script><script type=text/ng-template id=alertSingleDelete.html><p>Are you sure you want to delete this offer?</p>\n    <div class="ngdialog-buttons">\n        <button type="button" class="ngdialog-button ngdialog-button-secondary" ng-click="closeThisDialog(0)">No\n        </button>\n        <button type="button" class="ngdialog-button ngdialog-button-primary"\n                ng-click="removeSingleOffer(index,row);closeThisDialog(0)">Yes\n        </button>\n    </div></script><div class=container-fluid><span class=live ng-if=vm.live>LIVE</span> <span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><br><br><br><br><div class=row><div class="col-md-5 col-sm-12 col-xs-12"><form class=form-inline><div class="input-group col-md-4 col-sm-6 col-xs-12 no-pd"><input type=text class=form-control id=searchOffer placeholder="Enter Offer Code" ng-model=vm.offerTxt></div><div class="input-group col-md-1 col-sm-1 col-xs-12 text-center"><button type=submit class="btn btn-search" ng-click=vm.searchOffers()><span aria-hidden=true class="glyphicon glyphicon-search"></span></button></div><div class="input-group col-md-1 col-sm-1 col-xs-12 text-left"><button type=submit class="btn btn-search" ng-click=vm.clearOfferSearch()><span aria-hidden=true class="glyphicon glyphicon-remove"></span></button></div></form><div class="panel panel-default"><div class="panel-heading box-6"><h4 style="margin-top: 0" class=title>Offers</h4></div><div class=panel-body><div class=table-responsive><table ng-table=offerTableParams class="table table-bordered"><tbody><tr ng-repeat="row in $data track by $index"><td header="\'headerCheckbox.html\'"><input type=checkbox ng-model=vm.offerCheckboxes.items[row.id]></td><td data-title="\'Code\'">{{row.code}}</td><td data-title="\'Offer Detail\'">{{row.description}}</td><td data-title="\'Action\'" class=text-center><button type=submit class="btn btn-add" ng-click=" vm.addOffer(row)"><span aria-hidden=true class="glyphicon glyphicon-plus"></span></button></td></tr></tbody></table></div><button type=submit class="btn btn-default pull-right" ng-click=vm.addOffers()><span aria-hidden=true class="glyphicon glyphicon glyphicon-chevron-down"></span> Add Offer(s)</button></div></div></div><div class="col-md-7 col-sm-12 col-xs-12"><form class=form-inline><div class="input-group col-md-4 col-sm-6 col-xs-12 no-pd"><input type=text class=form-control id=searchDriver placeholder="Enter keyword" ng-model=vm.driverTxt></div><div class="input-group col-md-1 col-sm-1 col-xs-12 no-pd text-center"><button type=submit class="btn btn-search" ng-click=vm.searchDrivers()><span aria-hidden=true class="glyphicon glyphicon-search"></span></button></div><div class="input-group col-md-1 col-sm-1 col-xs-12 no-pd text-left"><button type=submit class="btn btn-search" ng-click=vm.clearDriverSearch()><span aria-hidden=true class="glyphicon glyphicon-remove"></span></button></div><div class="input-group col-md-4 col-sm-3 col-xs-12"><select ng-model=vm.filterTerm class=form-control ng-options="statusFilter.name for statusFilter in vm.filterFields track by statusFilter.value"><option value="" disabled=disabled>Select Filter</option></select></div></form><div class="panel panel-default"><div class="panel-heading box-5"><h4 style="margin-top: 0" class=title>Drivers</h4></div><div class=panel-body><div class=table-responsive><table ng-table=driverTableParams class="table table-bordered"><tbody><tr ng-repeat="row in $data track by $index"><td header="\'driverCheckbox.html\'" width=30><input type=checkbox ng-model=vm.driverCheckboxes.items[row.id]></td><td data-title="\'Name\'">{{row.name}}</td><td data-title="\'Driver Info\'">{{row.phone}}, {{row.vehicle}}</td><td data-title="\'Assigned Offer(s)\'"><a ng-if=!row.offers ng-click=vm.getDriverOffers(row)>Show</a><!--<span ng-if="row.offers" ng-repeat="offer in row.offers">{{offer}}<br></span>--> <span ng-if=row.offers ng-repeat="offer in row.offers" class="label label-warning">{{offer}} <button class=label-btn ng-click=vm.openSingleAlert($index,row)>x</button></span></td><td ata-title="\'Action\'" class=text-center><button type=submit class="btn btn-add" ng-click=" vm.addDriver(row)"><span aria-hidden=true class="glyphicon glyphicon-plus"></span></button> <button type=submit class="btn btn-del" ng-click=vm.alertDeleteAllOffers(row)><span aria-hidden=true class="glyphicon glyphicon-remove"></span></button></td></tr></tbody></table></div><button type=submit class="btn btn-default pull-right" ng-click=" vm.addDrivers()"><span aria-hidden=true class="glyphicon glyphicon glyphicon-chevron-down"></span> Add Driver(s)</button><div ng-if=vm.driverExistError>Driver(s) Already selected</div></div></div></div><div class="col-md-12 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Confirmation</h4></div><div class=panel-body><div class=table-responsive><table class="table table-responsive no-mr"><tr><td class=text-left>Offers</td></tr><tr><td class=text-left><span ng-if="vm.selectedOffers.length==0">No Offers Selected</span> <span ng-if="vm.selectedOffers.length>0" class="label label-warning" ng-repeat="offer in vm.selectedOffers track by $index">{{offer.code}} <button class=label-btn ng-click=vm.removeOffer($index)>x</button></span></td></tr><tr><td class=text-left><hr class=hidden-xs></td></tr></table><table class="table table-responsive no-mr"><tr><td class=text-left>Drivers</td></tr><tr><td class=text-left><span ng-if="vm.selectedDrivers.length==0">No Drivers Selected</span> <span ng-if="vm.selectedDrivers.length>0" ng-repeat="driver in vm.selectedDrivers track by $index" class="label label-info">{{driver.name}} <button class=label-btn ng-click=vm.removeDriver($index)>x</button></span></td></tr><tr ng-if="vm.selectedDrivers.length>0 || vm.selectedOffers.length>0"><td class=text-right><hr><button type=submit class="btn btn-default" ng-click=vm.clearAll()><span aria-hidden=true class="glyphicon glyphicon-remove"></span> Clear</button> <button type=submit class="btn btn-success" ng-click=vm.assignOffers()><span aria-hidden=true class="glyphicon glyphicon-ok"></span> Save</button></td></tr></table></div></div></div></div></div></div>'),e.put("app/performance/performance.html",'<div class=container-fluid><div class=row><form class="form-inline date-selection date-selection-dr"><div class=form-group><input ng-change=vm.getAllData() class="form-control cstm-width text-center" type=daterange ng-model=tripDates separator=" - " format="DD MMM YY" opens=right ranges=vm.ranges></div></form><br><br><br><br><div class="col-md-6 col-md-offset-6"><div class="flx-container flx-performance"><div class=flx-cnt-right><div class=text-left><span class=pull-left style="padding:4px 10px 4px 0"><img src=assets/images/trip-req.svg title=Tuktuk height=45></span><span><h4>{{ vm.trips.overview.cum_trip_request}}</h4></span><br><span>Bookings</span></div><div class=text-left><span class=pull-left style="padding:4px 10px 4px 0"><img src=assets/images/trip-suc.svg title=Tuktuk height=45></span><span><h4>{{ vm.trips.overview.cum_successful_trip}}</h4></span><br><span>Successful</span></div><div class=text-left><span class=pull-left style="padding:4px 10px 4px 0"><img src=assets/images/new-rider.svg title=Tuktuk height=45></span><span><h4>{{ vm.riders.overview.cum_new_rider}}</h4></span><br><span>New Riders</span></div></div></div></div></div><div class=row><div class=col-md-6></div><div class="col-md-6 text-right"><form class=form-inline><!--<div class="form-group ">\n                    <input ng-change="vm.getTrips()" class="form-control cstm-width" type="daterange" ng-model="tripDates" separator="/" format="DD-MMM-YY" opens="left" ranges="vm.ranges">\n                </div>--><div class=form-group style=margin-top:15px><div class="radio inpt-style"><label><input type=radio ng-change="vm.changeFrequency(\'trip\', vm.tripFrequency.value)" name=optradio ng-model=vm.tripFrequency.value value=hour><i></i> <span>Per Hour</span></label><label><input type=radio ng-change="vm.changeFrequency(\'trip\', vm.tripFrequency.value)" name=optradio ng-model=vm.tripFrequency.value value=day> <i></i> <span>Per Day</span></label></div><!--   <select ng-model="vm.tripFrequency" class="form-control"\n                            ng-change="vm.changeFrequency(\'trip\', vm.tripFrequency)"\n                            ng-options="frequency.label for frequency in vm.timeFrequency track by frequency.value">\n                    </select>--></div></form></div></div><br><div class=row><div class=col-md-12><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Trips</h4></div><div class=panel-body><div class=table-responsive><nvd3 options=vm.tripChartOptions data=vm.trips config=vm.config></nvd3></div></div></div></div></div><div class=row><div class=col-md-6><!---Driver---><div class=row><div class=col-md-6></div><div class="col-md-6 text-right"><form class=form-inline><!--<div class="form-group ">\n                    <input ng-change="vm.getDrivers()"class="form-control cstm-width" type="daterange" ng-model="driverDates" separator="/" format="DD-MMM-YY" opens="right" ranges="vm.ranges"/>\n                </div>--><div class=form-group style=margin-top:15px><div class="radio inpt-style"><label><input type=radio name=optradio ng-change="vm.changeFrequency(\'driver\',vm.driverFrequency.value)" ng-model=vm.driverFrequency.value value=hour><i></i> <span>Per Hour</span></label><label><input type=radio name=optradio ng-change="vm.changeFrequency(\'driver\',vm.driverFrequency.value)" ng-model=vm.driverFrequency.value value=day> <i></i> <span>Per Day</span></label></div><!--  <select ng-model="vm.driverFrequency" class="form-control"\n                            ng-change="vm.changeFrequency(\'driver\',vm.driverFrequency)"\n                            ng-options="frequency.label for frequency in vm.timeFrequency track by frequency.value">\n                    </select>--></div></form></div></div><br><div class=row><div class=col-md-12><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Driver</h4></div><div class=panel-body><div class=table-responsive><nvd3 options=vm.driverChartOptions data=vm.drivers config=vm.config></nvd3></div></div></div></div></div></div><div class=col-md-6><!--Rider--><div class=row><div class=col-md-6></div><div class="col-md-6 text-right"><form class=form-inline><!--<div class="form-group ">\n                    <input ng-change="vm.getRiders()" class="form-control cstm-width" type="daterange" ng-model="riderDates" separator="/" format="DD-MMM-YY" opens="left" ranges="vm.ranges">\n                </div>--><div class=form-group style=margin-top:15px><div class="radio inpt-style"><label><input type=radio name=optradio ng-change="vm.changeFrequency(\'rider\', vm.riderFrequency.value)" ng-model=vm.riderFrequency.value value=hour><i></i> <span>Per Hour</span></label><label><input type=radio name=optradio ng-change="vm.changeFrequency(\'rider\', vm.riderFrequency.value)" ng-model=vm.riderFrequency.value value=day> <i></i> <span>Per Day</span></label></div><!-- <select ng-model="vm.riderFrequency" class="form-control"\n                                ng-change="vm.changeFrequency(\'rider\', vm.riderFrequency)"\n                                ng-options="frequency.label for frequency in vm.timeFrequency track by frequency.value">\n                        </select>--></div></form></div></div><br><div class=row><div class=col-md-12><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Rider</h4></div><div class=panel-body><div class=table-responsive><nvd3 options=vm.riderChartOptions data=vm.riders config=vm.config></nvd3></div></div></div></div></div></div></div></div>'),e.put("app/riders/riders.html",'<div class=container-fluid><div class=row style="z-index:1; position:fixed; width:98%; padding:10px 0; left:53px"><div class="col-md-12 col-sm-12 col-xs-12"><span ng-click="vm.changeDate(\'prev\')" style="display: inline-block; padding: 7px">&#10094;</span> <span class=text-center ng-model=date style="display: inline-block; padding: 7px 0">{{date}}</span> <span ng-click="vm.changeDate(\'next\')" ng-if=!vm.live style="display: inline-block; padding: 7px">&#10095;</span></div></div><span class=live ng-if=vm.live>LIVE</span> <span class=reload ng-click=vm.refreshPage()><i class="fa fa-refresh" aria-hidden=true></i></span><br><br><br><br><br><div class=row id=matrixChartDiv><div class="col-md-12 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Rider Acquisition</h4></div><div class=panel-body><div><div id=matrixChart></div></div></div></div></div></div></div>'),e.put("app/trips/trip_details.html",'<div class=content><div class=content-div><ng-map id=drivers_map center="[22.717081666666665, 75.87155666666666]" style=height:100% zoom=12><map-data load-geo-json={{vm.API_URL}}geofence></map-data><!--<map-data  add-geo-json={{vm.geoJSON}}>\n            </map-data>--><div><marker ng-repeat="driver in vm.allDrivers.free.drivers track by $index" icon="{\n        url:\'assets/images/icons/marker-green.svg\',\n        scaledSize:[30,30],\n        origin: [0,0],\n        anchor: [15,15]\n      }" id=free-driver-{{$index}} on-click="vm.showDetail(driver,\'free-driver-\'+$index)" position={{driver.marker}}></marker></div><info-window id=iw-drivers><div ng-non-bindable=""><div class=info-window><div class=iw-wrapper><div class="iw-header text-center"><img ng-src={{vm.driver.profile.profile_image}} class=iw-driver height=50><h3>{{vm.driver.profile.name}}</h3></div><div class=iw-content><table class=table><tbody><tr><td class=text-center><i class="fa fa-clock-o"></i></td><td>Time</td><td>{{vm.driver.profile.time | date:\'shortTime\'}}</td></tr><tr><td class=text-center><i class="fa fa-mobile-phone"></i></td><td>Phone#</td><td>{{vm.driver.profile.phone}}</td></tr><tr><td class=text-center><i class="fa fa-taxi"></i></td><td>Vehicle#</td><td>{{vm.driver.profile.vehicle}}</td></tr><tr><td class=text-center><i class="fa fa-user"></i></td><td>ID#</td><td>{{vm.driver.profile.driverId}}</td></tr><tr><td class=text-center><i class="fa fa-map-marker"></i></td><td>Location</td><td style=max-width:100px><a ng-click=vm.clicked(vm.driver.marker)><span ng-if=!vm.driver.address>Show</span></a> <span ng-if=vm.driver.address>{{vm.driver.address}}</span></td></tr></tbody></table></div></div></div></div></info-window></ng-map><div class=tabs-view><button ng-click="tabView = !tabView" ng-class="{\'left-arrow\' : tabView}" class="btn btn-default tabs-toggle-btn map-btn" title="Show More..."><i class="fa fa-angle-double-right"></i></button><div class=tabs-toggle ng-class="{\'tabs-show\' : tabView}"><uib-tabset active=active><uib-tab index=0 heading=Trips><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{selectedTrip.id}}</h4><span>id</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{(selectedTrip.requestOn)*1000 | date:"MMM dd, yy \'at\' h:mma"}}</h4><span>date</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{getTimeDiff(selectedTrip.requestOn, selectedTrip.pickupOn ) | secondsToDateTime}} / {{getTimeDiff(selectedTrip.pickupOn ,selectedTrip.dropOn)| secondsToDateTime}}</h4><span>Time for Trip / in Trip</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{(selectedTrip.disStartPickup/1000) | number:2}}km / {{(selectedTrip.disPickupDrop/1000) | number:2}}km</h4><span>Distance for Trip / in Trip</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>Rs.{{selectedTrip.fareStartPickup}}</h4><span>Amount</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{selectedTrip.pickupOn ? (selectedTrip.pickupOn *1000 | date:"h:mma ") : \'N/A\'}} / {{selectedTrip.dropOn ? (selectedTrip.dropOn *1000| date:"h:mma ") : \'N/A\'}}</h4><span>Start Time / End Time</span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>Rs.{{selectedTrip.amount.total}} <small>/ {{selectedTrip.amount.cash}} / {{selectedTrip.amount.tcash}}</small></h4><span>Amount Total<small> / Cash / tCash</small></span></div></div><div class="col-md-4 col-sm-4 col-xs-12"><div class=box><h4 class=number>{{selectedTrip.riderFeedbackRating | number:2}}</h4><span>Rider\'s Feedback</span></div></div></div></div></uib-tab><uib-tab index=1 heading="Driver Info"><div class=table-responsive><table width=100% class="table table-bordered table-striped"><tr><td colspan=2><img ng-src="{{selectedTrip.driverInfo.profileImage ? selectedTrip.driverInfo.profileImage:\'assets/images/default.png\' }}" style=height:100px></td></tr><tr><td>Name</td><td><label>{{selectedTrip.driverInfo.name}}</label></td></tr><tr><td>Vehicle Number</td><td><label>{{selectedTrip.driverInfo.vehicle}}</label></td></tr><tr><td>Phone Number</td><td><label>{{selectedTrip.driverInfo.phone}}</label></td></tr><tr><td>Current Status</td><td><div ng-if="selectedTrip.driverInfo.state == 10"><span class=text-danger>Offline</span></div><div ng-if="selectedTrip.driverInfo.state == 11"><span class=text-success>Online</span></div><div ng-if="selectedTrip.driverInfo.state == 22"><span class=text-danger>Unoccupied</span></div><div ng-if="selectedTrip.driverInfo.state == 30"><span class=text-info>Occupied</span></div><div ng-if="selectedTrip.driverInfo.state == 40"><span class=text-info>Occupied</span></div><div ng-if="selectedTrip.driverInfo.state == 50"><span class=text-info>Occupied</span></div></td></tr><tr><td>Total Rides</td><td>{{selectedTrip.driverInfo.ridesTotal}}</td></tr><tr><td>Today\'s Rides</td><td>{{selectedTrip.driverInfo.ridesToday}}</td></tr><tr><td>Today\'s Earnings</td><td>{{selectedTrip.driverInfo.fare}}</td></tr><tr><td>Overall Feedback</td><td>{{selectedTrip.driverInfo.avg | number:2}}</td></tr></table></div></uib-tab><uib-tab index=1 heading="Rider Info"><div class=table-responsive><table width=100% class="table table-bordered table-striped"><tr><td colspan=2><img ng-src="{{selectedTrip.riderInfo.profileImage ? selectedTrip.riderInfo.profileImage:\'assets/images/default.png\' }}" style=height:100px></td></tr><tr><td>Name</td><td><label>{{selectedTrip.riderInfo.name}}</label></td></tr><tr><td>Phone Number</td><td><label>{{selectedTrip.riderInfo.phone}}</label></td></tr><tr><td>Email</td><td>{{selectedTrip.riderInfo.email}}</td></tr><tr><td>Gender</td><td>{{selectedTrip.riderInfo.gender}}</td></tr><tr><td>Age</td><td>{{selectedTrip.riderInfo.age}}</td></tr><tr><td>Total Rides</td><td>{{selectedTrip.riderInfo.ridesTotal}}</td></tr><tr><td>Today\'s Rides</td><td>{{selectedTrip.riderInfo.ridesToday}}</td></tr></table></div></uib-tab></uib-tabset></div></div></div></div>'),e.put("app/trips/trips.html",'<div class=container-fluid><div class=row><form class="form-inline date-selection date-selection-dr"><div class=form-group><input ng-change=" vm.onDateChange()" class="form-control cstm-width text-center" type=daterange ng-model=tripDates separator=" - " format="DD MMM YY" opens=right ranges=vm.ranges></div></form><br><br><br><br></div><div class=row><div class=col-md-6></div><div class="col-md-6 text-right"></div></div><br><!-- <div class="row">\n         <div class="col-md-12">\n             <div class="panel panel-default">\n                 <div class="panel-body">\n                     <h4 style="margin-top: 0">Heatmap</h4>\n                     <br>\n\n                     <div class="table-responsive">\n                         <div id="chart"></div>\n                       &lt;!&ndash;  <nvd3 options="vm.tripChartOptions" data="vm.trips" config="vm.config"></nvd3>&ndash;&gt;\n                     </div>\n                 </div>\n             </div>\n         </div>\n     </div>--><div class=row><div class="col-md-6 col-sm-12 col-xs-12"><div class="panel panel-default"><form class="form-inline pull-right"><div class=form-group><div class="radio inpt-style"><label><input type=radio ng-change="vm.changeFrequency(\'trip\', vm.tripFrequency.value)" name=optradio ng-model=vm.tripFrequency.value value=hour><i></i> <span>Per Hour</span></label><label><input type=radio ng-change="vm.changeFrequency(\'trip\', vm.tripFrequency.value)" name=optradio ng-model=vm.tripFrequency.value value=day> <i></i> <span>Per Day</span></label></div></div></form><div class=panel-heading><h4 style="margin-top: 0" class=title>Trips</h4></div><div class=panel-body><nvd3 options=vm.tripChartOptions data=vm.trips config=vm.config></nvd3></div></div></div><div class="col-md-6 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>tCash Burned</h4></div><div class=panel-body><nvd3 options=vm.tcashChartOptions data=vm.tcashData config=vm.config></nvd3></div></div></div></div><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><form class=form-inline><div class="input-group col-md-3 col-sm-4 col-xs-12"><select ng-model=vm.filterTerm class=form-control ng-options="statusFilter.name for statusFilter in vm.filterFields track by statusFilter.value"><option value="" disabled=disabled>Select Filter</option></select></div><div class="input-group col-md-3 col-sm-4 col-xs-12"><input ng-model=vm.searchTerm class=form-control placeholder=term ng-disabled=!vm.filterTerm></div><div class="input-group col-md-1 col-sm-4 col-xs-12"><button ng-disabled=!vm.searchTerm ng-click=vm.searchTable() class="btn btn-search"><span aria-hidden=true class="glyphicon glyphicon-search"></span></button></div><div class="input-group col-md-3 col-sm-4 col-xs-12"><select ng-model=vm.statusCodes ng-change=vm.searchTable() class=form-control ng-options="statusFilter.name for statusFilter in vm.tripStatusFilters track by statusFilter.value"><option value="" disabled=disabled>Select Status</option></select></div></form></div></div><div class=row><div class="col-md-12 col-sm-12 col-xs-12"><div class="panel panel-default"><div class=panel-heading><h4 style="margin-top: 0" class=title>Trips Table</h4></div><div class=panel-body><div class=table-responsive><table ng-table=tableParams class="table table-bordered"><tr class=truncate ng-repeat="row in $data track by $index"><!-- <td data-title="\'Trip ID\'" sortable="\'id\'" style="text-transform: inherit">\n                                     <a target="_blank"\n                                        ui-sref="home.trip_detail({id: row.id,driverId: row.driverInfo.id,riderId: row.riderInfo.id})">{{row.id}}\n                                     </a>\n                                 </td>--><td data-title="\'Date & Time\'" sortable="\'requestOn\'" style="width: 145px"><a target=_self ui-sref="home.trip_detail({id: row.id,driverId: row.driverInfo.id,riderId: row.riderInfo.id})"><div>{{(row.requestOn)*1000 | date:"dd MMM yy h:mma"}}</div></a></td><td data-title="\'Status\'" sortable="\'tripState\'"><div ng-if="row.tripState == 20" class=text-primary style="white-space: nowrap">Requested</div><div ng-if="row.tripState == 22" style="white-space: nowrap">Allocated</div><div ng-if="row.tripState == 30" style="white-space: nowrap">For Trip</div><div ng-if="row.tripState == 40" style="white-space: nowrap">At Pickup</div><div ng-if="row.tripState == 60" style="white-space: nowrap">At Destination</div><div ng-if="row.tripState == 50" class=text-info style="white-space: nowrap">In trip</div><div ng-if="row.tripState == 61" class=text-success style="white-space: nowrap">Successful</div><div ng-if="row.tripState == 70" class=text-warning style="white-space: nowrap">Can by Driver</div><div ng-if="row.tripState == 71" class=text-warning style="white-space: nowrap">Can by Rider</div><div ng-if="row.tripState == 80" style="white-space: nowrap">No Drv Avlble</div><div ng-if="row.tripState == 81" class=text-danger style="white-space: nowrap">Failed (No Drivers Accepted)</div><div ng-if="row.tripState == 82" style="white-space: nowrap">Terminated</div></td><td data-title="\'Driver Info\'"><div>{{row.driverInfo.name}}<br><!--  <span class="small">{{row.driverInfo.phone}}</span>\n                                          <span class="small">{{row.driverInfo.vehicle}}</span>--></div></td><td data-title="\'VType\'" sortable="\'vehicleType\'" align=center><div>{{row.vehicleType}}</div></td><td data-title="\'Rider  Info\'"><div>{{row.riderInfo.name}}</div></td><!--<td data-title="\'Pickup\'" style="width:150px;">\n                                    <div class="truncate truncate-pick-drop">{{row.pickUp.line1 + \' \' + row.pickUp.line2}} {{row.drop.city + \'\n                                        \' +row.pickUp.state + \' \' +\n                                        row.pickUp.country}}\n                                    </div>\n                                </td>\n                                <td data-title="\'Drop\'" style="width:150px;">\n                                    <div class="truncate truncate-pick-drop">{{row.drop.line1 + \' \' + row.drop.line2}} {{row.drop.city + \' \'\n                                        +row.drop.state + \' \' +\n                                        row.drop.country}}\n                                    </div>\n                                </td>--><td data-title="\'Time\'" sortable="\'time\'"><div>{{getTimeDiff(row.pickupOn,row.dropOn)| secondsToDateTime}}</div><!--<div>{{getTimeDiff(row.pickupOn,row.dropOn)| secondsToDateTime}}</div>--></td><td data-title="\'Dist(KM)\'" sortable="\'disPickupDrop\'" align=center><div>{{(row.disPickupDrop)/1000 | number:2}}</div></td><!-- <td data-title="\'Amt(Rs.)\'" sortable="\'amount\'" align="right">\n                                     <div class="truncate truncate-amt"><b>{{row.amount.total}}</b>\n                                         <span class="small">Cash: {{row.amount.cash | number:2}}</span>\n                                         <span class="small">Citrus: {{row.amount.citrus | number:2}}</span>\n                                         <span class="small">Discount: {{row.amount.discount | number:2}} </span>\n                                     </div>\n                                 </td>\n                                 <td data-title="\'Rating\'" sortable="\'riderFeedbackRating\'" align="center">\n                                     <div>{{row.riderFeedbackRating | number:1}}</div>\n                                 </td>--><!-- <td data-title="\'Show\'" align="center">\n                                     <button class="btn btn-xs btn-link" ng-click="showMore(row)"><i\n                                             ng-class="{\'glyphicon-chevron-up\':row.showMore,\'glyphicon-chevron-down\':!row.showMore}"\n                                             class="glyphicon glyphicon-chevron-down"></i></button>\n                                 </td>--></tr></table><table class="table table-bordered table-striped table-condensed" ng-show=tblNoData><tr><td colspan=11>No data found</td></tr></table></div></div></div></div></div><!--<div class="row">\n        <div class="col-md-6">\n            &lt;!&ndash;-Driver-&ndash;&gt;\n            <div class="row">\n                <div class="col-md-6"></div>\n                <div class="col-md-6 text-right">\n                    <form class="form-inline">\n                        <div class="form-group " style="margin-top:15px">\n                            <div class="radio inpt-style">\n                                <label><input type="radio" name="optradio"\n                                              ng-change="vm.changeFrequency(\'driver\',vm.driverFrequency.value)"\n                                              ng-model="vm.driverFrequency.value" value="hour"><i></i>\n                                    <span>Per Hour</span></label>\n                                <label><input type="radio" name="optradio"\n                                              ng-change="vm.changeFrequency(\'driver\',vm.driverFrequency.value)"\n                                              ng-model="vm.driverFrequency.value" value="day"> <i></i>\n                                    <span>Per Day</span></label>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n            </div>\n            <br>\n\n            <div class="row">\n                <div class="col-md-12">\n                    <div class="panel panel-default">\n                        <div class="panel-body">\n                            <h4 style="margin-top: 0">Driver</h4>\n                            <br>\n\n                            <div class="table-responsive">\n                                <nvd3 options="vm.driverChartOptions" data="vm.drivers" config="vm.config"></nvd3>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="col-md-6">\n            &lt;!&ndash;Rider&ndash;&gt;\n            <div class="row">\n                <div class="col-md-6"></div>\n                <div class="col-md-6 text-right">\n                    <form class="form-inline">\n\n                        <div class="form-group " style="margin-top:15px">\n                            <div class="radio inpt-style">\n                                <label><input type="radio" name="optradio"\n                                              ng-change="vm.changeFrequency(\'rider\', vm.riderFrequency.value)"\n                                              ng-model="vm.riderFrequency.value" value="hour"><i></i>\n                                    <span>Per Hour</span></label>\n                                <label><input type="radio" name="optradio"\n                                              ng-change="vm.changeFrequency(\'rider\', vm.riderFrequency.value)"\n                                              ng-model="vm.riderFrequency.value" value="day"> <i></i>\n                                    <span>Per Day</span></label>\n                            </div>\n                        </div>\n                    </form>\n                </div>\n            </div>\n            <br>\n\n            <div class="row">\n                <div class="col-md-12">\n                    <div class="panel panel-default">\n                        <div class="panel-body">\n                            <h4 style="margin-top: 0">Rider</h4>\n                            <br>\n\n                            <div class="table-responsive">\n                                <nvd3 options="vm.riderChartOptions" data="vm.riders" config="vm.config"></nvd3>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>--></div>'),e.put("app/components/navbar/navbar.html","")}]);
//# sourceMappingURL=../maps/scripts/app-4212b0f0b6.js.map
